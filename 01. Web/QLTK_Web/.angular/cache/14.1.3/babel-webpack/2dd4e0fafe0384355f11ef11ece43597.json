{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared\";\nimport * as i2 from \"../service/cost-warning.service\";\n\nfunction CostWarningComponent_option_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", item_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", item_r3, \" \");\n  }\n}\n\nconst _c0 = function () {\n  return {\n    align: \"right\",\n    prefix: \"\",\n    thousands: \",\",\n    decimal: \".\",\n    precision: 0\n  };\n};\n\nfunction CostWarningComponent_tr_37_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 22);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"input\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function CostWarningComponent_tr_37_Template_input_ngModelChange_4_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const row_r4 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(row_r4.EstimatedCost = $event);\n    })(\"ngModelChange\", function CostWarningComponent_tr_37_Template_input_ngModelChange_4_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.TotalEstimatedCosts());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"td\")(6, \"input\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function CostWarningComponent_tr_37_Template_input_ngModelChange_6_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const row_r4 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(row_r4.RealCost = $event);\n    })(\"ngModelChange\", function CostWarningComponent_tr_37_Template_input_ngModelChange_6_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.TotalRealCost());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"td\", 23);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\", 23);\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const row_r4 = ctx.$implicit;\n    const i_r5 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r4.Month);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", row_r4.CheckEstimatedCost != 0)(\"options\", i0.ɵɵpureFunction0(17, _c0))(\"name\", \"EstimatedCost\" + i_r5)(\"ngModel\", row_r4.EstimatedCost);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", row_r4.CheckRealCost != 0)(\"options\", i0.ɵɵpureFunction0(18, _c0))(\"name\", \"RealCost\" + i_r5)(\"ngModel\", row_r4.RealCost);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 11, row_r4.EstimatedCost - row_r4.RealCost, \"1.0-0\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(12, 14, row_r4.NextMonthCost, \"1.0-0\"));\n  }\n}\n\nexport let CostWarningComponent = /*#__PURE__*/(() => {\n  class CostWarningComponent {\n    constructor(appSetting, messageService, constant, service) {\n      this.appSetting = appSetting;\n      this.messageService = messageService;\n      this.constant = constant;\n      this.service = service;\n      this.listCostWarning = [];\n      this.listYear = [];\n      this.listMonth = [];\n      this.date = new Date();\n      this.model = {\n        // TimeType: '0',\n        // DateFromV: null,\n        // DateToV: null,\n        // DateFrom: null,\n        // DateTo: null,\n        Year: null,\n        // Month: this.date.getMonth() + 1,\n        ListCost: []\n      };\n    }\n\n    ngOnInit() {\n      this.appSetting.PageTitle = \"Cảnh báo chi phí\";\n      this.loadMonth();\n      this.loadYear();\n      this.initModel();\n      this.searchCost();\n    }\n\n    searchCost() {\n      this.service.searchCost({\n        Year: this.model.Year\n      }).subscribe(data => {\n        this.listCostWarning = data.ListResult;\n        this.totalEstimatedCost = data.TotalEstimatedCost;\n        this.totalRealCost = data.TotalRealCost;\n        this.totalNextMonth = data.TotalNextMonth;\n        this.totalStatusCost = data.TotalStatusCost;\n        this.totalCost = data.TotalCost;\n      }, error => {\n        this.messageService.showError(error);\n      });\n    }\n\n    createCost() {\n      this.model.ListCost = this.listCostWarning;\n      this.service.createCost(this.model).subscribe(data => {\n        this.messageService.showSuccess(\"Cập nhật danh sách thành công!\");\n        this.searchCost();\n      }, error => {\n        this.messageService.showError(error);\n      });\n    }\n\n    loadMonth() {\n      for (var month = 1; month < 13; month++) this.listMonth.push(month);\n    }\n\n    loadYear() {\n      for (var year = 2000; year <= new Date().getFullYear(); year++) {\n        this.listYear.push(year);\n      }\n    }\n\n    createObjectDate(year, month, day) {\n      var objectDate = new ObjectDate();\n      objectDate.day = day;\n      objectDate.month = month;\n      objectDate.year = year;\n      return objectDate;\n    }\n\n    initModel() {\n      this.model.Year = new Date().getFullYear();\n      this.model.DateFromV = new ObjectDate(); // Set ngày từ\n\n      this.model.DateFromV = this.createObjectDate(parseInt(this.model.Year), 1, 1); // Set ngày đến\n\n      this.model.DateToV = this.createObjectDate(parseInt(this.model.Year), 12, 31);\n    }\n\n    TotalEstimatedCosts() {\n      this.totalEstimatedCost = 0;\n      this.totalStatusCost = 0;\n      this.totalNextMonth = 0;\n      this.listCostWarning.forEach(element => {\n        this.totalEstimatedCost += element.EstimatedCost;\n        this.totalStatusCost += element.EstimatedCost - element.RealCost;\n      });\n      var group = this.listCostWarning.filter(t => t.RealCost > 0);\n      var count = group.length;\n      var medium = this.totalStatusCost / (12 - count);\n      this.listCostWarning.forEach(element => {\n        if (element.RealCost > 0) {\n          element.NextMonthCost = 0;\n        } else {\n          element.NextMonthCost = medium;\n        }\n\n        this.totalNextMonth += element.NextMonthCost;\n      });\n    }\n\n    TotalRealCost() {\n      this.totalRealCost = 0;\n      this.totalStatusCost = 0;\n      this.totalNextMonth = 0;\n      this.listCostWarning.forEach(element => {\n        this.totalRealCost += element.RealCost;\n        this.totalStatusCost += element.EstimatedCost - element.RealCost;\n      });\n      var group = this.listCostWarning.filter(t => t.RealCost > 0);\n      var count = group.length;\n      var medium = this.totalStatusCost / (12 - count);\n      this.listCostWarning.forEach(element => {\n        if (element.RealCost > 0) {\n          element.NextMonthCost = 0;\n        } else {\n          element.NextMonthCost = medium;\n        }\n\n        this.totalNextMonth += element.NextMonthCost;\n      });\n    }\n\n  }\n\n  CostWarningComponent.ɵfac = function CostWarningComponent_Factory(t) {\n    return new (t || CostWarningComponent)(i0.ɵɵdirectiveInject(i1.AppSetting), i0.ɵɵdirectiveInject(i1.MessageService), i0.ɵɵdirectiveInject(i1.Constants), i0.ɵɵdirectiveInject(i2.CostWarningService));\n  };\n\n  CostWarningComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CostWarningComponent,\n    selectors: [[\"app-cost-warning\"]],\n    decls: 57,\n    vars: 24,\n    consts: [[1, \"content-wrapper\"], [1, \"content-body\", \"padding-15\"], [\"name\", \"form\", \"novalidate\", \"\"], [\"f\", \"ngForm\"], [1, \"row\"], [1, \"col-xl-3\", \"col-lg-3\", \"col-md-3\", \"col-sm-12\"], [1, \"form-group\"], [1, \"form-label\"], [1, \"controls\"], [\"name\", \"DesignBy\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [1, \"row\", \"margin-bottom-10\"], [1, \"col-md-6\", \"text-left\"], [1, \"form-label\", 2, \"line-height\", \"35px\"], [1, \"bold\", \"text-danger\"], [1, \"col-xl-12\", \"col-md-12\", \"col-sm-12\", \"col-lg-12\"], [2, \"height\", \"auto\", \"width\", \"100%\", 3, \"config\"], [1, \"table\", \"table-bordered\", 2, \"min-width\", \"1100px\"], [\"width\", \"100px\", 1, \"text-center\"], [\"width\", \"200px\", 1, \"text-center\"], [\"min-width\", \"400px\", 1, \"text-center\"], [4, \"ngFor\", \"ngForOf\"], [1, \"text-center\"], [1, \"text-right\"], [1, \"col-xl-12\", \"col-md-12\", \"col-sm-12\", \"col-lg-12\", \"text-right\"], [\"type\", \"button\", \"container\", \"body\", 1, \"btn\", \"btn-success\", 3, \"click\"], [1, \"fa\", \"fa-save\"], [3, \"ngValue\"], [\"currencyMask\", \"\", \"type\", \"text\", \"maxlength\", \"18\", 1, \"form-control\", 3, \"disabled\", \"options\", \"name\", \"ngModel\", \"ngModelChange\"]],\n    template: function CostWarningComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"form\", 2, 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"div\", 6)(7, \"label\", 7);\n        i0.ɵɵtext(8, \"N\\u0103m\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 8)(10, \"select\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function CostWarningComponent_Template_select_ngModelChange_10_listener($event) {\n          return ctx.model.Year = $event;\n        })(\"change\", function CostWarningComponent_Template_select_change_10_listener() {\n          return ctx.searchCost();\n        });\n        i0.ɵɵtemplate(11, CostWarningComponent_option_11_Template, 2, 2, \"option\", 10);\n        i0.ɵɵelementEnd()()()()()()();\n        i0.ɵɵelementStart(12, \"div\", 1)(13, \"div\", 11)(14, \"div\", 12)(15, \"label\", 13);\n        i0.ɵɵtext(16, \"T\\u1ED5ng chi ph\\u00ED d\\u1EF1 ki\\u1EBFn tri\\u1EC3n khai \\u0111\\u01B0\\u1EE3c: \");\n        i0.ɵɵelementStart(17, \"span\", 14);\n        i0.ɵɵtext(18);\n        i0.ɵɵpipe(19, \"number\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(20, \"div\", 4)(21, \"div\", 15)(22, \"perfect-scrollbar\", 16)(23, \"table\", 17)(24, \"thead\")(25, \"tr\")(26, \"th\", 18);\n        i0.ɵɵtext(27, \"Th\\u00E1ng\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"th\", 19);\n        i0.ɵɵtext(29, \"D\\u1EF1 ki\\u1EBFn chi ti\\u00EAu\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"th\", 19);\n        i0.ɵɵtext(31, \"S\\u1ED1 ti\\u1EC1n chi ti\\u00EAu\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"th\", 19);\n        i0.ɵɵtext(33, \"Tr\\u1EA1ng th\\u00E1i\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"th\", 20);\n        i0.ɵɵtext(35, \"Chi ph\\u00ED th\\u00E1ng ti\\u1EBFp theo\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(36, \"tbody\");\n        i0.ɵɵtemplate(37, CostWarningComponent_tr_37_Template, 13, 19, \"tr\", 21);\n        i0.ɵɵelementStart(38, \"tr\")(39, \"td\", 22);\n        i0.ɵɵtext(40, \"T\\u1ED5ng:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"td\", 23);\n        i0.ɵɵtext(42);\n        i0.ɵɵpipe(43, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"td\", 23);\n        i0.ɵɵtext(45);\n        i0.ɵɵpipe(46, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(47, \"td\", 23);\n        i0.ɵɵtext(48);\n        i0.ɵɵpipe(49, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"td\", 23);\n        i0.ɵɵtext(51);\n        i0.ɵɵpipe(52, \"number\");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(53, \"div\", 24)(54, \"button\", 25);\n        i0.ɵɵlistener(\"click\", function CostWarningComponent_Template_button_click_54_listener() {\n          return ctx.createCost();\n        });\n        i0.ɵɵelement(55, \"i\", 26);\n        i0.ɵɵtext(56, \" L\\u01B0u \");\n        i0.ɵɵelementEnd()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngModel\", ctx.model.Year);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listYear);\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(19, 9, ctx.totalCost, \"1.0-0\"));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"config\", ctx.constant.ScrollXConfig);\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngForOf\", ctx.listCostWarning);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(43, 12, ctx.totalEstimatedCost, \"1.0-0\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(46, 15, ctx.totalRealCost, \"1.0-0\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(49, 18, ctx.totalStatusCost, \"1.0-0\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(52, 21, ctx.totalNextMonth, \"1.0-0\"));\n      }\n    }\n  });\n  return CostWarningComponent;\n})();\nexport class ObjectDate {}","map":null,"metadata":{},"sourceType":"module"}