{"ast":null,"code":"import { DxTreeListComponent } from 'devextreme-angular';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i2 from \"src/app/shared\";\nimport * as i3 from \"../../service/task-module-group.service\";\nimport * as i4 from \"src/app/shared/common/check-special-characters\";\n\nconst _c0 = function () {\n  return [1];\n};\n\nfunction TaskModuleGroupCreateComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"dx-tree-list\", 25);\n    i0.ɵɵlistener(\"selectedRowKeysChange\", function TaskModuleGroupCreateComponent_div_20_Template_dx_tree_list_selectedRowKeysChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.selectedRowKeys = $event);\n    })(\"onSelectionChanged\", function TaskModuleGroupCreateComponent_div_20_Template_dx_tree_list_onSelectionChanged_1_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.treeView_itemSelectionChanged($event));\n    })(\"onFocusedRowChanged\", function TaskModuleGroupCreateComponent_div_20_Template_dx_tree_list_onFocusedRowChanged_1_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.onFocusedRowChanged($event));\n    })(\"onRowDblClick\", function TaskModuleGroupCreateComponent_div_20_Template_dx_tree_list_onRowDblClick_1_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.onRowDblClick());\n    });\n    i0.ɵɵelement(2, \"dxo-search-panel\", 26)(3, \"dxo-selection\", 27)(4, \"dxi-column\", 28)(5, \"dxi-column\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function TaskModuleGroupCreateComponent_div_20_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.closeDropDownBox());\n    });\n    i0.ɵɵtext(7, \" \\u0110\\u00F3ng \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"dataSource\", ctx_r2.ListModuleGroup)(\"showRowLines\", true)(\"showBorders\", true)(\"columnAutoWidth\", true)(\"expandedRowKeys\", i0.ɵɵpureFunction0(8, _c0))(\"selectedRowKeys\", ctx_r2.selectedRowKeys);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"visible\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"recursive\", ctx_r2.falses);\n  }\n}\n\nfunction TaskModuleGroupCreateComponent_option_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r12 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", item_r12.Id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(item_r12.Name);\n  }\n}\n\nfunction TaskModuleGroupCreateComponent_ng_container_38_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function TaskModuleGroupCreateComponent_ng_container_38_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.saveAndContinue());\n    });\n    i0.ɵɵelement(2, \"i\", 21);\n    i0.ɵɵtext(3, \"\\u00A0 \");\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵtext(5, \"L\\u01B0u & Ti\\u1EBFp t\\u1EE5c\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r0 = i0.ɵɵreference(8);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !_r0.form.valid);\n  }\n}\n\nexport let TaskModuleGroupCreateComponent = /*#__PURE__*/(() => {\n  class TaskModuleGroupCreateComponent {\n    constructor(activeModal, messageService, service, checkSpecialCharacter, comboboxService) {\n      this.activeModal = activeModal;\n      this.messageService = messageService;\n      this.service = service;\n      this.checkSpecialCharacter = checkSpecialCharacter;\n      this.comboboxService = comboboxService;\n      this.ModalInfo = {\n        Title: 'Thêm mới cấu hình công việc - nhóm module',\n        SaveText: 'Lưu'\n      };\n      this.isAction = false;\n      this.model = {\n        Id: '',\n        TaskId: '',\n        ModuleGroupId: ''\n      };\n      this.ListTask = [];\n      this.ListModuleGroup = [];\n      this.isDropDownBoxOpened = false;\n      this.selectedRowKeys = [];\n    }\n\n    ngOnInit() {\n      this.getListTask();\n      this.getListModuleGroup();\n\n      if (this.Id) {\n        this.ModalInfo.Title = 'Chỉnh sửa cấu hình công việc - nhóm module';\n        this.ModalInfo.SaveText = 'Lưu';\n        this.getTaskModuleGroupInfo();\n      } else {\n        this.ModalInfo.Title = \"Thêm mới cấu hình công việc - nhóm module\";\n      }\n    } //get combobox\n\n\n    getListTask() {\n      this.comboboxService.getListTask().subscribe(data => {\n        this.ListTask = data;\n      }, error => {\n        this.messageService.showError(error);\n      });\n    }\n\n    getListModuleGroup() {\n      this.comboboxService.getCbbModuleGroup().subscribe(data => {\n        this.ListModuleGroup = data.ListResult;\n      }, error => {\n        this.messageService.showError(error);\n      });\n    }\n\n    getTaskModuleGroupInfo() {\n      this.service.getTaskModuleGroupInfo({\n        Id: this.Id\n      }).subscribe(data => {\n        this.model = data;\n      });\n    }\n\n    closeModal(isOK) {\n      this.activeModal.close(isOK ? isOK : this.isAction);\n    }\n\n    saveAndContinue() {\n      this.save(true);\n    }\n\n    createTaskModuleGroup(isContinue) {\n      this.addTaskModuleGroup(isContinue);\n    }\n\n    addTaskModuleGroup(isContinue) {\n      this.service.createTaskModuleGroup(this.model).subscribe(data => {\n        if (isContinue) {\n          this.isAction = true;\n          this.model = {\n            Id: '',\n            TaskId: '',\n            ModuleGroupId: ''\n          };\n          this.messageService.showSuccess('Thêm mới cấu hình công việc - nhóm module thành công!');\n        } else {\n          this.messageService.showSuccess('Thêm mới cấu hình công việc - nhóm module thành công!');\n          this.closeModal(true);\n        }\n      }, error => {\n        this.messageService.showError(error);\n      });\n    }\n\n    save(isContinue) {\n      if (this.Id) {\n        this.updateTaskModuleGroup();\n      } else {\n        this.createTaskModuleGroup(isContinue);\n      }\n    }\n\n    saveTaskModuleGroup() {\n      this.service.updateTaskModuleGroup(this.model).subscribe(() => {\n        this.activeModal.close(true);\n        this.messageService.showSuccess('Cập nhật cấu hình công việc - nhóm module thành công!');\n      }, error => {\n        this.messageService.showError(error);\n      });\n    }\n\n    updateTaskModuleGroup() {\n      //kiểm tra ký tự đặc việt trong Mã\n      var validCode = this.checkSpecialCharacter.checkCode(this.model.Code);\n\n      if (validCode) {\n        this.saveTaskModuleGroup();\n      } else {\n        this.messageService.showConfirmCode(\"Mã không được chứa ký tự đặc biệt!\").then(data => {\n          this.model.UpdateBy = JSON.parse(localStorage.getItem('qltkcurrentUser')).userid;\n          this.saveTaskModuleGroup();\n        }, error => {});\n      }\n    }\n\n    syncTreeViewSelection(e) {\n      var component = e && e.component || this.treeView && this.treeView.instance;\n    }\n\n    onRowDblClick() {\n      this.isDropDownBoxOpened = false;\n    }\n\n    treeView_itemSelectionChanged(e) {\n      this.treeBoxValue = e.selectedRowKeys[0];\n      this.model.ModuleGroupId = e.selectedRowKeys[0]; //this.model.ModuleGroupId = e.selectedRowKeys.Id;\n    }\n\n    closeDropDownBox() {\n      this.isDropDownBoxOpened = false;\n    }\n\n  }\n\n  TaskModuleGroupCreateComponent.ɵfac = function TaskModuleGroupCreateComponent_Factory(t) {\n    return new (t || TaskModuleGroupCreateComponent)(i0.ɵɵdirectiveInject(i1.NgbActiveModal), i0.ɵɵdirectiveInject(i2.MessageService), i0.ɵɵdirectiveInject(i3.TaskModuleGroupService), i0.ɵɵdirectiveInject(i4.CheckSpecialCharacter), i0.ɵɵdirectiveInject(i2.ComboboxService));\n  };\n\n  TaskModuleGroupCreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TaskModuleGroupCreateComponent,\n    selectors: [[\"app-task-module-group-create\"]],\n    viewQuery: function TaskModuleGroupCreateComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(DxTreeListComponent, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.treeView = _t.first);\n      }\n    },\n    decls: 44,\n    vars: 10,\n    consts: [[1, \"modal-header\"], [1, \"modal-title\", \"text-uppercase\", \"text-danger\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 2, \"color\", \"brown\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\", \"padding-15\"], [\"name\", \"form\", \"novalidate\", \"\"], [\"f\", \"ngForm\"], [1, \"row\"], [1, \"col-xl-12\", \"col-lg-12\", \"col-md-12\", \"col-sm-12\"], [1, \"form-group\"], [1, \"form-label\"], [1, \"text-danger\", \"text-strong\"], [1, \"controls\"], [1, \"input-group\"], [\"valueExpr\", \"Id\", \"displayExpr\", \"Code\", \"placeholder\", \"Ch\\u1ECDn nh\\u00F3m module\", 3, \"value\", \"dataSource\", \"opened\", \"valueChange\", \"onValueChanged\", \"openedChange\"], [\"d1\", \"\"], [4, \"dxTemplate\", \"dxTemplateOf\"], [\"name\", \"TaskId\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"text-center\", 3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 3, \"disabled\", \"click\"], [1, \"fa\", \"fa-save\"], [4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"fa\", \"fa-power-off\"], [\"id\", \"Id\", \"keyExpr\", \"Id\", \"parentIdExpr\", \"ParentId\", 3, \"dataSource\", \"showRowLines\", \"showBorders\", \"columnAutoWidth\", \"expandedRowKeys\", \"selectedRowKeys\", \"selectedRowKeysChange\", \"onSelectionChanged\", \"onFocusedRowChanged\", \"onRowDblClick\"], [3, \"visible\"], [\"mode\", \"multiple\", 3, \"recursive\"], [\"dataField\", \"Code\", \"caption\", \"M\\u00E3 nh\\u00F3m\"], [\"dataField\", \"Name\", \"caption\", \"T\\u00EAn nh\\u00F3m\"], [\"type\", \"button\", 3, \"click\"], [1, \"text-center\", 3, \"ngValue\"]],\n    template: function TaskModuleGroupCreateComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h4\", 1);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"button\", 2);\n        i0.ɵɵlistener(\"click\", function TaskModuleGroupCreateComponent_Template_button_click_3_listener() {\n          return ctx.closeModal(false);\n        });\n        i0.ɵɵelementStart(4, \"span\", 3);\n        i0.ɵɵtext(5, \"\\u00D7\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"form\", 5, 6)(9, \"div\", 7)(10, \"div\", 8)(11, \"div\", 9)(12, \"label\", 10);\n        i0.ɵɵtext(13, \"Nh\\u00F3m module \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"span\", 11);\n        i0.ɵɵtext(15, \"\\u00A0*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 12)(17, \"div\", 13)(18, \"dx-drop-down-box\", 14, 15);\n        i0.ɵɵlistener(\"valueChange\", function TaskModuleGroupCreateComponent_Template_dx_drop_down_box_valueChange_18_listener($event) {\n          return ctx.treeBoxValue = $event;\n        })(\"onValueChanged\", function TaskModuleGroupCreateComponent_Template_dx_drop_down_box_onValueChanged_18_listener() {\n          return ctx.syncTreeViewSelection(\"\");\n        })(\"openedChange\", function TaskModuleGroupCreateComponent_Template_dx_drop_down_box_openedChange_18_listener($event) {\n          return ctx.isDropDownBoxOpened = $event;\n        });\n        i0.ɵɵtemplate(20, TaskModuleGroupCreateComponent_div_20_Template, 8, 9, \"div\", 16);\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(21, \"div\", 7)(22, \"div\", 8)(23, \"div\", 9)(24, \"label\", 10);\n        i0.ɵɵtext(25, \"C\\u00F4ng vi\\u1EC7c \");\n        i0.ɵɵelementStart(26, \"span\", 11);\n        i0.ɵɵtext(27, \"\\u00A0*\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(28, \"div\", 9)(29, \"select\", 17);\n        i0.ɵɵlistener(\"ngModelChange\", function TaskModuleGroupCreateComponent_Template_select_ngModelChange_29_listener($event) {\n          return ctx.model.TaskId = $event;\n        });\n        i0.ɵɵtemplate(30, TaskModuleGroupCreateComponent_option_30_Template, 2, 2, \"option\", 18);\n        i0.ɵɵelementEnd()()()()()()();\n        i0.ɵɵelementStart(31, \"div\", 19);\n        i0.ɵɵelementContainerStart(32);\n        i0.ɵɵelementStart(33, \"button\", 20);\n        i0.ɵɵlistener(\"click\", function TaskModuleGroupCreateComponent_Template_button_click_33_listener() {\n          return ctx.save(false);\n        });\n        i0.ɵɵelement(34, \"i\", 21);\n        i0.ɵɵtext(35, \"\\u00A0 \");\n        i0.ɵɵelementStart(36, \"span\");\n        i0.ɵɵtext(37);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵtemplate(38, TaskModuleGroupCreateComponent_ng_container_38_Template, 6, 1, \"ng-container\", 22);\n        i0.ɵɵelementStart(39, \"button\", 23);\n        i0.ɵɵlistener(\"click\", function TaskModuleGroupCreateComponent_Template_button_click_39_listener() {\n          return ctx.closeModal(false);\n        });\n        i0.ɵɵelement(40, \"i\", 24);\n        i0.ɵɵtext(41, \" \\u00A0 \");\n        i0.ɵɵelementStart(42, \"span\");\n        i0.ɵɵtext(43, \" \\u0110\\u00F3ng \");\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(8);\n\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.ModalInfo.Title);\n        i0.ɵɵadvance(16);\n        i0.ɵɵproperty(\"value\", ctx.treeBoxValue)(\"dataSource\", ctx.ListModuleGroup)(\"opened\", ctx.isDropDownBoxOpened);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"dxTemplateOf\", \"content\");\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngModel\", ctx.model.TaskId);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.ListTask);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", !_r0.form.valid);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.ModalInfo.SaveText);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.Id === \"\");\n      }\n    }\n  });\n  return TaskModuleGroupCreateComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}