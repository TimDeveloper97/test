{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/html_editor/modules/imageCursor.js)\r\n * Version: 22.1.4\r\n * Build date: Fri Jul 22 2022\r\n *\r\n * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport Quill from \"devextreme-quill\";\nimport BaseModule from \"./base\";\nimport eventsEngine from \"../../../events/core/events_engine\";\nimport { addNamespace } from \"../../../events/utils/index\";\nvar MODULE_NAMESPACE = \"dxHtmlEditorImageCursor\";\nvar clickEvent = addNamespace(\"dxclick\", MODULE_NAMESPACE);\nvar ImageCursorModule = BaseModule;\n\nif (Quill) {\n  ImageCursorModule = class extends BaseModule {\n    constructor(quill, options) {\n      super(quill, options);\n      this.addCleanCallback(this.clean.bind(this));\n\n      this._attachEvents();\n    }\n\n    _attachEvents() {\n      eventsEngine.on(this.quill.root, clickEvent, this._clickHandler.bind(this));\n    }\n\n    _detachEvents() {\n      eventsEngine.off(this.quill.root, clickEvent);\n    }\n\n    _clickHandler(e) {\n      if (this._isAllowedTarget(e.target)) {\n        this._adjustSelection(e);\n      }\n    }\n\n    _isAllowedTarget(targetElement) {\n      return this._isImage(targetElement);\n    }\n\n    _isImage(targetElement) {\n      return \"IMG\" === targetElement.tagName.toUpperCase();\n    }\n\n    _adjustSelection(e) {\n      var blot = this.quill.scroll.find(e.target);\n\n      if (blot) {\n        var index = blot.offset(this.quill.scroll);\n        this.quill.setSelection(index + 1, 0);\n      } else {\n        this.quill.setSelection(0, 0);\n      }\n    }\n\n    clean() {\n      this._detachEvents();\n    }\n\n  };\n}\n\nexport default ImageCursorModule;","map":null,"metadata":{},"sourceType":"module"}