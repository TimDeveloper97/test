{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { ChooseFolderModalComponent } from '../../choose-folder-modal/choose-folder-modal.component';\nimport { BroadcastEventListener } from 'src/app/signalr/broadcast.event.listener';\nimport { BlockUI } from 'ng-block-ui';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i2 from \"../../services/dowload-file-module.service\";\nimport * as i3 from \"src/app/shared\";\nimport * as i4 from \"src/app/signalR/signal-r.service\";\nimport * as i5 from \"@angular/forms\";\nexport class ModuleChooseFolderDownloadComponent {\n  constructor(activeModal, modalService, service, messageService, signalRService) {\n    this.activeModal = activeModal;\n    this.modalService = modalService;\n    this.service = service;\n    this.messageService = messageService;\n    this.signalRService = signalRService;\n    this.onDownload = new BroadcastEventListener('download');\n    this.listData = [];\n    this.listModuleDesignDocument = [];\n    this.listModuleMaterial = [];\n    this.downloadModel = {\n      Id: '',\n      Type: 1,\n      ModuleId: '',\n      Path: ''\n    };\n    this.model = {\n      ModuleId: '',\n      Path: '',\n      Type: 1,\n      ListModuleDesignDocument: [],\n      ListStrucFile: [],\n      ListModuleMaterial: []\n    };\n  }\n\n  ngOnInit() {\n    this.downloadModel.ModuleId = this.ModuleId;\n    this.getlistModuleDesignDocument(); //this.getListFile();\n\n    this.getListModuleMaterial();\n    this.signalRService.listen(this.onDownload, false);\n    this.downloadSub = this.onDownload.subscribe(data => {\n      if (data) {\n        if (data.length > 0) {\n          this.messageService.showMessage(\"Không có file trên nguồn\");\n        } else {\n          this.messageService.showSuccess('Download file thành công!');\n        }\n      } else {\n        this.messageService.showSuccess('Download file không thành công!');\n      }\n\n      this.blockUI.stop();\n      this.closeModal();\n    });\n  }\n\n  ngOnDestroy() {\n    this.downloadSub.unsubscribe();\n    this.signalRService.stopListening(this.onDownload);\n  }\n\n  showChooseFolderWindow() {\n    let activeModal = this.modalService.open(ChooseFolderModalComponent, {\n      container: 'body',\n      windowClass: 'choose-folder-modal',\n      backdrop: 'static'\n    });\n    activeModal.result.then(result => {\n      if (result) {\n        this.downloadModel.Path = result;\n      }\n    }, reason => {});\n  }\n\n  getlistModuleDesignDocument() {\n    this.service.GetListModuleDesignDocument().subscribe(data => {\n      if (data) {\n        this.listModuleDesignDocument = data;\n      }\n    }, error => {\n      this.messageService.showError(error);\n    });\n  }\n\n  getListFile() {\n    this.service.ListFileDowload(this.downloadModel).subscribe(data => {\n      if (data) {\n        this.listData = data;\n        this.download();\n      }\n    }, error => {\n      this.messageService.showError(error);\n    });\n  }\n\n  getListModuleMaterial() {\n    this.service.GetListModuleMaterial(this.downloadModel).subscribe(data => {\n      if (data) {\n        this.listModuleMaterial = data;\n      }\n    }, error => {\n      this.messageService.showError(error);\n    });\n  }\n\n  download() {\n    this.model.ModuleId = this.ModuleId;\n    this.model.Path = this.downloadModel.Path;\n    this.model.Type = this.downloadModel.Type;\n    this.model.ListModuleDesignDocument = this.listModuleDesignDocument;\n    this.model.ListStrucFile = this.listData;\n    this.model.ListModuleMaterial = this.listModuleMaterial;\n    this.signalRService.invoke('DownloadFolderModuleDesignDocument', this.model).subscribe(data => {\n      if (data) {\n        this.blockUI.start();\n      } else {\n        this.messageService.showMessage(\"Không kết nối được service\");\n      }\n    });\n  }\n\n  downloadFile() {\n    this.getListFile(); //this.download();\n  }\n\n  closeModal() {\n    this.activeModal.close();\n  }\n\n}\n\nModuleChooseFolderDownloadComponent.ɵfac = function ModuleChooseFolderDownloadComponent_Factory(t) {\n  return new (t || ModuleChooseFolderDownloadComponent)(i0.ɵɵdirectiveInject(i1.NgbActiveModal), i0.ɵɵdirectiveInject(i1.NgbModal), i0.ɵɵdirectiveInject(i2.DowloadFileModuleService), i0.ɵɵdirectiveInject(i3.MessageService), i0.ɵɵdirectiveInject(i4.SignalRService));\n};\n\nModuleChooseFolderDownloadComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ModuleChooseFolderDownloadComponent,\n  selectors: [[\"app-module-choose-folder-download\"]],\n  decls: 51,\n  vars: 7,\n  consts: [[1, \"modal-header\"], [1, \"modal-title\", \"text-uppercase\", \"text-danger\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\", \"padding-15\"], [\"name\", \"form\", \"novalidate\", \"\", 1, \"tab-form-demo\"], [\"f\", \"ngForm\"], [1, \"col-md-12\", \"col-sm-12\", \"col-lg-12\", \"padding-0\"], [1, \"row\"], [1, \"col-xl-8\", \"col-lg-8\", \"col-md-8\", \"col-sm-12\"], [1, \"form-group\"], [1, \"form-label\"], [1, \"controls\"], [\"type\", \"text\", \"name\", \"Pathmodulechoosefolder\", \"disabled\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Path\", \"ngModel\"], [1, \"col-xl-4\", \"col-lg-4\", \"col-md-4\", \"col-sm-12\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"col-lg-12\", \"col-md-12\", \"col-sm-12\", \"col-xs-12\", \"radio\"], [1, \"radio\"], [\"type\", \"radio\", \"name\", \"FileType\", 3, \"value\", \"ngModel\", \"ngModelChange\"], [1, \"checkround\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 3, \"click\"], [1, \"fa\", \"fa-save\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"fa\", \"fa-power-off\"]],\n  template: function ModuleChooseFolderDownloadComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h4\", 1);\n      i0.ɵɵtext(2, \"Ch\\u1ECDn th\\u01B0 m\\u1EE5c\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function ModuleChooseFolderDownloadComponent_Template_button_click_3_listener() {\n        return ctx.closeModal();\n      });\n      i0.ɵɵelementStart(4, \"span\", 3);\n      i0.ɵɵtext(5, \"\\u00D7\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(6, \"div\", 4)(7, \"form\", 5, 6)(9, \"div\", 7)(10, \"div\", 8)(11, \"div\", 9)(12, \"div\", 10)(13, \"label\", 11);\n      i0.ɵɵtext(14, \"\\u0110\\u01B0\\u1EDDng d\\u1EABn\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"div\", 12)(16, \"input\", 13, 14);\n      i0.ɵɵlistener(\"ngModelChange\", function ModuleChooseFolderDownloadComponent_Template_input_ngModelChange_16_listener($event) {\n        return ctx.downloadModel.Path = $event;\n      });\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(18, \"div\", 15)(19, \"div\", 10);\n      i0.ɵɵelement(20, \"label\", 11);\n      i0.ɵɵelementStart(21, \"div\", 12)(22, \"button\", 16);\n      i0.ɵɵlistener(\"click\", function ModuleChooseFolderDownloadComponent_Template_button_click_22_listener() {\n        return ctx.showChooseFolderWindow();\n      });\n      i0.ɵɵelementStart(23, \"span\");\n      i0.ɵɵtext(24, \"Ch\\u1ECDn folder\");\n      i0.ɵɵelementEnd()()()()()()();\n      i0.ɵɵelementStart(25, \"label\", 11);\n      i0.ɵɵtext(26, \"Lo\\u1EA1i thi\\u1EBFt k\\u1EBF\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"div\", 17)(28, \"label\", 18);\n      i0.ɵɵtext(29, \"Thi\\u1EBFt k\\u1EBF c\\u01A1 kh\\u00ED \");\n      i0.ɵɵelementStart(30, \"input\", 19);\n      i0.ɵɵlistener(\"ngModelChange\", function ModuleChooseFolderDownloadComponent_Template_input_ngModelChange_30_listener($event) {\n        return ctx.downloadModel.Type = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(31, \"span\", 20);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"label\", 18);\n      i0.ɵɵtext(33, \"Thi\\u1EBFt k\\u1EBF \\u0111i\\u1EC7n \");\n      i0.ɵɵelementStart(34, \"input\", 19);\n      i0.ɵɵlistener(\"ngModelChange\", function ModuleChooseFolderDownloadComponent_Template_input_ngModelChange_34_listener($event) {\n        return ctx.downloadModel.Type = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(35, \"span\", 20);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(36, \"label\", 18);\n      i0.ɵɵtext(37, \"Thi\\u1EBFt k\\u1EBF \\u0111i\\u1EC7n t\\u1EED \");\n      i0.ɵɵelementStart(38, \"input\", 19);\n      i0.ɵɵlistener(\"ngModelChange\", function ModuleChooseFolderDownloadComponent_Template_input_ngModelChange_38_listener($event) {\n        return ctx.downloadModel.Type = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(39, \"span\", 20);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(40, \"div\", 21)(41, \"button\", 22);\n      i0.ɵɵlistener(\"click\", function ModuleChooseFolderDownloadComponent_Template_button_click_41_listener() {\n        return ctx.downloadFile();\n      });\n      i0.ɵɵelement(42, \"i\", 23);\n      i0.ɵɵtext(43, \"\\u00A0 \");\n      i0.ɵɵelementStart(44, \"span\");\n      i0.ɵɵtext(45, \"Download\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(46, \"button\", 24);\n      i0.ɵɵlistener(\"click\", function ModuleChooseFolderDownloadComponent_Template_button_click_46_listener() {\n        return ctx.closeModal();\n      });\n      i0.ɵɵelement(47, \"i\", 25);\n      i0.ɵɵtext(48, \" \\u00A0 \");\n      i0.ɵɵelementStart(49, \"span\");\n      i0.ɵɵtext(50, \" \\u0110\\u00F3ng \");\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(16);\n      i0.ɵɵproperty(\"ngModel\", ctx.downloadModel.Path);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"value\", 1)(\"ngModel\", ctx.downloadModel.Type);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"value\", 2)(\"ngModel\", ctx.downloadModel.Type);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"value\", 3)(\"ngModel\", ctx.downloadModel.Type);\n    }\n  },\n  dependencies: [i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.RadioControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.NgModel, i5.NgForm]\n});\n\n__decorate([BlockUI()], ModuleChooseFolderDownloadComponent.prototype, \"blockUI\", void 0);","map":null,"metadata":{},"sourceType":"module"}