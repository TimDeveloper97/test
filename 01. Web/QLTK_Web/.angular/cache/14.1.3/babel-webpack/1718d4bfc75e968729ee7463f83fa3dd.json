{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { ElementRef } from '@angular/core';\nimport { BlockUI } from 'ng-block-ui';\nimport { BroadcastEventListener } from 'src/app/signalr/broadcast.event.listener';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared\";\nimport * as i2 from \"src/app/signalR/signal-r.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"ngx-perfect-scrollbar\";\nimport * as i5 from \"devextreme-angular/core\";\nimport * as i6 from \"devextreme-angular/ui/context-menu\";\nconst _c0 = [\"scrollHeaderOne\"];\nconst _c1 = [\"scrollHeaderTwo\"];\n\nfunction TestSoftHardCadComponent_tr_18_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"td\", 7);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 18);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    const i_r7 = ctx_r10.index;\n    const row_r6 = ctx_r10.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r7 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r6.FileName);\n  }\n}\n\nfunction TestSoftHardCadComponent_tr_18_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"td\", 19);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 20);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext();\n    const i_r7 = ctx_r11.index;\n    const row_r6 = ctx_r11.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r7 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r6.FileName);\n  }\n}\n\nfunction TestSoftHardCadComponent_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtemplate(1, TestSoftHardCadComponent_tr_18_ng_container_1_Template, 5, 2, \"ng-container\", 17);\n    i0.ɵɵtemplate(2, TestSoftHardCadComponent_tr_18_ng_container_2_Template, 5, 2, \"ng-container\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const row_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", row_r6.IsExist);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !row_r6.IsExist);\n  }\n}\n\nfunction TestSoftHardCadComponent_div_20_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 23);\n  }\n}\n\nfunction TestSoftHardCadComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\");\n    i0.ɵɵelement(2, \"span\", 21);\n    i0.ɵɵtemplate(3, TestSoftHardCadComponent_div_20_span_3_Template, 1, 0, \"span\", 22);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const e_r12 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", e_r12.icon);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", e_r12.items);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", e_r12.text, \" \");\n  }\n}\n\nfunction TestSoftHardCadComponent_tr_36_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"td\", 7);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 18);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext();\n    const i_r15 = ctx_r18.index;\n    const row_r14 = ctx_r18.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r15 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r14.FileName);\n  }\n}\n\nfunction TestSoftHardCadComponent_tr_36_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"td\", 19);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 20);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r19 = i0.ɵɵnextContext();\n    const i_r15 = ctx_r19.index;\n    const row_r14 = ctx_r19.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r15 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r14.FileName);\n  }\n}\n\nfunction TestSoftHardCadComponent_tr_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtemplate(1, TestSoftHardCadComponent_tr_36_ng_container_1_Template, 5, 2, \"ng-container\", 17);\n    i0.ɵɵtemplate(2, TestSoftHardCadComponent_tr_36_ng_container_2_Template, 5, 2, \"ng-container\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const row_r14 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", row_r14.IsExist);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !row_r14.IsExist);\n  }\n}\n\nfunction TestSoftHardCadComponent_div_38_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 23);\n  }\n}\n\nfunction TestSoftHardCadComponent_div_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\");\n    i0.ɵɵelement(2, \"span\", 21);\n    i0.ɵɵtemplate(3, TestSoftHardCadComponent_div_38_span_3_Template, 1, 0, \"span\", 22);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const e_r20 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", e_r20.icon);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", e_r20.items);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", e_r20.text, \" \");\n  }\n}\n\nexport class TestSoftHardCadComponent {\n  constructor(config, signalRService, constant, messageService) {\n    this.config = config;\n    this.signalRService = signalRService;\n    this.constant = constant;\n    this.messageService = messageService;\n    this.modelTest = {\n      ApiUrl: '',\n      PathFile: '',\n      SelectedPath: '',\n      ModuleCode: ''\n    };\n    this.listHardCAD = [];\n    this.listSoftCAD = [];\n    this.checkSoftHard = new BroadcastEventListener('checkSoftHardCAD');\n    this.download = new BroadcastEventListener('downloadCAD');\n    this.onDeleteList = new BroadcastEventListener('getDeleteList');\n    this.ListPath = [];\n    this.listItem = [];\n    this.items = [{\n      Id: 1,\n      text: 'Xóa file',\n      icon: 'fas fa-times text-danger'\n    }];\n  }\n\n  ngOnDestroy() {\n    window.removeEventListener('ps-scroll-x', null); //this.deleteList.unsubscribe();\n    //this.signalRService.stopListening(this.onDeleteList);\n  }\n\n  ngOnInit() {\n    window.addEventListener('ps-scroll-x', event => {\n      this.scrollHeaderOne.nativeElement.scrollLeft = event.target.scrollLeft;\n    }, true);\n    window.addEventListener('ps-scroll-x', event => {\n      this.scrollHeaderTwo.nativeElement.scrollLeft = event.target.scrollLeft;\n    }, true);\n    this.modelTest.PathFile = this.pathDMVT;\n    this.modelTest.ModuleCode = this.moduleCode;\n    this.modelTest.SelectedPath = this.selectedPath;\n    this.modelTest.ApiUrl = this.config.ServerApi; // this.signalRService.listen(this.checkSoftHard);\n    // this.signalRService.listen(this.download);\n\n    this.signalRService.listen(this.checkSoftHard, false);\n    this.notiSub = this.checkSoftHard.subscribe(data => {\n      if (data) {\n        if (data.StatusCode == 1) {\n          this.messageService.showSuccess('Tải dữ liệu thành công!');\n          this.listHardCAD = data.Data.ListHardCAD;\n          this.listSoftCAD = data.Data.ListSoftCAD;\n          this.isSuccess = data.Data.IsSuccess;\n\n          if (this.isSuccess) {\n            this.messageService.showMessage(\"Đã chuẩn!\");\n          } else {\n            this.messageService.showMessage(\"Chưa chuẩn!\");\n          }\n        } else {\n          this.messageService.showMessage(data.Message);\n        }\n      }\n\n      this.blockUI.stop();\n    });\n    this.signalRService.listen(this.download, false);\n    this.notiSub = this.download.subscribe(data => {\n      if (data) {\n        if (data.StatusCode == 1) {\n          this.messageService.showSuccess('Tải dữ liệu thành công!');\n        } else {\n          this.messageService.showMessage(data.Message);\n        }\n      }\n\n      this.blockUI.stop();\n    }); // Delete danh sách file\n    // this.signalRService.listen(this.onDeleteList, true);\n    // this.deleteList = this.onDeleteList.subscribe((data: any) => {\n    //   this.blockUI.stop();\n    //   if (data) {\n    //     //this.check();\n    //     this.messageService.showSuccess('Xóa file thành công!');\n    //   }\n    // });\n  }\n\n  checkSoftHardCAD() {\n    this.modelTest.PathFile = this.pathDMVT;\n    this.modelTest.ModuleCode = this.moduleCode;\n    this.modelTest.SelectedPath = this.selectedPath;\n    this.modelTest.ApiUrl = this.config.ServerApi;\n    let currentUser = JSON.parse(localStorage.getItem('qltkcurrentUser'));\n\n    if (currentUser && currentUser.access_token) {\n      this.modelTest.Token = currentUser.access_token;\n    }\n\n    this.signalRService.invoke('CheckSoftHardCAD', this.modelTest).subscribe(data => {\n      if (data) {\n        this.blockUI.start();\n      } else {\n        this.messageService.showMessage(\"Không kết nối được service\");\n      }\n    });\n  }\n\n  downloadAllCADHard() {\n    let currentUser = JSON.parse(localStorage.getItem('qltkcurrentUser'));\n\n    if (currentUser && currentUser.access_token) {\n      this.modelTest.Token = currentUser.access_token;\n    }\n\n    this.signalRService.invoke('DownloadHardCAD', this.modelTest).subscribe(data => {\n      if (data) {\n        this.blockUI.start();\n      } else {\n        this.messageService.showMessage(\"Không kết nối được service\");\n      }\n    });\n  }\n\n  itemClickSoftCAD(e) {\n    if (e.itemData.Id == 1) {\n      this.deleteLists(this.listSoftCAD);\n    }\n  }\n\n  itemClickHardCAD(e) {\n    if (e.itemData.Id == 1) {\n      this.deleteLists(this.listHardCAD);\n    }\n  }\n\n  deleteLists(list) {\n    this.ListPath = [];\n\n    for (var item of list) {\n      if (!item.IsExist) {\n        this.ListPath.push(item.FilePath);\n        this.listItem.push(item);\n      }\n    }\n\n    if (this.ListPath.length > 0) {\n      this.signalRService.invoke('DeleteListFile', this.ListPath).subscribe(data => {\n        if (data) {\n          this.blockUI.start();\n        } else {\n          this.messageService.showMessage(\"Không kết nối được service\");\n        }\n      });\n    }\n  }\n\n}\n\nTestSoftHardCadComponent.ɵfac = function TestSoftHardCadComponent_Factory(t) {\n  return new (t || TestSoftHardCadComponent)(i0.ɵɵdirectiveInject(i1.Configuration), i0.ɵɵdirectiveInject(i2.SignalRService), i0.ɵɵdirectiveInject(i1.Constants), i0.ɵɵdirectiveInject(i1.MessageService));\n};\n\nTestSoftHardCadComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TestSoftHardCadComponent,\n  selectors: [[\"app-test-soft-hard-cad\"]],\n  viewQuery: function TestSoftHardCadComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.scrollHeaderOne = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.scrollHeaderTwo = _t.first);\n    }\n  },\n  inputs: {\n    pathDMVT: \"pathDMVT\",\n    moduleCode: \"moduleCode\",\n    txtPathSC: \"txtPathSC\",\n    selectedPath: \"selectedPath\",\n    cadResultModel: \"cadResultModel\",\n    listHardCAD: \"listHardCAD\",\n    listSoftCAD: \"listSoftCAD\",\n    isSuccess: \"isSuccess\"\n  },\n  decls: 39,\n  vars: 10,\n  consts: [[1, \"row\"], [1, \"col-lg-12\", \"col-md-12\", \"col-sm-12text-right\"], [1, \"col-lg-6\", \"col-md-6\", \"col-sm-12\"], [1, \"form-label\"], [2, \"height\", \"auto\", \"width\", \"100%\", \"overflow\", \"hidden\"], [\"scrollHeaderOne\", \"\"], [1, \"table\", \"table-bordered\", \"mb-0\", 2, \"word-wrap\", \"break-word\", \"min-width\", \"470px\"], [\"width\", \"70px\", 1, \"text-center\"], [\"min-width\", \"400px\", 1, \"text-center\"], [\"id\", \"SoftCADId\", 2, \"height\", \"500px\", 3, \"config\"], [1, \"table\", \"table-bordered\", 2, \"min-width\", \"470px\"], [4, \"ngFor\", \"ngForOf\"], [\"keyExpr\", \"Id\", \"target\", \"#SoftCADId\", 3, \"dataSource\", \"width\", \"onItemClick\"], [4, \"dxTemplate\", \"dxTemplateOf\"], [\"scrollHeaderTwo\", \"\"], [\"id\", \"HardCADId\", 2, \"height\", \"500px\", 3, \"config\"], [\"keyExpr\", \"Id\", \"target\", \"#HardCADId\", 3, \"dataSource\", \"width\", \"onItemClick\"], [4, \"ngIf\"], [\"min-width\", \"400px\"], [\"width\", \"70px\", 1, \"text-center\", 2, \"background-color\", \"yellow\"], [\"min-width\", \"400px\", 2, \"background-color\", \"yellow\"], [3, \"ngClass\"], [\"class\", \"dx-icon-spinright\", 4, \"ngIf\"], [1, \"dx-icon-spinright\"]],\n  template: function TestSoftHardCadComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelement(1, \"div\", 1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"div\", 0)(3, \"div\", 2)(4, \"label\", 3);\n      i0.ɵɵtext(5, \"N\\u1ED9i dung b\\u1EA3n m\\u1EC1m \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 4, 5)(8, \"table\", 6)(9, \"thead\")(10, \"tr\")(11, \"th\", 7);\n      i0.ɵɵtext(12, \"STT\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"th\", 8);\n      i0.ɵɵtext(14, \"T\\u00EAn b\\u1EA3n m\\u1EC1m\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(15, \"perfect-scrollbar\", 9)(16, \"table\", 10)(17, \"tbody\");\n      i0.ɵɵtemplate(18, TestSoftHardCadComponent_tr_18_Template, 3, 2, \"tr\", 11);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(19, \"dx-context-menu\", 12);\n      i0.ɵɵlistener(\"onItemClick\", function TestSoftHardCadComponent_Template_dx_context_menu_onItemClick_19_listener($event) {\n        return ctx.itemClickSoftCAD($event);\n      });\n      i0.ɵɵtemplate(20, TestSoftHardCadComponent_div_20_Template, 5, 3, \"div\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(21, \"div\", 2)(22, \"label\", 3);\n      i0.ɵɵtext(23, \"N\\u1ED9i dung b\\u1EA3n c\\u1EE9ng \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"div\", 4, 14)(26, \"table\", 6)(27, \"thead\")(28, \"tr\")(29, \"th\", 7);\n      i0.ɵɵtext(30, \"STT\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(31, \"th\", 8);\n      i0.ɵɵtext(32, \"T\\u00EAn b\\u1EA3n c\\u1EE9ng\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(33, \"perfect-scrollbar\", 15)(34, \"table\", 10)(35, \"tbody\");\n      i0.ɵɵtemplate(36, TestSoftHardCadComponent_tr_36_Template, 3, 2, \"tr\", 11);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(37, \"dx-context-menu\", 16);\n      i0.ɵɵlistener(\"onItemClick\", function TestSoftHardCadComponent_Template_dx_context_menu_onItemClick_37_listener($event) {\n        return ctx.itemClickHardCAD($event);\n      });\n      i0.ɵɵtemplate(38, TestSoftHardCadComponent_div_38_Template, 5, 3, \"div\", 13);\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(15);\n      i0.ɵɵproperty(\"config\", ctx.constant.ScrollConfig);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listSoftCAD);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"dataSource\", ctx.items)(\"width\", 200);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"dxTemplateOf\", \"item\");\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"config\", ctx.constant.ScrollConfig);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listHardCAD);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"dataSource\", ctx.items)(\"width\", 200);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"dxTemplateOf\", \"item\");\n    }\n  },\n  dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf, i4.PerfectScrollbarComponent, i5.DxTemplateDirective, i6.DxContextMenuComponent]\n});\n\n__decorate([BlockUI()], TestSoftHardCadComponent.prototype, \"blockUI\", void 0);","map":null,"metadata":{},"sourceType":"module"}