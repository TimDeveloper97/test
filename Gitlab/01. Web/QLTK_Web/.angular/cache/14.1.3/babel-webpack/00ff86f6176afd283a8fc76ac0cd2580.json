{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { ElementRef } from '@angular/core';\nimport { BroadcastEventListener } from 'src/app/signalr/broadcast.event.listener';\nimport { BlockUI } from 'ng-block-ui';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared\";\nimport * as i2 from \"src/app/signalR/signal-r.service\";\nimport * as i3 from \"../services/test-design-service\";\nconst _c0 = [\"scrollHeaderOne\"];\n\nfunction TestStandardSuppliesComponent_tr_55_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 16);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 17);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 18);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 19);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 19);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 20);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\", 20);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\", 20);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"td\", 20);\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"td\", 19);\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"td\", 21);\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"td\", 19);\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"td\", 21);\n    i0.ɵɵtext(26);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const row_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.Stt);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.Name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.Specification);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.Code);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.RawMaterialCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.DV);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.SL);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.VL);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.KL);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.ManufactureCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.Note);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.MaterialGroupName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r2.MaterialGroupCode);\n  }\n}\n\nexport class TestStandardSuppliesComponent {\n  constructor(constant, messageService, signalRService, testDesignService, config) {\n    this.constant = constant;\n    this.messageService = messageService;\n    this.signalRService = signalRService;\n    this.testDesignService = testDesignService;\n    this.config = config;\n    this.listDMVT = [];\n    this.loadListDMVT = new BroadcastEventListener('listDMVT');\n    this.model = {\n      ModuleCode: '',\n      ListMaterial: [],\n      CreateBy: ''\n    };\n    this.modelTest = {\n      PathFileMaterial: '',\n      ApiUrl: '',\n      PathDownload: '',\n      ModuleCode: '',\n      FileName: '',\n      Type: ''\n    };\n    this.onDownload = new BroadcastEventListener('generalDownload');\n  }\n\n  ngOnInit() {\n    window.addEventListener('ps-scroll-x', event => {\n      this.scrollHeaderOne.nativeElement.scrollLeft = event.target.scrollLeft;\n    }, true);\n    this.signalRService.listen(this.loadListDMVT, false);\n    this.getDownload = this.onDownload.subscribe(data => {\n      if (data) {\n        this.messageService.showSuccess('Tạo biểu mẫu thành công!');\n      } else {\n        this.messageService.showMessage('Tạo biểu mẫu không thành công!');\n      }\n\n      this.blockUI.stop();\n    });\n    this.notiSub = this.loadListDMVT.subscribe(data => {\n      if (data) {\n        this.listDMVT = data.Data;\n        this.model.ModuleCode = this.moduleCode;\n        this.model.CreateBy = data.Data[0].CreateBy;\n\n        if (data.StatusCode == 1) {\n          this.messageService.showSuccess('Tải dữ liệu thành công!');\n        } else {\n          this.messageService.showMessage('Tải dữ liệu không thành công!');\n        }\n      }\n\n      this.blockUI.stop();\n    });\n  }\n\n  loadDMVT() {\n    if (this.pathDMVT) {\n      this.signalRService.invoke('LoadDMVT', this.pathDMVT).subscribe(data => {\n        if (data) {\n          this.blockUI.start();\n        } else {\n          this.messageService.showMessage(\"Không kết nối được service\");\n        }\n      });\n    } else {\n      this.messageService.showMessage('Chưa chọn thư mục!');\n    }\n  }\n\n  exportReportDMVT() {\n    this.model.ModuleCode = this.moduleCode;\n    this.model.CreateBy = this.listDMVT[0].CreateBy;\n    this.model.ListMaterial = this.listDMVT;\n    this.testDesignService.exportReportDMVT(this.model).subscribe(d => {\n      this.modelTest.PathFileMaterial = d;\n      this.modelTest.ApiUrl = this.config.ServerApi;\n      this.modelTest.ModuleCode = this.moduleCode;\n      this.modelTest.Type = 1;\n      this.modelTest.FileName = \"XNVT.\";\n      this.DowloadTemplateToFolder();\n    }, e => {\n      this.messageService.showError(e);\n    });\n  }\n\n  DowloadTemplateToFolder() {\n    let currentUser = JSON.parse(localStorage.getItem('qltkcurrentUser'));\n\n    if (currentUser && currentUser.access_token) {\n      this.modelTest.Token = currentUser.access_token;\n    }\n\n    this.signalRService.invoke('DowloadTemplateToFolder', this.modelTest).subscribe(data => {\n      if (data) {\n        this.blockUI.start();\n      } else {\n        this.messageService.showMessage(\"Không kết nối được service\");\n      }\n    });\n  }\n\n}\n\nTestStandardSuppliesComponent.ɵfac = function TestStandardSuppliesComponent_Factory(t) {\n  return new (t || TestStandardSuppliesComponent)(i0.ɵɵdirectiveInject(i1.Constants), i0.ɵɵdirectiveInject(i1.MessageService), i0.ɵɵdirectiveInject(i2.SignalRService), i0.ɵɵdirectiveInject(i3.TestDesignService), i0.ɵɵdirectiveInject(i1.Configuration));\n};\n\nTestStandardSuppliesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TestStandardSuppliesComponent,\n  selectors: [[\"app-test-standard-supplies\"]],\n  viewQuery: function TestStandardSuppliesComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.scrollHeaderOne = _t.first);\n    }\n  },\n  inputs: {\n    pathDMVT: \"pathDMVT\",\n    moduleCode: \"moduleCode\",\n    listDMVT: \"listDMVT\"\n  },\n  decls: 56,\n  vars: 4,\n  consts: [[1, \"row\"], [1, \"col-lg-6\", \"col-md-6\", \"col-sm-12\"], [1, \"form-group\"], [1, \"form-label\"], [1, \"controls\"], [\"type\", \"text\", \"name\", \"pathDMVT\", \"readonly\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-lg-6\", \"col-md-6\", \"col-sm-12\", \"margin-top-20\", \"text-right\"], [1, \"btn\", \"btn-success\", \"btn-success-system\", 3, \"click\"], [1, \"\"], [1, \"btn\", \"btn-success\", \"btn-success-system\", 3, \"disabled\", \"click\"], [1, \"fa\", \"fa-plus\"], [1, \"col-lg-12\", \"col-md-12\", \"col-sm-12\", \"margin-top-20\"], [1, \"col-md-12\", \"col-sm-12\", \"col-lg-12\", \"col-lg-12\", \"col-xl-12\"], [2, \"height\", \"auto\", \"width\", \"100%\", \"overflow\", \"hidden\"], [\"scrollHeaderOne\", \"\"], [1, \"table\", \"table-bordered\", \"mb-0\", 2, \"word-wrap\", \"break-word\", \"min-width\", \"1330px\"], [\"width\", \"50px\", 1, \"text-center\"], [\"min-width\", \"200px\", 1, \"text-center\"], [\"width\", \"100px\", 1, \"text-center\"], [\"width\", \"120px\", 1, \"text-center\"], [\"width\", \"70px\", 1, \"text-center\"], [\"width\", \"150px\", 1, \"text-center\"], [2, \"height\", \"500px\", 3, \"config\"], [1, \"table\", \"table-bordered\", 2, \"min-width\", \"1330px\"], [4, \"ngFor\", \"ngForOf\"]],\n  template: function TestStandardSuppliesComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"label\", 3);\n      i0.ɵɵtext(4, \"DMVT\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 4)(6, \"input\", 5);\n      i0.ɵɵlistener(\"ngModelChange\", function TestStandardSuppliesComponent_Template_input_ngModelChange_6_listener($event) {\n        return ctx.pathDMVT = $event;\n      });\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(7, \"div\", 6)(8, \"button\", 7);\n      i0.ɵɵlistener(\"click\", function TestStandardSuppliesComponent_Template_button_click_8_listener() {\n        return ctx.loadDMVT();\n      });\n      i0.ɵɵelement(9, \"i\", 8);\n      i0.ɵɵtext(10, \" \\u00A0Xem d\\u1EEF li\\u1EC7u\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(11, \"\\u00A0 \\u00A0 \");\n      i0.ɵɵelementStart(12, \"button\", 9);\n      i0.ɵɵlistener(\"click\", function TestStandardSuppliesComponent_Template_button_click_12_listener() {\n        return ctx.exportReportDMVT();\n      });\n      i0.ɵɵelement(13, \"i\", 10);\n      i0.ɵɵtext(14, \" \\u00A0T\\u1EA1o bi\\u1EC3u m\\u1EABu\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(15, \"div\", 0)(16, \"div\", 11)(17, \"label\", 3);\n      i0.ɵɵtext(18, \"Danh s\\u00E1ch v\\u1EADt t\\u01B0 \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(19, \"div\", 0)(20, \"div\", 12)(21, \"div\", 13, 14)(23, \"table\", 15)(24, \"thead\")(25, \"tr\")(26, \"th\", 16);\n      i0.ɵɵtext(27, \"STT\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"th\", 17);\n      i0.ɵɵtext(29, \"T\\u00EAn v\\u1EADt t\\u01B0\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"th\", 18);\n      i0.ɵɵtext(31, \"Th\\u00F4ng s\\u1ED1\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"th\", 19);\n      i0.ɵɵtext(33, \"M\\u00E3 v\\u1EADt t\\u01B0\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"th\", 19);\n      i0.ɵɵtext(35, \"M\\u00E3 v\\u1EADt li\\u1EC7u\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(36, \"th\", 20);\n      i0.ɵɵtext(37, \"\\u0110V\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(38, \"th\", 20);\n      i0.ɵɵtext(39, \"SL\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(40, \"th\", 20);\n      i0.ɵɵtext(41, \"VL\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(42, \"th\", 20);\n      i0.ɵɵtext(43, \"KL\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(44, \"th\", 19);\n      i0.ɵɵtext(45, \"H\\u00E3ng s\\u1EA3n xu\\u1EA5t\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(46, \"th\", 21);\n      i0.ɵɵtext(47, \"Ghi ch\\u00FA\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(48, \"th\", 19);\n      i0.ɵɵtext(49, \"T\\u00EAn nh\\u00F3m v\\u1EADt t\\u01B0\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(50, \"th\", 21);\n      i0.ɵɵtext(51, \"M\\u00E3 nh\\u00F3m v\\u1EADt t\\u01B0\");\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(52, \"perfect-scrollbar\", 22)(53, \"table\", 23)(54, \"tbody\");\n      i0.ɵɵtemplate(55, TestStandardSuppliesComponent_tr_55_Template, 27, 13, \"tr\", 24);\n      i0.ɵɵelementEnd()()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngModel\", ctx.pathDMVT);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disabled\", ctx.listDMVT.length == 0);\n      i0.ɵɵadvance(40);\n      i0.ɵɵproperty(\"config\", ctx.constant.ScrollConfig);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listDMVT);\n    }\n  }\n});\n\n__decorate([BlockUI()], TestStandardSuppliesComponent.prototype, \"blockUI\", void 0);","map":null,"metadata":{},"sourceType":"module"}