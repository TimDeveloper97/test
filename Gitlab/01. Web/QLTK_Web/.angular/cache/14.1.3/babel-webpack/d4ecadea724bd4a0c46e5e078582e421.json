{"ast":null,"code":"(function () {\n  var table = function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var noop = function () {\n      var x = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        x[_i] = arguments[_i];\n      }\n    };\n\n    var noarg = function (f) {\n      return function () {\n        var x = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          x[_i] = arguments[_i];\n        }\n\n        return f();\n      };\n    };\n\n    var compose = function (fa, fb) {\n      return function () {\n        var x = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          x[_i] = arguments[_i];\n        }\n\n        return fa(fb.apply(null, arguments));\n      };\n    };\n\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n\n    var identity = function (x) {\n      return x;\n    };\n\n    var tripleEquals = function (a, b) {\n      return a === b;\n    };\n\n    var curry = function (f) {\n      var x = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n\n      var args = new Array(arguments.length - 1);\n\n      for (var i = 1; i < arguments.length; i++) args[i - 1] = arguments[i];\n\n      return function () {\n        var x = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          x[_i] = arguments[_i];\n        }\n\n        var newArgs = new Array(arguments.length);\n\n        for (var j = 0; j < newArgs.length; j++) newArgs[j] = arguments[j];\n\n        var all = args.concat(newArgs);\n        return f.apply(null, all);\n      };\n    };\n\n    var not = function (f) {\n      return function () {\n        var x = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          x[_i] = arguments[_i];\n        }\n\n        return !f.apply(null, arguments);\n      };\n    };\n\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n\n    var apply = function (f) {\n      return f();\n    };\n\n    var call = function (f) {\n      f();\n    };\n\n    var never = constant(false);\n    var always = constant(true);\n    var $_20nfr6k7jfuw8q4g = {\n      noop: noop,\n      noarg: noarg,\n      compose: compose,\n      constant: constant,\n      identity: identity,\n      tripleEquals: tripleEquals,\n      curry: curry,\n      not: not,\n      die: die,\n      apply: apply,\n      call: call,\n      never: never,\n      always: always\n    };\n    var never$1 = $_20nfr6k7jfuw8q4g.never;\n    var always$1 = $_20nfr6k7jfuw8q4g.always;\n\n    var none = function () {\n      return NONE;\n    };\n\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n\n      var call = function (thunk) {\n        return thunk();\n      };\n\n      var id = function (n) {\n        return n;\n      };\n\n      var noop = function () {};\n\n      var me = {\n        fold: function (n, s) {\n          return n();\n        },\n        is: never$1,\n        isSome: never$1,\n        isNone: always$1,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        or: id,\n        orThunk: call,\n        map: none,\n        ap: none,\n        each: noop,\n        bind: none,\n        flatten: none,\n        exists: never$1,\n        forall: always$1,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: $_20nfr6k7jfuw8q4g.constant('none()')\n      };\n      if (Object.freeze) Object.freeze(me);\n      return me;\n    }();\n\n    var some = function (a) {\n      var constant_a = function () {\n        return a;\n      };\n\n      var self = function () {\n        return me;\n      };\n\n      var map = function (f) {\n        return some(f(a));\n      };\n\n      var bind = function (f) {\n        return f(a);\n      };\n\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always$1,\n        isNone: never$1,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        or: self,\n        orThunk: self,\n        map: map,\n        ap: function (optfab) {\n          return optfab.fold(none, function (fab) {\n            return some(fab(a));\n          });\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        flatten: constant_a,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never$1, function (b) {\n            return elementEq(a, b);\n          });\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n\n    var Option = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      if (x === null) return 'null';\n      var t = typeof x;\n      if (t === 'object' && Array.prototype.isPrototypeOf(x)) return 'array';\n      if (t === 'object' && String.prototype.isPrototypeOf(x)) return 'string';\n      return t;\n    };\n\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n\n    var $_g6mvnrk8jfuw8q4k = {\n      isString: isType('string'),\n      isObject: isType('object'),\n      isArray: isType('array'),\n      isNull: isType('null'),\n      isBoolean: isType('boolean'),\n      isUndefined: isType('undefined'),\n      isFunction: isType('function'),\n      isNumber: isType('number')\n    };\n\n    var rawIndexOf = function () {\n      var pIndexOf = Array.prototype.indexOf;\n\n      var fastIndex = function (xs, x) {\n        return pIndexOf.call(xs, x);\n      };\n\n      var slowIndex = function (xs, x) {\n        return slowIndexOf(xs, x);\n      };\n\n      return pIndexOf === undefined ? slowIndex : fastIndex;\n    }();\n\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Option.none() : Option.some(r);\n    };\n\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n\n    var exists = function (xs, pred) {\n      return findIndex(xs, pred).isSome();\n    };\n\n    var range = function (num, f) {\n      var r = [];\n\n      for (var i = 0; i < num; i++) {\n        r.push(f(i));\n      }\n\n      return r;\n    };\n\n    var chunk = function (array, size) {\n      var r = [];\n\n      for (var i = 0; i < array.length; i += size) {\n        var s = array.slice(i, i + size);\n        r.push(s);\n      }\n\n      return r;\n    };\n\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i, xs);\n      }\n\n      return r;\n    };\n\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i, xs);\n      }\n    };\n\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i, xs);\n      }\n    };\n\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i, xs) ? pass : fail;\n        arr.push(x);\n      }\n\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n\n    var filter = function (xs, pred) {\n      var r = [];\n\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n\n        if (pred(x, i, xs)) {\n          r.push(x);\n        }\n      }\n\n      return r;\n    };\n\n    var groupBy = function (xs, f) {\n      if (xs.length === 0) {\n        return [];\n      } else {\n        var wasType = f(xs[0]);\n        var r = [];\n        var group = [];\n\n        for (var i = 0, len = xs.length; i < len; i++) {\n          var x = xs[i];\n          var type = f(x);\n\n          if (type !== wasType) {\n            r.push(group);\n            group = [];\n          }\n\n          wasType = type;\n          group.push(x);\n        }\n\n        if (group.length !== 0) {\n          r.push(group);\n        }\n\n        return r;\n      }\n    };\n\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n\n    var find = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n\n        if (pred(x, i, xs)) {\n          return Option.some(x);\n        }\n      }\n\n      return Option.none();\n    };\n\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n\n        if (pred(x, i, xs)) {\n          return Option.some(i);\n        }\n      }\n\n      return Option.none();\n    };\n\n    var slowIndexOf = function (xs, x) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (xs[i] === x) {\n          return i;\n        }\n      }\n\n      return -1;\n    };\n\n    var push = Array.prototype.push;\n\n    var flatten = function (xs) {\n      var r = [];\n\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!Array.prototype.isPrototypeOf(xs[i])) throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        push.apply(r, xs[i]);\n      }\n\n      return r;\n    };\n\n    var bind = function (xs, f) {\n      var output = map(xs, f);\n      return flatten(output);\n    };\n\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n\n        if (pred(x, i, xs) !== true) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n\n    var equal = function (a1, a2) {\n      return a1.length === a2.length && forall(a1, function (x, i) {\n        return x === a2[i];\n      });\n    };\n\n    var slice = Array.prototype.slice;\n\n    var reverse = function (xs) {\n      var r = slice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n\n    var mapToObject = function (xs, f) {\n      var r = {};\n\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n\n      return r;\n    };\n\n    var pure = function (x) {\n      return [x];\n    };\n\n    var sort = function (xs, comparator) {\n      var copy = slice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n\n    var head = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n    };\n\n    var last = function (xs) {\n      return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n    };\n\n    var from$1 = $_g6mvnrk8jfuw8q4k.isFunction(Array.from) ? Array.from : function (x) {\n      return slice.call(x);\n    };\n    var $_tyr3yk5jfuw8q47 = {\n      map: map,\n      each: each,\n      eachr: eachr,\n      partition: partition,\n      filter: filter,\n      groupBy: groupBy,\n      indexOf: indexOf,\n      foldr: foldr,\n      foldl: foldl,\n      find: find,\n      findIndex: findIndex,\n      flatten: flatten,\n      bind: bind,\n      forall: forall,\n      exists: exists,\n      contains: contains,\n      equal: equal,\n      reverse: reverse,\n      chunk: chunk,\n      difference: difference,\n      mapToObject: mapToObject,\n      pure: pure,\n      sort: sort,\n      range: range,\n      head: head,\n      last: last,\n      from: from$1\n    };\n\n    var keys = function () {\n      var fastKeys = Object.keys;\n\n      var slowKeys = function (o) {\n        var r = [];\n\n        for (var i in o) {\n          if (o.hasOwnProperty(i)) {\n            r.push(i);\n          }\n        }\n\n        return r;\n      };\n\n      return fastKeys === undefined ? slowKeys : fastKeys;\n    }();\n\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i, obj);\n      }\n    };\n\n    var objectMap = function (obj, f) {\n      return tupleMap(obj, function (x, i, obj) {\n        return {\n          k: i,\n          v: f(x, i, obj)\n        };\n      });\n    };\n\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i, obj);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n\n    var bifilter = function (obj, pred) {\n      var t = {};\n      var f = {};\n      each$1(obj, function (x, i) {\n        var branch = pred(x, i) ? t : f;\n        branch[i] = x;\n      });\n      return {\n        t: t,\n        f: f\n      };\n    };\n\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$1(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n\n    var find$1 = function (obj, pred) {\n      var props = keys(obj);\n\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n\n        if (pred(x, i, obj)) {\n          return Option.some(x);\n        }\n      }\n\n      return Option.none();\n    };\n\n    var values = function (obj) {\n      return mapToArray(obj, function (v) {\n        return v;\n      });\n    };\n\n    var size = function (obj) {\n      return values(obj).length;\n    };\n\n    var $_11yiupkajfuw8q5c = {\n      bifilter: bifilter,\n      each: each$1,\n      map: objectMap,\n      mapToArray: mapToArray,\n      tupleMap: tupleMap,\n      find: find$1,\n      keys: keys,\n      values: values,\n      size: size\n    };\n\n    function Immutable() {\n      var fields = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        fields[_i] = arguments[_i];\n      }\n\n      return function () {\n        var values = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n\n        if (fields.length !== values.length) {\n          throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n        }\n\n        var struct = {};\n        $_tyr3yk5jfuw8q47.each(fields, function (name, i) {\n          struct[name] = $_20nfr6k7jfuw8q4g.constant(values[i]);\n        });\n        return struct;\n      };\n    }\n\n    var sort$1 = function (arr) {\n      return arr.slice(0).sort();\n    };\n\n    var reqMessage = function (required, keys) {\n      throw new Error('All required keys (' + sort$1(required).join(', ') + ') were not specified. Specified keys were: ' + sort$1(keys).join(', ') + '.');\n    };\n\n    var unsuppMessage = function (unsupported) {\n      throw new Error('Unsupported keys for object: ' + sort$1(unsupported).join(', '));\n    };\n\n    var validateStrArr = function (label, array) {\n      if (!$_g6mvnrk8jfuw8q4k.isArray(array)) throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n      $_tyr3yk5jfuw8q47.each(array, function (a) {\n        if (!$_g6mvnrk8jfuw8q4k.isString(a)) throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n      });\n    };\n\n    var invalidTypeMessage = function (incorrect, type) {\n      throw new Error('All values need to be of type: ' + type + '. Keys (' + sort$1(incorrect).join(', ') + ') were not.');\n    };\n\n    var checkDupes = function (everything) {\n      var sorted = sort$1(everything);\n      var dupe = $_tyr3yk5jfuw8q47.find(sorted, function (s, i) {\n        return i < sorted.length - 1 && s === sorted[i + 1];\n      });\n      dupe.each(function (d) {\n        throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n      });\n    };\n\n    var $_2j2nzkkejfuw8q5j = {\n      sort: sort$1,\n      reqMessage: reqMessage,\n      unsuppMessage: unsuppMessage,\n      validateStrArr: validateStrArr,\n      invalidTypeMessage: invalidTypeMessage,\n      checkDupes: checkDupes\n    };\n\n    function MixedBag(required, optional) {\n      var everything = required.concat(optional);\n      if (everything.length === 0) throw new Error('You must specify at least one required or optional field.');\n      $_2j2nzkkejfuw8q5j.validateStrArr('required', required);\n      $_2j2nzkkejfuw8q5j.validateStrArr('optional', optional);\n      $_2j2nzkkejfuw8q5j.checkDupes(everything);\n      return function (obj) {\n        var keys = $_11yiupkajfuw8q5c.keys(obj);\n        var allReqd = $_tyr3yk5jfuw8q47.forall(required, function (req) {\n          return $_tyr3yk5jfuw8q47.contains(keys, req);\n        });\n        if (!allReqd) $_2j2nzkkejfuw8q5j.reqMessage(required, keys);\n        var unsupported = $_tyr3yk5jfuw8q47.filter(keys, function (key) {\n          return !$_tyr3yk5jfuw8q47.contains(everything, key);\n        });\n        if (unsupported.length > 0) $_2j2nzkkejfuw8q5j.unsuppMessage(unsupported);\n        var r = {};\n        $_tyr3yk5jfuw8q47.each(required, function (req) {\n          r[req] = $_20nfr6k7jfuw8q4g.constant(obj[req]);\n        });\n        $_tyr3yk5jfuw8q47.each(optional, function (opt) {\n          r[opt] = $_20nfr6k7jfuw8q4g.constant(Object.prototype.hasOwnProperty.call(obj, opt) ? Option.some(obj[opt]) : Option.none());\n        });\n        return r;\n      };\n    }\n\n    var $_5now9kbjfuw8q5e = {\n      immutable: Immutable,\n      immutableBag: MixedBag\n    };\n    var dimensions = $_5now9kbjfuw8q5e.immutable('width', 'height');\n    var grid = $_5now9kbjfuw8q5e.immutable('rows', 'columns');\n    var address = $_5now9kbjfuw8q5e.immutable('row', 'column');\n    var coords = $_5now9kbjfuw8q5e.immutable('x', 'y');\n    var detail = $_5now9kbjfuw8q5e.immutable('element', 'rowspan', 'colspan');\n    var detailnew = $_5now9kbjfuw8q5e.immutable('element', 'rowspan', 'colspan', 'isNew');\n    var extended = $_5now9kbjfuw8q5e.immutable('element', 'rowspan', 'colspan', 'row', 'column');\n    var rowdata = $_5now9kbjfuw8q5e.immutable('element', 'cells', 'section');\n    var elementnew = $_5now9kbjfuw8q5e.immutable('element', 'isNew');\n    var rowdatanew = $_5now9kbjfuw8q5e.immutable('element', 'cells', 'section', 'isNew');\n    var rowcells = $_5now9kbjfuw8q5e.immutable('cells', 'section');\n    var rowdetails = $_5now9kbjfuw8q5e.immutable('details', 'section');\n    var bounds = $_5now9kbjfuw8q5e.immutable('startRow', 'startCol', 'finishRow', 'finishCol');\n    var $_ce5pyrkgjfuw8q5v = {\n      dimensions: dimensions,\n      grid: grid,\n      address: address,\n      coords: coords,\n      extended: extended,\n      detail: detail,\n      detailnew: detailnew,\n      rowdata: rowdata,\n      elementnew: elementnew,\n      rowdatanew: rowdatanew,\n      rowcells: rowcells,\n      rowdetails: rowdetails,\n      bounds: bounds\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw 'HTML must have a single root node';\n      }\n\n      return fromDom(div.childNodes[0]);\n    };\n\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n\n    var fromDom = function (node) {\n      if (node === null || node === undefined) throw new Error('Node cannot be null or undefined');\n      return {\n        dom: $_20nfr6k7jfuw8q4g.constant(node)\n      };\n    };\n\n    var fromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().elementFromPoint(x, y)).map(fromDom);\n    };\n\n    var $_xbeoqkkjfuw8q73 = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n    var $_x3hpikljfuw8q78 = {\n      ATTRIBUTE: 2,\n      CDATA_SECTION: 4,\n      COMMENT: 8,\n      DOCUMENT: 9,\n      DOCUMENT_TYPE: 10,\n      DOCUMENT_FRAGMENT: 11,\n      ELEMENT: 1,\n      TEXT: 3,\n      PROCESSING_INSTRUCTION: 7,\n      ENTITY_REFERENCE: 5,\n      ENTITY: 6,\n      NOTATION: 12\n    };\n    var ELEMENT = $_x3hpikljfuw8q78.ELEMENT;\n    var DOCUMENT = $_x3hpikljfuw8q78.DOCUMENT;\n\n    var is = function (element, selector) {\n      var elem = element.dom();\n      if (elem.nodeType !== ELEMENT) return false;else if (elem.matches !== undefined) return elem.matches(selector);else if (elem.msMatchesSelector !== undefined) return elem.msMatchesSelector(selector);else if (elem.webkitMatchesSelector !== undefined) return elem.webkitMatchesSelector(selector);else if (elem.mozMatchesSelector !== undefined) return elem.mozMatchesSelector(selector);else throw new Error('Browser lacks native selectors');\n    };\n\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT || dom.childElementCount === 0;\n    };\n\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom();\n      return bypassSelector(base) ? [] : $_tyr3yk5jfuw8q47.map(base.querySelectorAll(selector), $_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom();\n      return bypassSelector(base) ? Option.none() : Option.from(base.querySelector(selector)).map($_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var $_enn9uikjjfuw8q6w = {\n      all: all,\n      is: is,\n      one: one\n    };\n\n    var toArray = function (target, f) {\n      var r = [];\n\n      var recurse = function (e) {\n        r.push(e);\n        return f(e);\n      };\n\n      var cur = f(target);\n\n      do {\n        cur = cur.bind(recurse);\n      } while (cur.isSome());\n\n      return r;\n    };\n\n    var $_myhefknjfuw8q7m = {\n      toArray: toArray\n    };\n    var global$1 = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var path = function (parts, scope) {\n      var o = scope !== undefined && scope !== null ? scope : global$1;\n\n      for (var i = 0; i < parts.length && o !== undefined && o !== null; ++i) o = o[parts[i]];\n\n      return o;\n    };\n\n    var resolve = function (p, scope) {\n      var parts = p.split('.');\n      return path(parts, scope);\n    };\n\n    var step = function (o, part) {\n      if (o[part] === undefined || o[part] === null) o[part] = {};\n      return o[part];\n    };\n\n    var forge = function (parts, target) {\n      var o = target !== undefined ? target : global$1;\n\n      for (var i = 0; i < parts.length; ++i) o = step(o, parts[i]);\n\n      return o;\n    };\n\n    var namespace = function (name, target) {\n      var parts = name.split('.');\n      return forge(parts, target);\n    };\n\n    var $_1but6zkrjfuw8q81 = {\n      path: path,\n      resolve: resolve,\n      forge: forge,\n      namespace: namespace\n    };\n\n    var unsafe = function (name, scope) {\n      return $_1but6zkrjfuw8q81.resolve(name, scope);\n    };\n\n    var getOrDie = function (name, scope) {\n      var actual = unsafe(name, scope);\n      if (actual === undefined || actual === null) throw name + ' not available on this browser';\n      return actual;\n    };\n\n    var $_3og7cjkqjfuw8q7y = {\n      getOrDie: getOrDie\n    };\n\n    var node = function () {\n      var f = $_3og7cjkqjfuw8q7y.getOrDie('Node');\n      return f;\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n\n    var documentPositionPreceding = function (a, b) {\n      return compareDocumentPosition(a, b, node().DOCUMENT_POSITION_PRECEDING);\n    };\n\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, node().DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var $_3crkomkpjfuw8q7x = {\n      documentPositionPreceding: documentPositionPreceding,\n      documentPositionContainedBy: documentPositionContainedBy\n    };\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        if (!called) {\n          called = true;\n          r = f.apply(null, arguments);\n        }\n\n        return r;\n      };\n    };\n\n    var $_cfqymdkujfuw8q85 = {\n      cached: cached\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) return x;\n      }\n\n      return undefined;\n    };\n\n    var find$2 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) return {\n        major: 0,\n        minor: 0\n      };\n\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n\n      return nu(group(1), group(2));\n    };\n\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) return unknown();\n      return find$2(versionRegexes, cleanedAgent);\n    };\n\n    var unknown = function () {\n      return nu(0, 0);\n    };\n\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n\n    var $_yulx6kxjfuw8q8c = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n\n    var isBrowser = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: $_yulx6kxjfuw8q8c.unknown()\n      });\n    };\n\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge, current),\n        isChrome: isBrowser(chrome, current),\n        isIE: isBrowser(ie, current),\n        isOpera: isBrowser(opera, current),\n        isFirefox: isBrowser(firefox, current),\n        isSafari: isBrowser(safari, current)\n      };\n    };\n\n    var $_1x5z0nkwjfuw8q88 = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: $_20nfr6k7jfuw8q4g.constant(edge),\n      chrome: $_20nfr6k7jfuw8q4g.constant(chrome),\n      ie: $_20nfr6k7jfuw8q4g.constant(ie),\n      opera: $_20nfr6k7jfuw8q4g.constant(opera),\n      firefox: $_20nfr6k7jfuw8q4g.constant(firefox),\n      safari: $_20nfr6k7jfuw8q4g.constant(safari)\n    };\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n\n    var isOS = function (name, current) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: $_yulx6kxjfuw8q8c.unknown()\n      });\n    };\n\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows, current),\n        isiOS: isOS(ios, current),\n        isAndroid: isOS(android, current),\n        isOSX: isOS(osx, current),\n        isLinux: isOS(linux, current),\n        isSolaris: isOS(solaris, current),\n        isFreeBSD: isOS(freebsd, current)\n      };\n    };\n\n    var $_87zg95kyjfuw8q8d = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: $_20nfr6k7jfuw8q4g.constant(windows),\n      ios: $_20nfr6k7jfuw8q4g.constant(ios),\n      android: $_20nfr6k7jfuw8q4g.constant(android),\n      linux: $_20nfr6k7jfuw8q4g.constant(linux),\n      osx: $_20nfr6k7jfuw8q4g.constant(osx),\n      solaris: $_20nfr6k7jfuw8q4g.constant(solaris),\n      freebsd: $_20nfr6k7jfuw8q4g.constant(freebsd)\n    };\n\n    function DeviceType(os, browser, userAgent) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isAndroid3 = os.isAndroid() && os.version.major === 3;\n      var isAndroid4 = os.isAndroid() && os.version.major === 4;\n      var isTablet = isiPad || isAndroid3 || isAndroid4 && /mobile/i.test(userAgent) === true;\n      var isTouch = os.isiOS() || os.isAndroid();\n      var isPhone = isTouch && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      return {\n        isiPad: $_20nfr6k7jfuw8q4g.constant(isiPad),\n        isiPhone: $_20nfr6k7jfuw8q4g.constant(isiPhone),\n        isTablet: $_20nfr6k7jfuw8q4g.constant(isTablet),\n        isPhone: $_20nfr6k7jfuw8q4g.constant(isPhone),\n        isTouch: $_20nfr6k7jfuw8q4g.constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: $_20nfr6k7jfuw8q4g.constant(iOSwebview)\n      };\n    }\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return $_tyr3yk5jfuw8q47.find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = $_yulx6kxjfuw8q8c.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = $_yulx6kxjfuw8q8c.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n\n    var $_62ehlbl0jfuw8q8o = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var addToStart = function (str, prefix) {\n      return prefix + str;\n    };\n\n    var addToEnd = function (str, suffix) {\n      return str + suffix;\n    };\n\n    var removeFromStart = function (str, numChars) {\n      return str.substring(numChars);\n    };\n\n    var removeFromEnd = function (str, numChars) {\n      return str.substring(0, str.length - numChars);\n    };\n\n    var $_1u5wzbl3jfuw8q90 = {\n      addToStart: addToStart,\n      addToEnd: addToEnd,\n      removeFromStart: removeFromStart,\n      removeFromEnd: removeFromEnd\n    };\n\n    var first = function (str, count) {\n      return str.substr(0, count);\n    };\n\n    var last$1 = function (str, count) {\n      return str.substr(str.length - count, str.length);\n    };\n\n    var head$1 = function (str) {\n      return str === '' ? Option.none() : Option.some(str.substr(0, 1));\n    };\n\n    var tail = function (str) {\n      return str === '' ? Option.none() : Option.some(str.substring(1));\n    };\n\n    var $_6v04e7l4jfuw8q91 = {\n      first: first,\n      last: last$1,\n      head: head$1,\n      tail: tail\n    };\n\n    var checkRange = function (str, substr, start) {\n      if (substr === '') return true;\n      if (str.length < substr.length) return false;\n      var x = str.substr(start, start + substr.length);\n      return x === substr;\n    };\n\n    var supplant = function (str, obj) {\n      var isStringOrNumber = function (a) {\n        var t = typeof a;\n        return t === 'string' || t === 'number';\n      };\n\n      return str.replace(/\\${([^{}]*)}/g, function (a, b) {\n        var value = obj[b];\n        return isStringOrNumber(value) ? value : a;\n      });\n    };\n\n    var removeLeading = function (str, prefix) {\n      return startsWith(str, prefix) ? $_1u5wzbl3jfuw8q90.removeFromStart(str, prefix.length) : str;\n    };\n\n    var removeTrailing = function (str, prefix) {\n      return endsWith(str, prefix) ? $_1u5wzbl3jfuw8q90.removeFromEnd(str, prefix.length) : str;\n    };\n\n    var ensureLeading = function (str, prefix) {\n      return startsWith(str, prefix) ? str : $_1u5wzbl3jfuw8q90.addToStart(str, prefix);\n    };\n\n    var ensureTrailing = function (str, prefix) {\n      return endsWith(str, prefix) ? str : $_1u5wzbl3jfuw8q90.addToEnd(str, prefix);\n    };\n\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n\n    var capitalize = function (str) {\n      return $_6v04e7l4jfuw8q91.head(str).bind(function (head) {\n        return $_6v04e7l4jfuw8q91.tail(str).map(function (tail) {\n          return head.toUpperCase() + tail;\n        });\n      }).getOr(str);\n    };\n\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n\n    var trim = function (str) {\n      return str.replace(/^\\s+|\\s+$/g, '');\n    };\n\n    var lTrim = function (str) {\n      return str.replace(/^\\s+/g, '');\n    };\n\n    var rTrim = function (str) {\n      return str.replace(/\\s+$/g, '');\n    };\n\n    var $_ey09l9l2jfuw8q8y = {\n      supplant: supplant,\n      startsWith: startsWith,\n      removeLeading: removeLeading,\n      removeTrailing: removeTrailing,\n      ensureLeading: ensureLeading,\n      ensureTrailing: ensureTrailing,\n      endsWith: endsWith,\n      contains: contains$1,\n      trim: trim,\n      lTrim: lTrim,\n      rTrim: rTrim,\n      capitalize: capitalize\n    };\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n    var checkContains = function (target) {\n      return function (uastring) {\n        return $_ey09l9l2jfuw8q8y.contains(uastring, target);\n      };\n    };\n\n    var browsers = [{\n      name: 'Edge',\n      versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n      search: function (uastring) {\n        var monstrosity = $_ey09l9l2jfuw8q8y.contains(uastring, 'edge/') && $_ey09l9l2jfuw8q8y.contains(uastring, 'chrome') && $_ey09l9l2jfuw8q8y.contains(uastring, 'safari') && $_ey09l9l2jfuw8q8y.contains(uastring, 'applewebkit');\n        return monstrosity;\n      }\n    }, {\n      name: 'Chrome',\n      versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n      search: function (uastring) {\n        return $_ey09l9l2jfuw8q8y.contains(uastring, 'chrome') && !$_ey09l9l2jfuw8q8y.contains(uastring, 'chromeframe');\n      }\n    }, {\n      name: 'IE',\n      versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n      search: function (uastring) {\n        return $_ey09l9l2jfuw8q8y.contains(uastring, 'msie') || $_ey09l9l2jfuw8q8y.contains(uastring, 'trident');\n      }\n    }, {\n      name: 'Opera',\n      versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n      search: checkContains('opera')\n    }, {\n      name: 'Firefox',\n      versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n      search: checkContains('firefox')\n    }, {\n      name: 'Safari',\n      versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n      search: function (uastring) {\n        return ($_ey09l9l2jfuw8q8y.contains(uastring, 'safari') || $_ey09l9l2jfuw8q8y.contains(uastring, 'mobile/')) && $_ey09l9l2jfuw8q8y.contains(uastring, 'applewebkit');\n      }\n    }];\n    var oses = [{\n      name: 'Windows',\n      search: checkContains('win'),\n      versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n    }, {\n      name: 'iOS',\n      search: function (uastring) {\n        return $_ey09l9l2jfuw8q8y.contains(uastring, 'iphone') || $_ey09l9l2jfuw8q8y.contains(uastring, 'ipad');\n      },\n      versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n    }, {\n      name: 'Android',\n      search: checkContains('android'),\n      versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n    }, {\n      name: 'OSX',\n      search: checkContains('os x'),\n      versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n    }, {\n      name: 'Linux',\n      search: checkContains('linux'),\n      versionRegexes: []\n    }, {\n      name: 'Solaris',\n      search: checkContains('sunos'),\n      versionRegexes: []\n    }, {\n      name: 'FreeBSD',\n      search: checkContains('freebsd'),\n      versionRegexes: []\n    }];\n    var $_6xdjg7l1jfuw8q8s = {\n      browsers: $_20nfr6k7jfuw8q4g.constant(browsers),\n      oses: $_20nfr6k7jfuw8q4g.constant(oses)\n    };\n\n    var detect$2 = function (userAgent) {\n      var browsers = $_6xdjg7l1jfuw8q8s.browsers();\n      var oses = $_6xdjg7l1jfuw8q8s.oses();\n      var browser = $_62ehlbl0jfuw8q8o.detectBrowser(browsers, userAgent).fold($_1x5z0nkwjfuw8q88.unknown, $_1x5z0nkwjfuw8q88.nu);\n      var os = $_62ehlbl0jfuw8q8o.detectOs(oses, userAgent).fold($_87zg95kyjfuw8q8d.unknown, $_87zg95kyjfuw8q8d.nu);\n      var deviceType = DeviceType(os, browser, userAgent);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n\n    var $_5kufzskvjfuw8q87 = {\n      detect: detect$2\n    };\n    var detect$3 = $_cfqymdkujfuw8q85.cached(function () {\n      var userAgent = navigator.userAgent;\n      return $_5kufzskvjfuw8q87.detect(userAgent);\n    });\n    var $_fqgee0ktjfuw8q83 = {\n      detect: detect$3\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom() === e2.dom();\n    };\n\n    var isEqualNode = function (e1, e2) {\n      return e1.dom().isEqualNode(e2.dom());\n    };\n\n    var member = function (element, elements) {\n      return $_tyr3yk5jfuw8q47.exists(elements, $_20nfr6k7jfuw8q4g.curry(eq, element));\n    };\n\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom(),\n          d2 = e2.dom();\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n\n    var ieContains = function (e1, e2) {\n      return $_3crkomkpjfuw8q7x.documentPositionContainedBy(e1.dom(), e2.dom());\n    };\n\n    var browser = $_fqgee0ktjfuw8q83.detect().browser;\n    var contains$2 = browser.isIE() ? ieContains : regularContains;\n    var $_e8rn66kojfuw8q7n = {\n      eq: eq,\n      isEqualNode: isEqualNode,\n      member: member,\n      contains: contains$2,\n      is: $_enn9uikjjfuw8q6w.is\n    };\n\n    var owner = function (element) {\n      return $_xbeoqkkjfuw8q73.fromDom(element.dom().ownerDocument);\n    };\n\n    var documentElement = function (element) {\n      var doc = owner(element);\n      return $_xbeoqkkjfuw8q73.fromDom(doc.dom().documentElement);\n    };\n\n    var defaultView = function (element) {\n      var el = element.dom();\n      var defaultView = el.ownerDocument.defaultView;\n      return $_xbeoqkkjfuw8q73.fromDom(defaultView);\n    };\n\n    var parent = function (element) {\n      var dom = element.dom();\n      return Option.from(dom.parentNode).map($_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var findIndex$1 = function (element) {\n      return parent(element).bind(function (p) {\n        var kin = children(p);\n        return $_tyr3yk5jfuw8q47.findIndex(kin, function (elem) {\n          return $_e8rn66kojfuw8q7n.eq(element, elem);\n        });\n      });\n    };\n\n    var parents = function (element, isRoot) {\n      var stop = $_g6mvnrk8jfuw8q4k.isFunction(isRoot) ? isRoot : $_20nfr6k7jfuw8q4g.constant(false);\n      var dom = element.dom();\n      var ret = [];\n\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var parent = $_xbeoqkkjfuw8q73.fromDom(rawParent);\n        ret.push(parent);\n        if (stop(parent) === true) break;else dom = rawParent;\n      }\n\n      return ret;\n    };\n\n    var siblings = function (element) {\n      var filterSelf = function (elements) {\n        return $_tyr3yk5jfuw8q47.filter(elements, function (x) {\n          return !$_e8rn66kojfuw8q7n.eq(element, x);\n        });\n      };\n\n      return parent(element).map(children).map(filterSelf).getOr([]);\n    };\n\n    var offsetParent = function (element) {\n      var dom = element.dom();\n      return Option.from(dom.offsetParent).map($_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var prevSibling = function (element) {\n      var dom = element.dom();\n      return Option.from(dom.previousSibling).map($_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var nextSibling = function (element) {\n      var dom = element.dom();\n      return Option.from(dom.nextSibling).map($_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var prevSiblings = function (element) {\n      return $_tyr3yk5jfuw8q47.reverse($_myhefknjfuw8q7m.toArray(element, prevSibling));\n    };\n\n    var nextSiblings = function (element) {\n      return $_myhefknjfuw8q7m.toArray(element, nextSibling);\n    };\n\n    var children = function (element) {\n      var dom = element.dom();\n      return $_tyr3yk5jfuw8q47.map(dom.childNodes, $_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var child = function (element, index) {\n      var children = element.dom().childNodes;\n      return Option.from(children[index]).map($_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n\n    var lastChild = function (element) {\n      return child(element, element.dom().childNodes.length - 1);\n    };\n\n    var childNodesCount = function (element) {\n      return element.dom().childNodes.length;\n    };\n\n    var hasChildNodes = function (element) {\n      return element.dom().hasChildNodes();\n    };\n\n    var spot = $_5now9kbjfuw8q5e.immutable('element', 'offset');\n\n    var leaf = function (element, offset) {\n      var cs = children(element);\n      return cs.length > 0 && offset < cs.length ? spot(cs[offset], 0) : spot(element, offset);\n    };\n\n    var $_s8scrkmjfuw8q7a = {\n      owner: owner,\n      defaultView: defaultView,\n      documentElement: documentElement,\n      parent: parent,\n      findIndex: findIndex$1,\n      parents: parents,\n      siblings: siblings,\n      prevSibling: prevSibling,\n      offsetParent: offsetParent,\n      prevSiblings: prevSiblings,\n      nextSibling: nextSibling,\n      nextSiblings: nextSiblings,\n      children: children,\n      child: child,\n      firstChild: firstChild,\n      lastChild: lastChild,\n      childNodesCount: childNodesCount,\n      hasChildNodes: hasChildNodes,\n      leaf: leaf\n    };\n\n    var firstLayer = function (scope, selector) {\n      return filterFirstLayer(scope, selector, $_20nfr6k7jfuw8q4g.constant(true));\n    };\n\n    var filterFirstLayer = function (scope, selector, predicate) {\n      return $_tyr3yk5jfuw8q47.bind($_s8scrkmjfuw8q7a.children(scope), function (x) {\n        return $_enn9uikjjfuw8q6w.is(x, selector) ? predicate(x) ? [x] : [] : filterFirstLayer(x, selector, predicate);\n      });\n    };\n\n    var $_2g609akijfuw8q6n = {\n      firstLayer: firstLayer,\n      filterFirstLayer: filterFirstLayer\n    };\n\n    var name = function (element) {\n      var r = element.dom().nodeName;\n      return r.toLowerCase();\n    };\n\n    var type = function (element) {\n      return element.dom().nodeType;\n    };\n\n    var value = function (element) {\n      return element.dom().nodeValue;\n    };\n\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n\n    var isComment = function (element) {\n      return type(element) === $_x3hpikljfuw8q78.COMMENT || name(element) === '#comment';\n    };\n\n    var isElement = isType$1($_x3hpikljfuw8q78.ELEMENT);\n    var isText = isType$1($_x3hpikljfuw8q78.TEXT);\n    var isDocument = isType$1($_x3hpikljfuw8q78.DOCUMENT);\n    var $_a8gk30l6jfuw8q9c = {\n      name: name,\n      type: type,\n      value: value,\n      isElement: isElement,\n      isText: isText,\n      isDocument: isDocument,\n      isComment: isComment\n    };\n\n    var rawSet = function (dom, key, value) {\n      if ($_g6mvnrk8jfuw8q4k.isString(value) || $_g6mvnrk8jfuw8q4k.isBoolean(value) || $_g6mvnrk8jfuw8q4k.isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n\n    var set = function (element, key, value) {\n      rawSet(element.dom(), key, value);\n    };\n\n    var setAll = function (element, attrs) {\n      var dom = element.dom();\n      $_11yiupkajfuw8q5c.each(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n\n    var get = function (element, key) {\n      var v = element.dom().getAttribute(key);\n      return v === null ? undefined : v;\n    };\n\n    var has = function (element, key) {\n      var dom = element.dom();\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n\n    var remove = function (element, key) {\n      element.dom().removeAttribute(key);\n    };\n\n    var hasNone = function (element) {\n      var attrs = element.dom().attributes;\n      return attrs === undefined || attrs === null || attrs.length === 0;\n    };\n\n    var clone = function (element) {\n      return $_tyr3yk5jfuw8q47.foldl(element.dom().attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var transferOne = function (source, destination, attr) {\n      if (has(source, attr) && !has(destination, attr)) set(destination, attr, get(source, attr));\n    };\n\n    var transfer = function (source, destination, attrs) {\n      if (!$_a8gk30l6jfuw8q9c.isElement(source) || !$_a8gk30l6jfuw8q9c.isElement(destination)) return;\n      $_tyr3yk5jfuw8q47.each(attrs, function (attr) {\n        transferOne(source, destination, attr);\n      });\n    };\n\n    var $_3q82t2l5jfuw8q93 = {\n      clone: clone,\n      set: set,\n      setAll: setAll,\n      get: get,\n      has: has,\n      remove: remove,\n      hasNone: hasNone,\n      transfer: transfer\n    };\n\n    var inBody = function (element) {\n      var dom = $_a8gk30l6jfuw8q9c.isText(element) ? element.dom().parentNode : element.dom();\n      return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n    };\n\n    var body = $_cfqymdkujfuw8q85.cached(function () {\n      return getBody($_xbeoqkkjfuw8q73.fromDom(document));\n    });\n\n    var getBody = function (doc) {\n      var body = doc.dom().body;\n      if (body === null || body === undefined) throw 'Body is not available yet';\n      return $_xbeoqkkjfuw8q73.fromDom(body);\n    };\n\n    var $_atd1tul9jfuw8q9i = {\n      body: body,\n      getBody: getBody,\n      inBody: inBody\n    };\n\n    var all$1 = function (predicate) {\n      return descendants($_atd1tul9jfuw8q9i.body(), predicate);\n    };\n\n    var ancestors = function (scope, predicate, isRoot) {\n      return $_tyr3yk5jfuw8q47.filter($_s8scrkmjfuw8q7a.parents(scope, isRoot), predicate);\n    };\n\n    var siblings$1 = function (scope, predicate) {\n      return $_tyr3yk5jfuw8q47.filter($_s8scrkmjfuw8q7a.siblings(scope), predicate);\n    };\n\n    var children$1 = function (scope, predicate) {\n      return $_tyr3yk5jfuw8q47.filter($_s8scrkmjfuw8q7a.children(scope), predicate);\n    };\n\n    var descendants = function (scope, predicate) {\n      var result = [];\n      $_tyr3yk5jfuw8q47.each($_s8scrkmjfuw8q7a.children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n\n        result = result.concat(descendants(x, predicate));\n      });\n      return result;\n    };\n\n    var $_4d3nfbl8jfuw8q9f = {\n      all: all$1,\n      ancestors: ancestors,\n      siblings: siblings$1,\n      children: children$1,\n      descendants: descendants\n    };\n\n    var all$2 = function (selector) {\n      return $_enn9uikjjfuw8q6w.all(selector);\n    };\n\n    var ancestors$1 = function (scope, selector, isRoot) {\n      return $_4d3nfbl8jfuw8q9f.ancestors(scope, function (e) {\n        return $_enn9uikjjfuw8q6w.is(e, selector);\n      }, isRoot);\n    };\n\n    var siblings$2 = function (scope, selector) {\n      return $_4d3nfbl8jfuw8q9f.siblings(scope, function (e) {\n        return $_enn9uikjjfuw8q6w.is(e, selector);\n      });\n    };\n\n    var children$2 = function (scope, selector) {\n      return $_4d3nfbl8jfuw8q9f.children(scope, function (e) {\n        return $_enn9uikjjfuw8q6w.is(e, selector);\n      });\n    };\n\n    var descendants$1 = function (scope, selector) {\n      return $_enn9uikjjfuw8q6w.all(selector, scope);\n    };\n\n    var $_6c9d0hl7jfuw8q9d = {\n      all: all$2,\n      ancestors: ancestors$1,\n      siblings: siblings$2,\n      children: children$2,\n      descendants: descendants$1\n    };\n\n    function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Option.some(scope) : $_g6mvnrk8jfuw8q4k.isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n    }\n\n    var first$1 = function (predicate) {\n      return descendant($_atd1tul9jfuw8q9i.body(), predicate);\n    };\n\n    var ancestor = function (scope, predicate, isRoot) {\n      var element = scope.dom();\n      var stop = $_g6mvnrk8jfuw8q4k.isFunction(isRoot) ? isRoot : $_20nfr6k7jfuw8q4g.constant(false);\n\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = $_xbeoqkkjfuw8q73.fromDom(element);\n        if (predicate(el)) return Option.some(el);else if (stop(el)) break;\n      }\n\n      return Option.none();\n    };\n\n    var closest = function (scope, predicate, isRoot) {\n      var is = function (scope) {\n        return predicate(scope);\n      };\n\n      return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n    };\n\n    var sibling = function (scope, predicate) {\n      var element = scope.dom();\n      if (!element.parentNode) return Option.none();\n      return child$1($_xbeoqkkjfuw8q73.fromDom(element.parentNode), function (x) {\n        return !$_e8rn66kojfuw8q7n.eq(scope, x) && predicate(x);\n      });\n    };\n\n    var child$1 = function (scope, predicate) {\n      var result = $_tyr3yk5jfuw8q47.find(scope.dom().childNodes, $_20nfr6k7jfuw8q4g.compose(predicate, $_xbeoqkkjfuw8q73.fromDom));\n      return result.map($_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var descendant = function (scope, predicate) {\n      var descend = function (element) {\n        for (var i = 0; i < element.childNodes.length; i++) {\n          if (predicate($_xbeoqkkjfuw8q73.fromDom(element.childNodes[i]))) return Option.some($_xbeoqkkjfuw8q73.fromDom(element.childNodes[i]));\n          var res = descend(element.childNodes[i]);\n          if (res.isSome()) return res;\n        }\n\n        return Option.none();\n      };\n\n      return descend(scope.dom());\n    };\n\n    var $_11ympzlbjfuw8q9n = {\n      first: first$1,\n      ancestor: ancestor,\n      closest: closest,\n      sibling: sibling,\n      child: child$1,\n      descendant: descendant\n    };\n\n    var first$2 = function (selector) {\n      return $_enn9uikjjfuw8q6w.one(selector);\n    };\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return $_11ympzlbjfuw8q9n.ancestor(scope, function (e) {\n        return $_enn9uikjjfuw8q6w.is(e, selector);\n      }, isRoot);\n    };\n\n    var sibling$1 = function (scope, selector) {\n      return $_11ympzlbjfuw8q9n.sibling(scope, function (e) {\n        return $_enn9uikjjfuw8q6w.is(e, selector);\n      });\n    };\n\n    var child$2 = function (scope, selector) {\n      return $_11ympzlbjfuw8q9n.child(scope, function (e) {\n        return $_enn9uikjjfuw8q6w.is(e, selector);\n      });\n    };\n\n    var descendant$1 = function (scope, selector) {\n      return $_enn9uikjjfuw8q6w.one(selector, scope);\n    };\n\n    var closest$1 = function (scope, selector, isRoot) {\n      return ClosestOrAncestor($_enn9uikjjfuw8q6w.is, ancestor$1, scope, selector, isRoot);\n    };\n\n    var $_8wdrbmlajfuw8q9m = {\n      first: first$2,\n      ancestor: ancestor$1,\n      sibling: sibling$1,\n      child: child$2,\n      descendant: descendant$1,\n      closest: closest$1\n    };\n\n    var lookup = function (tags, element, _isRoot) {\n      var isRoot = _isRoot !== undefined ? _isRoot : $_20nfr6k7jfuw8q4g.constant(false);\n      if (isRoot(element)) return Option.none();\n      if ($_tyr3yk5jfuw8q47.contains(tags, $_a8gk30l6jfuw8q9c.name(element))) return Option.some(element);\n\n      var isRootOrUpperTable = function (element) {\n        return $_enn9uikjjfuw8q6w.is(element, 'table') || isRoot(element);\n      };\n\n      return $_8wdrbmlajfuw8q9m.ancestor(element, tags.join(','), isRootOrUpperTable);\n    };\n\n    var cell = function (element, isRoot) {\n      return lookup(['td', 'th'], element, isRoot);\n    };\n\n    var cells = function (ancestor) {\n      return $_2g609akijfuw8q6n.firstLayer(ancestor, 'th,td');\n    };\n\n    var notCell = function (element, isRoot) {\n      return lookup(['caption', 'tr', 'tbody', 'tfoot', 'thead'], element, isRoot);\n    };\n\n    var neighbours = function (selector, element) {\n      return $_s8scrkmjfuw8q7a.parent(element).map(function (parent) {\n        return $_6c9d0hl7jfuw8q9d.children(parent, selector);\n      });\n    };\n\n    var neighbourCells = $_20nfr6k7jfuw8q4g.curry(neighbours, 'th,td');\n    var neighbourRows = $_20nfr6k7jfuw8q4g.curry(neighbours, 'tr');\n\n    var firstCell = function (ancestor) {\n      return $_8wdrbmlajfuw8q9m.descendant(ancestor, 'th,td');\n    };\n\n    var table = function (element, isRoot) {\n      return $_8wdrbmlajfuw8q9m.closest(element, 'table', isRoot);\n    };\n\n    var row = function (element, isRoot) {\n      return lookup(['tr'], element, isRoot);\n    };\n\n    var rows = function (ancestor) {\n      return $_2g609akijfuw8q6n.firstLayer(ancestor, 'tr');\n    };\n\n    var attr = function (element, property) {\n      return parseInt($_3q82t2l5jfuw8q93.get(element, property), 10);\n    };\n\n    var grid$1 = function (element, rowProp, colProp) {\n      var rows = attr(element, rowProp);\n      var cols = attr(element, colProp);\n      return $_ce5pyrkgjfuw8q5v.grid(rows, cols);\n    };\n\n    var $_aqhz9okhjfuw8q5y = {\n      cell: cell,\n      firstCell: firstCell,\n      cells: cells,\n      neighbourCells: neighbourCells,\n      table: table,\n      row: row,\n      rows: rows,\n      notCell: notCell,\n      neighbourRows: neighbourRows,\n      attr: attr,\n      grid: grid$1\n    };\n\n    var fromTable = function (table) {\n      var rows = $_aqhz9okhjfuw8q5y.rows(table);\n      return $_tyr3yk5jfuw8q47.map(rows, function (row) {\n        var element = row;\n        var parent = $_s8scrkmjfuw8q7a.parent(element);\n        var parentSection = parent.bind(function (parent) {\n          var parentName = $_a8gk30l6jfuw8q9c.name(parent);\n          return parentName === 'tfoot' || parentName === 'thead' || parentName === 'tbody' ? parentName : 'tbody';\n        });\n        var cells = $_tyr3yk5jfuw8q47.map($_aqhz9okhjfuw8q5y.cells(row), function (cell) {\n          var rowspan = $_3q82t2l5jfuw8q93.has(cell, 'rowspan') ? parseInt($_3q82t2l5jfuw8q93.get(cell, 'rowspan'), 10) : 1;\n          var colspan = $_3q82t2l5jfuw8q93.has(cell, 'colspan') ? parseInt($_3q82t2l5jfuw8q93.get(cell, 'colspan'), 10) : 1;\n          return $_ce5pyrkgjfuw8q5v.detail(cell, rowspan, colspan);\n        });\n        return $_ce5pyrkgjfuw8q5v.rowdata(element, cells, parentSection);\n      });\n    };\n\n    var fromPastedRows = function (rows, example) {\n      return $_tyr3yk5jfuw8q47.map(rows, function (row) {\n        var cells = $_tyr3yk5jfuw8q47.map($_aqhz9okhjfuw8q5y.cells(row), function (cell) {\n          var rowspan = $_3q82t2l5jfuw8q93.has(cell, 'rowspan') ? parseInt($_3q82t2l5jfuw8q93.get(cell, 'rowspan'), 10) : 1;\n          var colspan = $_3q82t2l5jfuw8q93.has(cell, 'colspan') ? parseInt($_3q82t2l5jfuw8q93.get(cell, 'colspan'), 10) : 1;\n          return $_ce5pyrkgjfuw8q5v.detail(cell, rowspan, colspan);\n        });\n        return $_ce5pyrkgjfuw8q5v.rowdata(row, cells, example.section());\n      });\n    };\n\n    var $_dy3x0nkfjfuw8q5l = {\n      fromTable: fromTable,\n      fromPastedRows: fromPastedRows\n    };\n\n    var key = function (row, column) {\n      return row + ',' + column;\n    };\n\n    var getAt = function (warehouse, row, column) {\n      var raw = warehouse.access()[key(row, column)];\n      return raw !== undefined ? Option.some(raw) : Option.none();\n    };\n\n    var findItem = function (warehouse, item, comparator) {\n      var filtered = filterItems(warehouse, function (detail) {\n        return comparator(item, detail.element());\n      });\n      return filtered.length > 0 ? Option.some(filtered[0]) : Option.none();\n    };\n\n    var filterItems = function (warehouse, predicate) {\n      var all = $_tyr3yk5jfuw8q47.bind(warehouse.all(), function (r) {\n        return r.cells();\n      });\n      return $_tyr3yk5jfuw8q47.filter(all, predicate);\n    };\n\n    var generate = function (list) {\n      var access = {};\n      var cells = [];\n      var maxRows = list.length;\n      var maxColumns = 0;\n      $_tyr3yk5jfuw8q47.each(list, function (details, r) {\n        var currentRow = [];\n        $_tyr3yk5jfuw8q47.each(details.cells(), function (detail, c) {\n          var start = 0;\n\n          while (access[key(r, start)] !== undefined) {\n            start++;\n          }\n\n          var current = $_ce5pyrkgjfuw8q5v.extended(detail.element(), detail.rowspan(), detail.colspan(), r, start);\n\n          for (var i = 0; i < detail.colspan(); i++) {\n            for (var j = 0; j < detail.rowspan(); j++) {\n              var cr = r + j;\n              var cc = start + i;\n              var newpos = key(cr, cc);\n              access[newpos] = current;\n              maxColumns = Math.max(maxColumns, cc + 1);\n            }\n          }\n\n          currentRow.push(current);\n        });\n        cells.push($_ce5pyrkgjfuw8q5v.rowdata(details.element(), currentRow, details.section()));\n      });\n      var grid = $_ce5pyrkgjfuw8q5v.grid(maxRows, maxColumns);\n      return {\n        grid: $_20nfr6k7jfuw8q4g.constant(grid),\n        access: $_20nfr6k7jfuw8q4g.constant(access),\n        all: $_20nfr6k7jfuw8q4g.constant(cells)\n      };\n    };\n\n    var justCells = function (warehouse) {\n      var rows = $_tyr3yk5jfuw8q47.map(warehouse.all(), function (w) {\n        return w.cells();\n      });\n      return $_tyr3yk5jfuw8q47.flatten(rows);\n    };\n\n    var $_2ge24cldjfuw8qa3 = {\n      generate: generate,\n      getAt: getAt,\n      findItem: findItem,\n      filterItems: filterItems,\n      justCells: justCells\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined;\n    };\n\n    var $_b75qp5lfjfuw8qau = {\n      isSupported: isSupported\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!$_g6mvnrk8jfuw8q4k.isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n\n      if ($_b75qp5lfjfuw8qau.isSupported(dom)) dom.style.setProperty(property, value);\n    };\n\n    var internalRemove = function (dom, property) {\n      if ($_b75qp5lfjfuw8qau.isSupported(dom)) dom.style.removeProperty(property);\n    };\n\n    var set$1 = function (element, property, value) {\n      var dom = element.dom();\n      internalSet(dom, property, value);\n    };\n\n    var setAll$1 = function (element, css) {\n      var dom = element.dom();\n      $_11yiupkajfuw8q5c.each(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n\n    var setOptions = function (element, css) {\n      var dom = element.dom();\n      $_11yiupkajfuw8q5c.each(css, function (v, k) {\n        v.fold(function () {\n          internalRemove(dom, k);\n        }, function (value) {\n          internalSet(dom, k, value);\n        });\n      });\n    };\n\n    var get$1 = function (element, property) {\n      var dom = element.dom();\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      var v = r === '' && !$_atd1tul9jfuw8q9i.inBody(element) ? getUnsafeProperty(dom, property) : r;\n      return v === null ? undefined : v;\n    };\n\n    var getUnsafeProperty = function (dom, property) {\n      return $_b75qp5lfjfuw8qau.isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n\n    var getRaw = function (element, property) {\n      var dom = element.dom();\n      var raw = getUnsafeProperty(dom, property);\n      return Option.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n\n    var getAllRaw = function (element) {\n      var css = {};\n      var dom = element.dom();\n\n      if ($_b75qp5lfjfuw8qau.isSupported(dom)) {\n        for (var i = 0; i < dom.style.length; i++) {\n          var ruleName = dom.style.item(i);\n          css[ruleName] = dom.style[ruleName];\n        }\n      }\n\n      return css;\n    };\n\n    var isValidValue = function (tag, property, value) {\n      var element = $_xbeoqkkjfuw8q73.fromTag(tag);\n      set$1(element, property, value);\n      var style = getRaw(element, property);\n      return style.isSome();\n    };\n\n    var remove$1 = function (element, property) {\n      var dom = element.dom();\n      internalRemove(dom, property);\n\n      if ($_3q82t2l5jfuw8q93.has(element, 'style') && $_ey09l9l2jfuw8q8y.trim($_3q82t2l5jfuw8q93.get(element, 'style')) === '') {\n        $_3q82t2l5jfuw8q93.remove(element, 'style');\n      }\n    };\n\n    var preserve = function (element, f) {\n      var oldStyles = $_3q82t2l5jfuw8q93.get(element, 'style');\n      var result = f(element);\n      var restore = oldStyles === undefined ? $_3q82t2l5jfuw8q93.remove : $_3q82t2l5jfuw8q93.set;\n      restore(element, 'style', oldStyles);\n      return result;\n    };\n\n    var copy = function (source, target) {\n      var sourceDom = source.dom();\n      var targetDom = target.dom();\n\n      if ($_b75qp5lfjfuw8qau.isSupported(sourceDom) && $_b75qp5lfjfuw8qau.isSupported(targetDom)) {\n        targetDom.style.cssText = sourceDom.style.cssText;\n      }\n    };\n\n    var reflow = function (e) {\n      return e.dom().offsetWidth;\n    };\n\n    var transferOne$1 = function (source, destination, style) {\n      getRaw(source, style).each(function (value) {\n        if (getRaw(destination, style).isNone()) set$1(destination, style, value);\n      });\n    };\n\n    var transfer$1 = function (source, destination, styles) {\n      if (!$_a8gk30l6jfuw8q9c.isElement(source) || !$_a8gk30l6jfuw8q9c.isElement(destination)) return;\n      $_tyr3yk5jfuw8q47.each(styles, function (style) {\n        transferOne$1(source, destination, style);\n      });\n    };\n\n    var $_bfod2hlejfuw8qac = {\n      copy: copy,\n      set: set$1,\n      preserve: preserve,\n      setAll: setAll$1,\n      setOptions: setOptions,\n      remove: remove$1,\n      get: get$1,\n      getRaw: getRaw,\n      getAllRaw: getAllRaw,\n      isValidValue: isValidValue,\n      reflow: reflow,\n      transfer: transfer$1\n    };\n\n    var before = function (marker, element) {\n      var parent = $_s8scrkmjfuw8q7a.parent(marker);\n      parent.each(function (v) {\n        v.dom().insertBefore(element.dom(), marker.dom());\n      });\n    };\n\n    var after = function (marker, element) {\n      var sibling = $_s8scrkmjfuw8q7a.nextSibling(marker);\n      sibling.fold(function () {\n        var parent = $_s8scrkmjfuw8q7a.parent(marker);\n        parent.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n\n    var prepend = function (parent, element) {\n      var firstChild = $_s8scrkmjfuw8q7a.firstChild(parent);\n      firstChild.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom().insertBefore(element.dom(), v.dom());\n      });\n    };\n\n    var append = function (parent, element) {\n      parent.dom().appendChild(element.dom());\n    };\n\n    var appendAt = function (parent, element, index) {\n      $_s8scrkmjfuw8q7a.child(parent, index).fold(function () {\n        append(parent, element);\n      }, function (v) {\n        before(v, element);\n      });\n    };\n\n    var wrap = function (element, wrapper) {\n      before(element, wrapper);\n      append(wrapper, element);\n    };\n\n    var $_fatuxylgjfuw8qav = {\n      before: before,\n      after: after,\n      prepend: prepend,\n      append: append,\n      appendAt: appendAt,\n      wrap: wrap\n    };\n\n    var before$1 = function (marker, elements) {\n      $_tyr3yk5jfuw8q47.each(elements, function (x) {\n        $_fatuxylgjfuw8qav.before(marker, x);\n      });\n    };\n\n    var after$1 = function (marker, elements) {\n      $_tyr3yk5jfuw8q47.each(elements, function (x, i) {\n        var e = i === 0 ? marker : elements[i - 1];\n        $_fatuxylgjfuw8qav.after(e, x);\n      });\n    };\n\n    var prepend$1 = function (parent, elements) {\n      $_tyr3yk5jfuw8q47.each(elements.slice().reverse(), function (x) {\n        $_fatuxylgjfuw8qav.prepend(parent, x);\n      });\n    };\n\n    var append$1 = function (parent, elements) {\n      $_tyr3yk5jfuw8q47.each(elements, function (x) {\n        $_fatuxylgjfuw8qav.append(parent, x);\n      });\n    };\n\n    var $_9zaoqflijfuw8qb0 = {\n      before: before$1,\n      after: after$1,\n      prepend: prepend$1,\n      append: append$1\n    };\n\n    var empty = function (element) {\n      element.dom().textContent = '';\n      $_tyr3yk5jfuw8q47.each($_s8scrkmjfuw8q7a.children(element), function (rogue) {\n        remove$2(rogue);\n      });\n    };\n\n    var remove$2 = function (element) {\n      var dom = element.dom();\n      if (dom.parentNode !== null) dom.parentNode.removeChild(dom);\n    };\n\n    var unwrap = function (wrapper) {\n      var children = $_s8scrkmjfuw8q7a.children(wrapper);\n      if (children.length > 0) $_9zaoqflijfuw8qb0.before(wrapper, children);\n      remove$2(wrapper);\n    };\n\n    var $_fl1deelhjfuw8qax = {\n      empty: empty,\n      remove: remove$2,\n      unwrap: unwrap\n    };\n    var stats = $_5now9kbjfuw8q5e.immutable('minRow', 'minCol', 'maxRow', 'maxCol');\n\n    var findSelectedStats = function (house, isSelected) {\n      var totalColumns = house.grid().columns();\n      var totalRows = house.grid().rows();\n      var minRow = totalRows;\n      var minCol = totalColumns;\n      var maxRow = 0;\n      var maxCol = 0;\n      $_11yiupkajfuw8q5c.each(house.access(), function (detail) {\n        if (isSelected(detail)) {\n          var startRow = detail.row();\n          var endRow = startRow + detail.rowspan() - 1;\n          var startCol = detail.column();\n          var endCol = startCol + detail.colspan() - 1;\n          if (startRow < minRow) minRow = startRow;else if (endRow > maxRow) maxRow = endRow;\n          if (startCol < minCol) minCol = startCol;else if (endCol > maxCol) maxCol = endCol;\n        }\n      });\n      return stats(minRow, minCol, maxRow, maxCol);\n    };\n\n    var makeCell = function (list, seenSelected, rowIndex) {\n      var row = list[rowIndex].element();\n      var td = $_xbeoqkkjfuw8q73.fromTag('td');\n      $_fatuxylgjfuw8qav.append(td, $_xbeoqkkjfuw8q73.fromTag('br'));\n      var f = seenSelected ? $_fatuxylgjfuw8qav.append : $_fatuxylgjfuw8qav.prepend;\n      f(row, td);\n    };\n\n    var fillInGaps = function (list, house, stats, isSelected) {\n      var totalColumns = house.grid().columns();\n      var totalRows = house.grid().rows();\n\n      for (var i = 0; i < totalRows; i++) {\n        var seenSelected = false;\n\n        for (var j = 0; j < totalColumns; j++) {\n          if (!(i < stats.minRow() || i > stats.maxRow() || j < stats.minCol() || j > stats.maxCol())) {\n            var needCell = $_2ge24cldjfuw8qa3.getAt(house, i, j).filter(isSelected).isNone();\n            if (needCell) makeCell(list, seenSelected, i);else seenSelected = true;\n          }\n        }\n      }\n    };\n\n    var clean = function (table, stats) {\n      var emptyRows = $_tyr3yk5jfuw8q47.filter($_2g609akijfuw8q6n.firstLayer(table, 'tr'), function (row) {\n        return row.dom().childElementCount === 0;\n      });\n      $_tyr3yk5jfuw8q47.each(emptyRows, $_fl1deelhjfuw8qax.remove);\n\n      if (stats.minCol() === stats.maxCol() || stats.minRow() === stats.maxRow()) {\n        $_tyr3yk5jfuw8q47.each($_2g609akijfuw8q6n.firstLayer(table, 'th,td'), function (cell) {\n          $_3q82t2l5jfuw8q93.remove(cell, 'rowspan');\n          $_3q82t2l5jfuw8q93.remove(cell, 'colspan');\n        });\n      }\n\n      $_3q82t2l5jfuw8q93.remove(table, 'width');\n      $_3q82t2l5jfuw8q93.remove(table, 'height');\n      $_bfod2hlejfuw8qac.remove(table, 'width');\n      $_bfod2hlejfuw8qac.remove(table, 'height');\n    };\n\n    var extract = function (table, selectedSelector) {\n      var isSelected = function (detail) {\n        return $_enn9uikjjfuw8q6w.is(detail.element(), selectedSelector);\n      };\n\n      var list = $_dy3x0nkfjfuw8q5l.fromTable(table);\n      var house = $_2ge24cldjfuw8qa3.generate(list);\n      var stats = findSelectedStats(house, isSelected);\n      var selector = 'th:not(' + selectedSelector + ')' + ',td:not(' + selectedSelector + ')';\n      var unselectedCells = $_2g609akijfuw8q6n.filterFirstLayer(table, 'th,td', function (cell) {\n        return $_enn9uikjjfuw8q6w.is(cell, selector);\n      });\n      $_tyr3yk5jfuw8q47.each(unselectedCells, $_fl1deelhjfuw8qax.remove);\n      fillInGaps(list, house, stats, isSelected);\n      clean(table, stats);\n      return table;\n    };\n\n    var $_bbpooak9jfuw8q4m = {\n      extract: extract\n    };\n\n    var clone$1 = function (original, deep) {\n      return $_xbeoqkkjfuw8q73.fromDom(original.dom().cloneNode(deep));\n    };\n\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n\n    var shallowAs = function (original, tag) {\n      var nu = $_xbeoqkkjfuw8q73.fromTag(tag);\n      var attributes = $_3q82t2l5jfuw8q93.clone(original);\n      $_3q82t2l5jfuw8q93.setAll(nu, attributes);\n      return nu;\n    };\n\n    var copy$1 = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      var cloneChildren = $_s8scrkmjfuw8q7a.children(deep(original));\n      $_9zaoqflijfuw8qb0.append(nu, cloneChildren);\n      return nu;\n    };\n\n    var mutate = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      $_fatuxylgjfuw8qav.before(original, nu);\n      var children = $_s8scrkmjfuw8q7a.children(original);\n      $_9zaoqflijfuw8qb0.append(nu, children);\n      $_fl1deelhjfuw8qax.remove(original);\n      return nu;\n    };\n\n    var $_ddvp06lkjfuw8qbt = {\n      shallow: shallow,\n      shallowAs: shallowAs,\n      deep: deep,\n      copy: copy$1,\n      mutate: mutate\n    };\n\n    function NodeValue(is, name) {\n      var get = function (element) {\n        if (!is(element)) throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        return getOption(element).getOr('');\n      };\n\n      var getOptionIE10 = function (element) {\n        try {\n          return getOptionSafe(element);\n        } catch (e) {\n          return Option.none();\n        }\n      };\n\n      var getOptionSafe = function (element) {\n        return is(element) ? Option.from(element.dom().nodeValue) : Option.none();\n      };\n\n      var browser = $_fqgee0ktjfuw8q83.detect().browser;\n      var getOption = browser.isIE() && browser.version.major === 10 ? getOptionIE10 : getOptionSafe;\n\n      var set = function (element, value) {\n        if (!is(element)) throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        element.dom().nodeValue = value;\n      };\n\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    }\n\n    var api = NodeValue($_a8gk30l6jfuw8q9c.isText, 'text');\n\n    var get$2 = function (element) {\n      return api.get(element);\n    };\n\n    var getOption = function (element) {\n      return api.getOption(element);\n    };\n\n    var set$2 = function (element, value) {\n      api.set(element, value);\n    };\n\n    var $_6j8y7blnjfuw8qc3 = {\n      get: get$2,\n      getOption: getOption,\n      set: set$2\n    };\n\n    var getEnd = function (element) {\n      return $_a8gk30l6jfuw8q9c.name(element) === 'img' ? 1 : $_6j8y7blnjfuw8qc3.getOption(element).fold(function () {\n        return $_s8scrkmjfuw8q7a.children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n\n    var isEnd = function (element, offset) {\n      return getEnd(element) === offset;\n    };\n\n    var isStart = function (element, offset) {\n      return offset === 0;\n    };\n\n    var NBSP = '\\xA0';\n\n    var isTextNodeWithCursorPosition = function (el) {\n      return $_6j8y7blnjfuw8qc3.getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(NBSP) > -1;\n      }).isSome();\n    };\n\n    var elementsWithCursorPosition = ['img', 'br'];\n\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || $_tyr3yk5jfuw8q47.contains(elementsWithCursorPosition, $_a8gk30l6jfuw8q9c.name(elem));\n    };\n\n    var $_6vfowrlmjfuw8qbz = {\n      getEnd: getEnd,\n      isEnd: isEnd,\n      isStart: isStart,\n      isCursorPosition: isCursorPosition\n    };\n\n    var first$3 = function (element) {\n      return $_11ympzlbjfuw8q9n.descendant(element, $_6vfowrlmjfuw8qbz.isCursorPosition);\n    };\n\n    var last$2 = function (element) {\n      return descendantRtl(element, $_6vfowrlmjfuw8qbz.isCursorPosition);\n    };\n\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children = $_s8scrkmjfuw8q7a.children(element);\n\n        for (var i = children.length - 1; i >= 0; i--) {\n          var child = children[i];\n          if (predicate(child)) return Option.some(child);\n          var res = descend(child);\n          if (res.isSome()) return res;\n        }\n\n        return Option.none();\n      };\n\n      return descend(scope);\n    };\n\n    var $_ejrzj4lljfuw8qbw = {\n      first: first$3,\n      last: last$2\n    };\n\n    var cell$1 = function () {\n      var td = $_xbeoqkkjfuw8q73.fromTag('td');\n      $_fatuxylgjfuw8qav.append(td, $_xbeoqkkjfuw8q73.fromTag('br'));\n      return td;\n    };\n\n    var replace = function (cell, tag, attrs) {\n      var replica = $_ddvp06lkjfuw8qbt.copy(cell, tag);\n      $_11yiupkajfuw8q5c.each(attrs, function (v, k) {\n        if (v === null) $_3q82t2l5jfuw8q93.remove(replica, k);else $_3q82t2l5jfuw8q93.set(replica, k, v);\n      });\n      return replica;\n    };\n\n    var pasteReplace = function (cellContent) {\n      return cellContent;\n    };\n\n    var newRow = function (doc) {\n      return function () {\n        return $_xbeoqkkjfuw8q73.fromTag('tr', doc.dom());\n      };\n    };\n\n    var cloneFormats = function (oldCell, newCell, formats) {\n      var first = $_ejrzj4lljfuw8qbw.first(oldCell);\n      return first.map(function (firstText) {\n        var formatSelector = formats.join(',');\n        var parents = $_6c9d0hl7jfuw8q9d.ancestors(firstText, formatSelector, function (element) {\n          return $_e8rn66kojfuw8q7n.eq(element, oldCell);\n        });\n        return $_tyr3yk5jfuw8q47.foldr(parents, function (last, parent) {\n          var clonedFormat = $_ddvp06lkjfuw8qbt.shallow(parent);\n          $_fatuxylgjfuw8qav.append(last, clonedFormat);\n          return clonedFormat;\n        }, newCell);\n      }).getOr(newCell);\n    };\n\n    var cellOperations = function (mutate, doc, formatsToClone) {\n      var newCell = function (prev) {\n        var doc = $_s8scrkmjfuw8q7a.owner(prev.element());\n        var td = $_xbeoqkkjfuw8q73.fromTag($_a8gk30l6jfuw8q9c.name(prev.element()), doc.dom());\n        var formats = formatsToClone.getOr(['strong', 'em', 'b', 'i', 'span', 'font', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div']);\n        var lastNode = formats.length > 0 ? cloneFormats(prev.element(), td, formats) : td;\n        $_fatuxylgjfuw8qav.append(lastNode, $_xbeoqkkjfuw8q73.fromTag('br'));\n        $_bfod2hlejfuw8qac.copy(prev.element(), td);\n        $_bfod2hlejfuw8qac.remove(td, 'height');\n        if (prev.colspan() !== 1) $_bfod2hlejfuw8qac.remove(prev.element(), 'width');\n        mutate(prev.element(), td);\n        return td;\n      };\n\n      return {\n        row: newRow(doc),\n        cell: newCell,\n        replace: replace,\n        gap: cell$1\n      };\n    };\n\n    var paste = function (doc) {\n      return {\n        row: newRow(doc),\n        cell: cell$1,\n        replace: pasteReplace,\n        gap: cell$1\n      };\n    };\n\n    var $_5ohg1eljjfuw8qb4 = {\n      cellOperations: cellOperations,\n      paste: paste\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return $_s8scrkmjfuw8q7a.children($_xbeoqkkjfuw8q73.fromDom(div));\n    };\n\n    var fromTags = function (tags, scope) {\n      return $_tyr3yk5jfuw8q47.map(tags, function (x) {\n        return $_xbeoqkkjfuw8q73.fromTag(x, scope);\n      });\n    };\n\n    var fromText$1 = function (texts, scope) {\n      return $_tyr3yk5jfuw8q47.map(texts, function (x) {\n        return $_xbeoqkkjfuw8q73.fromText(x, scope);\n      });\n    };\n\n    var fromDom$1 = function (nodes) {\n      return $_tyr3yk5jfuw8q47.map(nodes, $_xbeoqkkjfuw8q73.fromDom);\n    };\n\n    var $_du13u9lpjfuw8qce = {\n      fromHtml: fromHtml$1,\n      fromTags: fromTags,\n      fromText: fromText$1,\n      fromDom: fromDom$1\n    };\n    var TagBoundaries = ['body', 'p', 'div', 'article', 'aside', 'figcaption', 'figure', 'footer', 'header', 'nav', 'section', 'ol', 'ul', 'li', 'table', 'thead', 'tbody', 'tfoot', 'caption', 'tr', 'td', 'th', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'address'];\n\n    function DomUniverse() {\n      var clone = function (element) {\n        return $_xbeoqkkjfuw8q73.fromDom(element.dom().cloneNode(false));\n      };\n\n      var isBoundary = function (element) {\n        if (!$_a8gk30l6jfuw8q9c.isElement(element)) return false;\n        if ($_a8gk30l6jfuw8q9c.name(element) === 'body') return true;\n        return $_tyr3yk5jfuw8q47.contains(TagBoundaries, $_a8gk30l6jfuw8q9c.name(element));\n      };\n\n      var isEmptyTag = function (element) {\n        if (!$_a8gk30l6jfuw8q9c.isElement(element)) return false;\n        return $_tyr3yk5jfuw8q47.contains(['br', 'img', 'hr', 'input'], $_a8gk30l6jfuw8q9c.name(element));\n      };\n\n      var comparePosition = function (element, other) {\n        return element.dom().compareDocumentPosition(other.dom());\n      };\n\n      var copyAttributesTo = function (source, destination) {\n        var as = $_3q82t2l5jfuw8q93.clone(source);\n        $_3q82t2l5jfuw8q93.setAll(destination, as);\n      };\n\n      return {\n        up: $_20nfr6k7jfuw8q4g.constant({\n          selector: $_8wdrbmlajfuw8q9m.ancestor,\n          closest: $_8wdrbmlajfuw8q9m.closest,\n          predicate: $_11ympzlbjfuw8q9n.ancestor,\n          all: $_s8scrkmjfuw8q7a.parents\n        }),\n        down: $_20nfr6k7jfuw8q4g.constant({\n          selector: $_6c9d0hl7jfuw8q9d.descendants,\n          predicate: $_4d3nfbl8jfuw8q9f.descendants\n        }),\n        styles: $_20nfr6k7jfuw8q4g.constant({\n          get: $_bfod2hlejfuw8qac.get,\n          getRaw: $_bfod2hlejfuw8qac.getRaw,\n          set: $_bfod2hlejfuw8qac.set,\n          remove: $_bfod2hlejfuw8qac.remove\n        }),\n        attrs: $_20nfr6k7jfuw8q4g.constant({\n          get: $_3q82t2l5jfuw8q93.get,\n          set: $_3q82t2l5jfuw8q93.set,\n          remove: $_3q82t2l5jfuw8q93.remove,\n          copyTo: copyAttributesTo\n        }),\n        insert: $_20nfr6k7jfuw8q4g.constant({\n          before: $_fatuxylgjfuw8qav.before,\n          after: $_fatuxylgjfuw8qav.after,\n          afterAll: $_9zaoqflijfuw8qb0.after,\n          append: $_fatuxylgjfuw8qav.append,\n          appendAll: $_9zaoqflijfuw8qb0.append,\n          prepend: $_fatuxylgjfuw8qav.prepend,\n          wrap: $_fatuxylgjfuw8qav.wrap\n        }),\n        remove: $_20nfr6k7jfuw8q4g.constant({\n          unwrap: $_fl1deelhjfuw8qax.unwrap,\n          remove: $_fl1deelhjfuw8qax.remove\n        }),\n        create: $_20nfr6k7jfuw8q4g.constant({\n          nu: $_xbeoqkkjfuw8q73.fromTag,\n          clone: clone,\n          text: $_xbeoqkkjfuw8q73.fromText\n        }),\n        query: $_20nfr6k7jfuw8q4g.constant({\n          comparePosition: comparePosition,\n          prevSibling: $_s8scrkmjfuw8q7a.prevSibling,\n          nextSibling: $_s8scrkmjfuw8q7a.nextSibling\n        }),\n        property: $_20nfr6k7jfuw8q4g.constant({\n          children: $_s8scrkmjfuw8q7a.children,\n          name: $_a8gk30l6jfuw8q9c.name,\n          parent: $_s8scrkmjfuw8q7a.parent,\n          isText: $_a8gk30l6jfuw8q9c.isText,\n          isComment: $_a8gk30l6jfuw8q9c.isComment,\n          isElement: $_a8gk30l6jfuw8q9c.isElement,\n          getText: $_6j8y7blnjfuw8qc3.get,\n          setText: $_6j8y7blnjfuw8qc3.set,\n          isBoundary: isBoundary,\n          isEmptyTag: isEmptyTag\n        }),\n        eq: $_e8rn66kojfuw8q7n.eq,\n        is: $_e8rn66kojfuw8q7n.is\n      };\n    }\n\n    var leftRight = $_5now9kbjfuw8q5e.immutable('left', 'right');\n\n    var bisect = function (universe, parent, child) {\n      var children = universe.property().children(parent);\n      var index = $_tyr3yk5jfuw8q47.findIndex(children, $_20nfr6k7jfuw8q4g.curry(universe.eq, child));\n      return index.map(function (ind) {\n        return {\n          before: $_20nfr6k7jfuw8q4g.constant(children.slice(0, ind)),\n          after: $_20nfr6k7jfuw8q4g.constant(children.slice(ind + 1))\n        };\n      });\n    };\n\n    var breakToRight = function (universe, parent, child) {\n      return bisect(universe, parent, child).map(function (parts) {\n        var second = universe.create().clone(parent);\n        universe.insert().appendAll(second, parts.after());\n        universe.insert().after(parent, second);\n        return leftRight(parent, second);\n      });\n    };\n\n    var breakToLeft = function (universe, parent, child) {\n      return bisect(universe, parent, child).map(function (parts) {\n        var prior = universe.create().clone(parent);\n        universe.insert().appendAll(prior, parts.before().concat([child]));\n        universe.insert().appendAll(parent, parts.after());\n        universe.insert().before(parent, prior);\n        return leftRight(prior, parent);\n      });\n    };\n\n    var breakPath = function (universe, item, isTop, breaker) {\n      var result = $_5now9kbjfuw8q5e.immutable('first', 'second', 'splits');\n\n      var next = function (child, group, splits) {\n        var fallback = result(child, Option.none(), splits);\n        if (isTop(child)) return result(child, group, splits);else {\n          return universe.property().parent(child).bind(function (parent) {\n            return breaker(universe, parent, child).map(function (breakage) {\n              var extra = [{\n                first: breakage.left,\n                second: breakage.right\n              }];\n              var nextChild = isTop(parent) ? parent : breakage.left();\n              return next(nextChild, Option.some(breakage.right()), splits.concat(extra));\n            }).getOr(fallback);\n          });\n        }\n      };\n\n      return next(item, Option.none(), []);\n    };\n\n    var $_fx4c5ilyjfuw8qf8 = {\n      breakToLeft: breakToLeft,\n      breakToRight: breakToRight,\n      breakPath: breakPath\n    };\n\n    var all$3 = function (universe, look, elements, f) {\n      var head = elements[0];\n      var tail = elements.slice(1);\n      return f(universe, look, head, tail);\n    };\n\n    var oneAll = function (universe, look, elements) {\n      return elements.length > 0 ? all$3(universe, look, elements, unsafeOne) : Option.none();\n    };\n\n    var unsafeOne = function (universe, look, head, tail) {\n      var start = look(universe, head);\n      return $_tyr3yk5jfuw8q47.foldr(tail, function (b, a) {\n        var current = look(universe, a);\n        return commonElement(universe, b, current);\n      }, start);\n    };\n\n    var commonElement = function (universe, start, end) {\n      return start.bind(function (s) {\n        return end.filter($_20nfr6k7jfuw8q4g.curry(universe.eq, s));\n      });\n    };\n\n    var $_40yiy6lzjfuw8qfi = {\n      oneAll: oneAll\n    };\n\n    var eq$1 = function (universe, item) {\n      return $_20nfr6k7jfuw8q4g.curry(universe.eq, item);\n    };\n\n    var unsafeSubset = function (universe, common, ps1, ps2) {\n      var children = universe.property().children(common);\n      if (universe.eq(common, ps1[0])) return Option.some([ps1[0]]);\n      if (universe.eq(common, ps2[0])) return Option.some([ps2[0]]);\n\n      var finder = function (ps) {\n        var topDown = $_tyr3yk5jfuw8q47.reverse(ps);\n        var index = $_tyr3yk5jfuw8q47.findIndex(topDown, eq$1(universe, common)).getOr(-1);\n        var item = index < topDown.length - 1 ? topDown[index + 1] : topDown[index];\n        return $_tyr3yk5jfuw8q47.findIndex(children, eq$1(universe, item));\n      };\n\n      var startIndex = finder(ps1);\n      var endIndex = finder(ps2);\n      return startIndex.bind(function (sIndex) {\n        return endIndex.map(function (eIndex) {\n          var first = Math.min(sIndex, eIndex);\n          var last = Math.max(sIndex, eIndex);\n          return children.slice(first, last + 1);\n        });\n      });\n    };\n\n    var ancestors$2 = function (universe, start, end, _isRoot) {\n      var isRoot = _isRoot !== undefined ? _isRoot : $_20nfr6k7jfuw8q4g.constant(false);\n      var ps1 = [start].concat(universe.up().all(start));\n      var ps2 = [end].concat(universe.up().all(end));\n\n      var prune = function (path) {\n        var index = $_tyr3yk5jfuw8q47.findIndex(path, isRoot);\n        return index.fold(function () {\n          return path;\n        }, function (ind) {\n          return path.slice(0, ind + 1);\n        });\n      };\n\n      var pruned1 = prune(ps1);\n      var pruned2 = prune(ps2);\n      var shared = $_tyr3yk5jfuw8q47.find(pruned1, function (x) {\n        return $_tyr3yk5jfuw8q47.exists(pruned2, eq$1(universe, x));\n      });\n      return {\n        firstpath: $_20nfr6k7jfuw8q4g.constant(pruned1),\n        secondpath: $_20nfr6k7jfuw8q4g.constant(pruned2),\n        shared: $_20nfr6k7jfuw8q4g.constant(shared)\n      };\n    };\n\n    var subset = function (universe, start, end) {\n      var ancs = ancestors$2(universe, start, end);\n      return ancs.shared().bind(function (shared) {\n        return unsafeSubset(universe, shared, ancs.firstpath(), ancs.secondpath());\n      });\n    };\n\n    var $_7m4t8jm0jfuw8qfq = {\n      subset: subset,\n      ancestors: ancestors$2\n    };\n\n    var sharedOne = function (universe, look, elements) {\n      return $_40yiy6lzjfuw8qfi.oneAll(universe, look, elements);\n    };\n\n    var subset$1 = function (universe, start, finish) {\n      return $_7m4t8jm0jfuw8qfq.subset(universe, start, finish);\n    };\n\n    var ancestors$3 = function (universe, start, finish, _isRoot) {\n      return $_7m4t8jm0jfuw8qfq.ancestors(universe, start, finish, _isRoot);\n    };\n\n    var breakToLeft$1 = function (universe, parent, child) {\n      return $_fx4c5ilyjfuw8qf8.breakToLeft(universe, parent, child);\n    };\n\n    var breakToRight$1 = function (universe, parent, child) {\n      return $_fx4c5ilyjfuw8qf8.breakToRight(universe, parent, child);\n    };\n\n    var breakPath$1 = function (universe, child, isTop, breaker) {\n      return $_fx4c5ilyjfuw8qf8.breakPath(universe, child, isTop, breaker);\n    };\n\n    var $_23lsh2lxjfuw8qf5 = {\n      sharedOne: sharedOne,\n      subset: subset$1,\n      ancestors: ancestors$3,\n      breakToLeft: breakToLeft$1,\n      breakToRight: breakToRight$1,\n      breakPath: breakPath$1\n    };\n    var universe = DomUniverse();\n\n    var sharedOne$1 = function (look, elements) {\n      return $_23lsh2lxjfuw8qf5.sharedOne(universe, function (universe, element) {\n        return look(element);\n      }, elements);\n    };\n\n    var subset$2 = function (start, finish) {\n      return $_23lsh2lxjfuw8qf5.subset(universe, start, finish);\n    };\n\n    var ancestors$4 = function (start, finish, _isRoot) {\n      return $_23lsh2lxjfuw8qf5.ancestors(universe, start, finish, _isRoot);\n    };\n\n    var breakToLeft$2 = function (parent, child) {\n      return $_23lsh2lxjfuw8qf5.breakToLeft(universe, parent, child);\n    };\n\n    var breakToRight$2 = function (parent, child) {\n      return $_23lsh2lxjfuw8qf5.breakToRight(universe, parent, child);\n    };\n\n    var breakPath$2 = function (child, isTop, breaker) {\n      return $_23lsh2lxjfuw8qf5.breakPath(universe, child, isTop, function (u, p, c) {\n        return breaker(p, c);\n      });\n    };\n\n    var $_583a2nlujfuw8qdw = {\n      sharedOne: sharedOne$1,\n      subset: subset$2,\n      ancestors: ancestors$4,\n      breakToLeft: breakToLeft$2,\n      breakToRight: breakToRight$2,\n      breakPath: breakPath$2\n    };\n\n    var inSelection = function (bounds, detail) {\n      var leftEdge = detail.column();\n      var rightEdge = detail.column() + detail.colspan() - 1;\n      var topEdge = detail.row();\n      var bottomEdge = detail.row() + detail.rowspan() - 1;\n      return leftEdge <= bounds.finishCol() && rightEdge >= bounds.startCol() && topEdge <= bounds.finishRow() && bottomEdge >= bounds.startRow();\n    };\n\n    var isWithin = function (bounds, detail) {\n      return detail.column() >= bounds.startCol() && detail.column() + detail.colspan() - 1 <= bounds.finishCol() && detail.row() >= bounds.startRow() && detail.row() + detail.rowspan() - 1 <= bounds.finishRow();\n    };\n\n    var isRectangular = function (warehouse, bounds) {\n      var isRect = true;\n      var detailIsWithin = $_20nfr6k7jfuw8q4g.curry(isWithin, bounds);\n\n      for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n        for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n          isRect = isRect && $_2ge24cldjfuw8qa3.getAt(warehouse, i, j).exists(detailIsWithin);\n        }\n      }\n\n      return isRect ? Option.some(bounds) : Option.none();\n    };\n\n    var $_6nqrbhm3jfuw8qgd = {\n      inSelection: inSelection,\n      isWithin: isWithin,\n      isRectangular: isRectangular\n    };\n\n    var getBounds = function (detailA, detailB) {\n      return $_ce5pyrkgjfuw8q5v.bounds(Math.min(detailA.row(), detailB.row()), Math.min(detailA.column(), detailB.column()), Math.max(detailA.row() + detailA.rowspan() - 1, detailB.row() + detailB.rowspan() - 1), Math.max(detailA.column() + detailA.colspan() - 1, detailB.column() + detailB.colspan() - 1));\n    };\n\n    var getAnyBox = function (warehouse, startCell, finishCell) {\n      var startCoords = $_2ge24cldjfuw8qa3.findItem(warehouse, startCell, $_e8rn66kojfuw8q7n.eq);\n      var finishCoords = $_2ge24cldjfuw8qa3.findItem(warehouse, finishCell, $_e8rn66kojfuw8q7n.eq);\n      return startCoords.bind(function (sc) {\n        return finishCoords.map(function (fc) {\n          return getBounds(sc, fc);\n        });\n      });\n    };\n\n    var getBox = function (warehouse, startCell, finishCell) {\n      return getAnyBox(warehouse, startCell, finishCell).bind(function (bounds) {\n        return $_6nqrbhm3jfuw8qgd.isRectangular(warehouse, bounds);\n      });\n    };\n\n    var $_ceqdh6m4jfuw8qgj = {\n      getAnyBox: getAnyBox,\n      getBox: getBox\n    };\n\n    var moveBy = function (warehouse, cell, row, column) {\n      return $_2ge24cldjfuw8qa3.findItem(warehouse, cell, $_e8rn66kojfuw8q7n.eq).bind(function (detail) {\n        var startRow = row > 0 ? detail.row() + detail.rowspan() - 1 : detail.row();\n        var startCol = column > 0 ? detail.column() + detail.colspan() - 1 : detail.column();\n        var dest = $_2ge24cldjfuw8qa3.getAt(warehouse, startRow + row, startCol + column);\n        return dest.map(function (d) {\n          return d.element();\n        });\n      });\n    };\n\n    var intercepts = function (warehouse, start, finish) {\n      return $_ceqdh6m4jfuw8qgj.getAnyBox(warehouse, start, finish).map(function (bounds) {\n        var inside = $_2ge24cldjfuw8qa3.filterItems(warehouse, $_20nfr6k7jfuw8q4g.curry($_6nqrbhm3jfuw8qgd.inSelection, bounds));\n        return $_tyr3yk5jfuw8q47.map(inside, function (detail) {\n          return detail.element();\n        });\n      });\n    };\n\n    var parentCell = function (warehouse, innerCell) {\n      var isContainedBy = function (c1, c2) {\n        return $_e8rn66kojfuw8q7n.contains(c2, c1);\n      };\n\n      return $_2ge24cldjfuw8qa3.findItem(warehouse, innerCell, isContainedBy).bind(function (detail) {\n        return detail.element();\n      });\n    };\n\n    var $_fej9f9m2jfuw8qg6 = {\n      moveBy: moveBy,\n      intercepts: intercepts,\n      parentCell: parentCell\n    };\n\n    var moveBy$1 = function (cell, deltaRow, deltaColumn) {\n      return $_aqhz9okhjfuw8q5y.table(cell).bind(function (table) {\n        var warehouse = getWarehouse(table);\n        return $_fej9f9m2jfuw8qg6.moveBy(warehouse, cell, deltaRow, deltaColumn);\n      });\n    };\n\n    var intercepts$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return $_fej9f9m2jfuw8qg6.intercepts(warehouse, first, last);\n    };\n\n    var nestedIntercepts = function (table, first, firstTable, last, lastTable) {\n      var warehouse = getWarehouse(table);\n      var startCell = $_e8rn66kojfuw8q7n.eq(table, firstTable) ? first : $_fej9f9m2jfuw8qg6.parentCell(warehouse, first);\n      var lastCell = $_e8rn66kojfuw8q7n.eq(table, lastTable) ? last : $_fej9f9m2jfuw8qg6.parentCell(warehouse, last);\n      return $_fej9f9m2jfuw8qg6.intercepts(warehouse, startCell, lastCell);\n    };\n\n    var getBox$1 = function (table, first, last) {\n      var warehouse = getWarehouse(table);\n      return $_ceqdh6m4jfuw8qgj.getBox(warehouse, first, last);\n    };\n\n    var getWarehouse = function (table) {\n      var list = $_dy3x0nkfjfuw8q5l.fromTable(table);\n      return $_2ge24cldjfuw8qa3.generate(list);\n    };\n\n    var $_53tlnwm1jfuw8qg2 = {\n      moveBy: moveBy$1,\n      intercepts: intercepts$1,\n      nestedIntercepts: nestedIntercepts,\n      getBox: getBox$1\n    };\n\n    var lookupTable = function (container, isRoot) {\n      return $_8wdrbmlajfuw8q9m.ancestor(container, 'table');\n    };\n\n    var identified = $_5now9kbjfuw8q5e.immutableBag(['boxes', 'start', 'finish'], []);\n\n    var identify = function (start, finish, isRoot) {\n      var getIsRoot = function (rootTable) {\n        return function (element) {\n          return isRoot(element) || $_e8rn66kojfuw8q7n.eq(element, rootTable);\n        };\n      };\n\n      if ($_e8rn66kojfuw8q7n.eq(start, finish)) {\n        return Option.some(identified({\n          boxes: Option.some([start]),\n          start: start,\n          finish: finish\n        }));\n      } else {\n        return lookupTable(start, isRoot).bind(function (startTable) {\n          return lookupTable(finish, isRoot).bind(function (finishTable) {\n            if ($_e8rn66kojfuw8q7n.eq(startTable, finishTable)) {\n              return Option.some(identified({\n                boxes: $_53tlnwm1jfuw8qg2.intercepts(startTable, start, finish),\n                start: start,\n                finish: finish\n              }));\n            } else if ($_e8rn66kojfuw8q7n.contains(startTable, finishTable)) {\n              var ancestorCells = $_6c9d0hl7jfuw8q9d.ancestors(finish, 'td,th', getIsRoot(startTable));\n              var finishCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : finish;\n              return Option.some(identified({\n                boxes: $_53tlnwm1jfuw8qg2.nestedIntercepts(startTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: finishCell\n              }));\n            } else if ($_e8rn66kojfuw8q7n.contains(finishTable, startTable)) {\n              var ancestorCells = $_6c9d0hl7jfuw8q9d.ancestors(start, 'td,th', getIsRoot(finishTable));\n              var startCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : start;\n              return Option.some(identified({\n                boxes: $_53tlnwm1jfuw8qg2.nestedIntercepts(finishTable, start, startTable, finish, finishTable),\n                start: start,\n                finish: startCell\n              }));\n            } else {\n              return $_583a2nlujfuw8qdw.ancestors(start, finish).shared().bind(function (lca) {\n                return $_8wdrbmlajfuw8q9m.closest(lca, 'table', isRoot).bind(function (lcaTable) {\n                  var finishAncestorCells = $_6c9d0hl7jfuw8q9d.ancestors(finish, 'td,th', getIsRoot(lcaTable));\n                  var finishCell = finishAncestorCells.length > 0 ? finishAncestorCells[finishAncestorCells.length - 1] : finish;\n                  var startAncestorCells = $_6c9d0hl7jfuw8q9d.ancestors(start, 'td,th', getIsRoot(lcaTable));\n                  var startCell = startAncestorCells.length > 0 ? startAncestorCells[startAncestorCells.length - 1] : start;\n                  return Option.some(identified({\n                    boxes: $_53tlnwm1jfuw8qg2.nestedIntercepts(lcaTable, start, startTable, finish, finishTable),\n                    start: startCell,\n                    finish: finishCell\n                  }));\n                });\n              });\n            }\n          });\n        });\n      }\n    };\n\n    var retrieve = function (container, selector) {\n      var sels = $_6c9d0hl7jfuw8q9d.descendants(container, selector);\n      return sels.length > 0 ? Option.some(sels) : Option.none();\n    };\n\n    var getLast = function (boxes, lastSelectedSelector) {\n      return $_tyr3yk5jfuw8q47.find(boxes, function (box) {\n        return $_enn9uikjjfuw8q6w.is(box, lastSelectedSelector);\n      });\n    };\n\n    var getEdges = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return $_8wdrbmlajfuw8q9m.descendant(container, firstSelectedSelector).bind(function (first) {\n        return $_8wdrbmlajfuw8q9m.descendant(container, lastSelectedSelector).bind(function (last) {\n          return $_583a2nlujfuw8qdw.sharedOne(lookupTable, [first, last]).map(function (tbl) {\n            return {\n              first: $_20nfr6k7jfuw8q4g.constant(first),\n              last: $_20nfr6k7jfuw8q4g.constant(last),\n              table: $_20nfr6k7jfuw8q4g.constant(tbl)\n            };\n          });\n        });\n      });\n    };\n\n    var expandTo = function (finish, firstSelectedSelector) {\n      return $_8wdrbmlajfuw8q9m.ancestor(finish, 'table').bind(function (table) {\n        return $_8wdrbmlajfuw8q9m.descendant(table, firstSelectedSelector).bind(function (start) {\n          return identify(start, finish).bind(function (identified) {\n            return identified.boxes().map(function (boxes) {\n              return {\n                boxes: $_20nfr6k7jfuw8q4g.constant(boxes),\n                start: $_20nfr6k7jfuw8q4g.constant(identified.start()),\n                finish: $_20nfr6k7jfuw8q4g.constant(identified.finish())\n              };\n            });\n          });\n        });\n      });\n    };\n\n    var shiftSelection = function (boxes, deltaRow, deltaColumn, firstSelectedSelector, lastSelectedSelector) {\n      return getLast(boxes, lastSelectedSelector).bind(function (last) {\n        return $_53tlnwm1jfuw8qg2.moveBy(last, deltaRow, deltaColumn).bind(function (finish) {\n          return expandTo(finish, firstSelectedSelector);\n        });\n      });\n    };\n\n    var $_dpd405ltjfuw8qd8 = {\n      identify: identify,\n      retrieve: retrieve,\n      shiftSelection: shiftSelection,\n      getEdges: getEdges\n    };\n\n    var retrieve$1 = function (container, selector) {\n      return $_dpd405ltjfuw8qd8.retrieve(container, selector);\n    };\n\n    var retrieveBox = function (container, firstSelectedSelector, lastSelectedSelector) {\n      return $_dpd405ltjfuw8qd8.getEdges(container, firstSelectedSelector, lastSelectedSelector).bind(function (edges) {\n        var isRoot = function (ancestor) {\n          return $_e8rn66kojfuw8q7n.eq(container, ancestor);\n        };\n\n        var firstAncestor = $_8wdrbmlajfuw8q9m.ancestor(edges.first(), 'thead,tfoot,tbody,table', isRoot);\n        var lastAncestor = $_8wdrbmlajfuw8q9m.ancestor(edges.last(), 'thead,tfoot,tbody,table', isRoot);\n        return firstAncestor.bind(function (fA) {\n          return lastAncestor.bind(function (lA) {\n            return $_e8rn66kojfuw8q7n.eq(fA, lA) ? $_53tlnwm1jfuw8qg2.getBox(edges.table(), edges.first(), edges.last()) : Option.none();\n          });\n        });\n      });\n    };\n\n    var $_1mynollsjfuw8qcy = {\n      retrieve: retrieve$1,\n      retrieveBox: retrieveBox\n    };\n    var selected = 'data-mce-selected';\n    var selectedSelector = 'td[' + selected + '],th[' + selected + ']';\n    var attributeSelector = '[' + selected + ']';\n    var firstSelected = 'data-mce-first-selected';\n    var firstSelectedSelector = 'td[' + firstSelected + '],th[' + firstSelected + ']';\n    var lastSelected = 'data-mce-last-selected';\n    var lastSelectedSelector = 'td[' + lastSelected + '],th[' + lastSelected + ']';\n    var $_f8tr2nm5jfuw8qgp = {\n      selected: $_20nfr6k7jfuw8q4g.constant(selected),\n      selectedSelector: $_20nfr6k7jfuw8q4g.constant(selectedSelector),\n      attributeSelector: $_20nfr6k7jfuw8q4g.constant(attributeSelector),\n      firstSelected: $_20nfr6k7jfuw8q4g.constant(firstSelected),\n      firstSelectedSelector: $_20nfr6k7jfuw8q4g.constant(firstSelectedSelector),\n      lastSelected: $_20nfr6k7jfuw8q4g.constant(lastSelected),\n      lastSelectedSelector: $_20nfr6k7jfuw8q4g.constant(lastSelectedSelector)\n    };\n\n    var generate$1 = function (cases) {\n      if (!$_g6mvnrk8jfuw8q4k.isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n\n      var constructors = [];\n      var adt = {};\n      $_tyr3yk5jfuw8q47.each(cases, function (acase, count) {\n        var keys = $_11yiupkajfuw8q5c.keys(acase);\n\n        if (keys.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n\n        var key = keys[0];\n        var value = acase[key];\n\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!$_g6mvnrk8jfuw8q4k.isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n\n        constructors.push(key);\n\n        adt[key] = function () {\n          var argLength = arguments.length;\n\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n\n          var args = new Array(argLength);\n\n          for (var i = 0; i < args.length; i++) args[i] = arguments[i];\n\n          var match = function (branches) {\n            var branchKeys = $_11yiupkajfuw8q5c.keys(branches);\n\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n\n            var allReqd = $_tyr3yk5jfuw8q47.forall(constructors, function (reqKey) {\n              return $_tyr3yk5jfuw8q47.contains(branchKeys, reqKey);\n            });\n            if (!allReqd) throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            return branches[key].apply(null, args);\n          };\n\n          return {\n            fold: function () {\n              if (arguments.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n              }\n\n              var target = arguments[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n\n    var $_7sbzam7jfuw8qgu = {\n      generate: generate$1\n    };\n    var type$1 = $_7sbzam7jfuw8qgu.generate([{\n      none: []\n    }, {\n      multiple: ['elements']\n    }, {\n      single: ['selection']\n    }]);\n\n    var cata = function (subject, onNone, onMultiple, onSingle) {\n      return subject.fold(onNone, onMultiple, onSingle);\n    };\n\n    var $_cx0pwam6jfuw8qgr = {\n      cata: cata,\n      none: type$1.none,\n      multiple: type$1.multiple,\n      single: type$1.single\n    };\n\n    var selection = function (cell, selections) {\n      return $_cx0pwam6jfuw8qgr.cata(selections.get(), $_20nfr6k7jfuw8q4g.constant([]), $_20nfr6k7jfuw8q4g.identity, $_20nfr6k7jfuw8q4g.constant([cell]));\n    };\n\n    var unmergable = function (cell, selections) {\n      var hasSpan = function (elem) {\n        return $_3q82t2l5jfuw8q93.has(elem, 'rowspan') && parseInt($_3q82t2l5jfuw8q93.get(elem, 'rowspan'), 10) > 1 || $_3q82t2l5jfuw8q93.has(elem, 'colspan') && parseInt($_3q82t2l5jfuw8q93.get(elem, 'colspan'), 10) > 1;\n      };\n\n      var candidates = selection(cell, selections);\n      return candidates.length > 0 && $_tyr3yk5jfuw8q47.forall(candidates, hasSpan) ? Option.some(candidates) : Option.none();\n    };\n\n    var mergable = function (table, selections) {\n      return $_cx0pwam6jfuw8qgr.cata(selections.get(), Option.none, function (cells, _env) {\n        if (cells.length === 0) {\n          return Option.none();\n        }\n\n        return $_1mynollsjfuw8qcy.retrieveBox(table, $_f8tr2nm5jfuw8qgp.firstSelectedSelector(), $_f8tr2nm5jfuw8qgp.lastSelectedSelector()).bind(function (bounds) {\n          return cells.length > 1 ? Option.some({\n            bounds: $_20nfr6k7jfuw8q4g.constant(bounds),\n            cells: $_20nfr6k7jfuw8q4g.constant(cells)\n          }) : Option.none();\n        });\n      }, Option.none);\n    };\n\n    var $_3xucu8lrjfuw8qco = {\n      mergable: mergable,\n      unmergable: unmergable,\n      selection: selection\n    };\n\n    var noMenu = function (cell) {\n      return {\n        element: $_20nfr6k7jfuw8q4g.constant(cell),\n        mergable: Option.none,\n        unmergable: Option.none,\n        selection: $_20nfr6k7jfuw8q4g.constant([cell])\n      };\n    };\n\n    var forMenu = function (selections, table, cell) {\n      return {\n        element: $_20nfr6k7jfuw8q4g.constant(cell),\n        mergable: $_20nfr6k7jfuw8q4g.constant($_3xucu8lrjfuw8qco.mergable(table, selections)),\n        unmergable: $_20nfr6k7jfuw8q4g.constant($_3xucu8lrjfuw8qco.unmergable(cell, selections)),\n        selection: $_20nfr6k7jfuw8q4g.constant($_3xucu8lrjfuw8qco.selection(cell, selections))\n      };\n    };\n\n    var notCell$1 = function (element) {\n      return noMenu(element);\n    };\n\n    var paste$1 = $_5now9kbjfuw8q5e.immutable('element', 'clipboard', 'generators');\n\n    var pasteRows = function (selections, table, cell, clipboard, generators) {\n      return {\n        element: $_20nfr6k7jfuw8q4g.constant(cell),\n        mergable: Option.none,\n        unmergable: Option.none,\n        selection: $_20nfr6k7jfuw8q4g.constant($_3xucu8lrjfuw8qco.selection(cell, selections)),\n        clipboard: $_20nfr6k7jfuw8q4g.constant(clipboard),\n        generators: $_20nfr6k7jfuw8q4g.constant(generators)\n      };\n    };\n\n    var $_5b7h1hlqjfuw8qci = {\n      noMenu: noMenu,\n      forMenu: forMenu,\n      notCell: notCell$1,\n      paste: paste$1,\n      pasteRows: pasteRows\n    };\n\n    var extractSelected = function (cells) {\n      return $_aqhz9okhjfuw8q5y.table(cells[0]).map($_ddvp06lkjfuw8qbt.deep).map(function (replica) {\n        return [$_bbpooak9jfuw8q4m.extract(replica, $_f8tr2nm5jfuw8qgp.attributeSelector())];\n      });\n    };\n\n    var serializeElement = function (editor, elm) {\n      return editor.selection.serializer.serialize(elm.dom(), {});\n    };\n\n    var registerEvents = function (editor, selections, actions, cellSelection) {\n      editor.on('BeforeGetContent', function (e) {\n        var multiCellContext = function (cells) {\n          e.preventDefault();\n          extractSelected(cells).each(function (elements) {\n            e.content = $_tyr3yk5jfuw8q47.map(elements, function (elm) {\n              return serializeElement(editor, elm);\n            }).join('');\n          });\n        };\n\n        if (e.selection === true) {\n          $_cx0pwam6jfuw8qgr.cata(selections.get(), $_20nfr6k7jfuw8q4g.noop, multiCellContext, $_20nfr6k7jfuw8q4g.noop);\n        }\n      });\n      editor.on('BeforeSetContent', function (e) {\n        if (e.selection === true && e.paste === true) {\n          var cellOpt = Option.from(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n          cellOpt.each(function (domCell) {\n            var cell = $_xbeoqkkjfuw8q73.fromDom(domCell);\n            var table = $_aqhz9okhjfuw8q5y.table(cell);\n            table.bind(function (table) {\n              var elements = $_tyr3yk5jfuw8q47.filter($_du13u9lpjfuw8qce.fromHtml(e.content), function (content) {\n                return $_a8gk30l6jfuw8q9c.name(content) !== 'meta';\n              });\n\n              if (elements.length === 1 && $_a8gk30l6jfuw8q9c.name(elements[0]) === 'table') {\n                e.preventDefault();\n                var doc = $_xbeoqkkjfuw8q73.fromDom(editor.getDoc());\n                var generators = $_5ohg1eljjfuw8qb4.paste(doc);\n                var targets = $_5b7h1hlqjfuw8qci.paste(cell, elements[0], generators);\n                actions.pasteCells(table, targets).each(function (rng) {\n                  editor.selection.setRng(rng);\n                  editor.focus();\n                  cellSelection.clear(table);\n                });\n              }\n            });\n          });\n        }\n      });\n    };\n\n    var $_3y1hv8k4jfuw8q3l = {\n      registerEvents: registerEvents\n    };\n\n    function Dimension(name, getOffset) {\n      var set = function (element, h) {\n        if (!$_g6mvnrk8jfuw8q4k.isNumber(h) && !h.match(/^[0-9]+$/)) throw name + '.set accepts only positive integer values. Value was ' + h;\n        var dom = element.dom();\n        if ($_b75qp5lfjfuw8qau.isSupported(dom)) dom.style[name] = h + 'px';\n      };\n\n      var get = function (element) {\n        var r = getOffset(element);\n\n        if (r <= 0 || r === null) {\n          var css = $_bfod2hlejfuw8qac.get(element, name);\n          return parseFloat(css) || 0;\n        }\n\n        return r;\n      };\n\n      var getOuter = get;\n\n      var aggregate = function (element, properties) {\n        return $_tyr3yk5jfuw8q47.foldl(properties, function (acc, property) {\n          var val = $_bfod2hlejfuw8qac.get(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    }\n\n    var api$1 = Dimension('height', function (element) {\n      return $_atd1tul9jfuw8q9i.inBody(element) ? element.dom().getBoundingClientRect().height : element.dom().offsetHeight;\n    });\n\n    var set$3 = function (element, h) {\n      api$1.set(element, h);\n    };\n\n    var get$3 = function (element) {\n      return api$1.get(element);\n    };\n\n    var getOuter = function (element) {\n      return api$1.getOuter(element);\n    };\n\n    var setMax = function (element, value) {\n      var inclusions = ['margin-top', 'border-top-width', 'padding-top', 'padding-bottom', 'border-bottom-width', 'margin-bottom'];\n      var absMax = api$1.max(element, value, inclusions);\n      $_bfod2hlejfuw8qac.set(element, 'max-height', absMax + 'px');\n    };\n\n    var $_cymdhgmcjfuw8qif = {\n      set: set$3,\n      get: get$3,\n      getOuter: getOuter,\n      setMax: setMax\n    };\n    var api$2 = Dimension('width', function (element) {\n      return element.dom().offsetWidth;\n    });\n\n    var set$4 = function (element, h) {\n      api$2.set(element, h);\n    };\n\n    var get$4 = function (element) {\n      return api$2.get(element);\n    };\n\n    var getOuter$1 = function (element) {\n      return api$2.getOuter(element);\n    };\n\n    var setMax$1 = function (element, value) {\n      var inclusions = ['margin-left', 'border-left-width', 'padding-left', 'padding-right', 'border-right-width', 'margin-right'];\n      var absMax = api$2.max(element, value, inclusions);\n      $_bfod2hlejfuw8qac.set(element, 'max-width', absMax + 'px');\n    };\n\n    var $_fj252lmejfuw8qin = {\n      set: set$4,\n      get: get$4,\n      getOuter: getOuter$1,\n      setMax: setMax$1\n    };\n    var platform = $_fqgee0ktjfuw8q83.detect();\n\n    var needManualCalc = function () {\n      return platform.browser.isIE() || platform.browser.isEdge();\n    };\n\n    var toNumber = function (px, fallback) {\n      var num = parseFloat(px);\n      return isNaN(num) ? fallback : num;\n    };\n\n    var getProp = function (elm, name, fallback) {\n      return toNumber($_bfod2hlejfuw8qac.get(elm, name), fallback);\n    };\n\n    var getCalculatedHeight = function (cell) {\n      var paddingTop = getProp(cell, 'padding-top', 0);\n      var paddingBottom = getProp(cell, 'padding-bottom', 0);\n      var borderTop = getProp(cell, 'border-top-width', 0);\n      var borderBottom = getProp(cell, 'border-bottom-width', 0);\n      var height = cell.dom().getBoundingClientRect().height;\n      var boxSizing = $_bfod2hlejfuw8qac.get(cell, 'box-sizing');\n      var borders = borderTop + borderBottom;\n      return boxSizing === 'border-box' ? height : height - paddingTop - paddingBottom - borders;\n    };\n\n    var getWidth = function (cell) {\n      return getProp(cell, 'width', $_fj252lmejfuw8qin.get(cell));\n    };\n\n    var getHeight = function (cell) {\n      return needManualCalc() ? getCalculatedHeight(cell) : getProp(cell, 'height', $_cymdhgmcjfuw8qif.get(cell));\n    };\n\n    var $_ddwgqpmbjfuw8qi6 = {\n      getWidth: getWidth,\n      getHeight: getHeight\n    };\n    var genericSizeRegex = /(\\d+(\\.\\d+)?)(\\w|%)*/;\n    var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n    var pixelBasedSizeRegex = /(\\d+(\\.\\d+)?)px|em/;\n\n    var setPixelWidth = function (cell, amount) {\n      $_bfod2hlejfuw8qac.set(cell, 'width', amount + 'px');\n    };\n\n    var setPercentageWidth = function (cell, amount) {\n      $_bfod2hlejfuw8qac.set(cell, 'width', amount + '%');\n    };\n\n    var setHeight = function (cell, amount) {\n      $_bfod2hlejfuw8qac.set(cell, 'height', amount + 'px');\n    };\n\n    var getHeightValue = function (cell) {\n      return $_bfod2hlejfuw8qac.getRaw(cell, 'height').getOrThunk(function () {\n        return $_ddwgqpmbjfuw8qi6.getHeight(cell) + 'px';\n      });\n    };\n\n    var convert = function (cell, number, getter, setter) {\n      var newSize = $_aqhz9okhjfuw8q5y.table(cell).map(function (table) {\n        var total = getter(table);\n        return Math.floor(number / 100 * total);\n      }).getOr(number);\n      setter(cell, newSize);\n      return newSize;\n    };\n\n    var normalizePixelSize = function (value, cell, getter, setter) {\n      var number = parseInt(value, 10);\n      return $_ey09l9l2jfuw8q8y.endsWith(value, '%') && $_a8gk30l6jfuw8q9c.name(cell) !== 'table' ? convert(cell, number, getter, setter) : number;\n    };\n\n    var getTotalHeight = function (cell) {\n      var value = getHeightValue(cell);\n      if (!value) return $_cymdhgmcjfuw8qif.get(cell);\n      return normalizePixelSize(value, cell, $_cymdhgmcjfuw8qif.get, setHeight);\n    };\n\n    var get$5 = function (cell, type, f) {\n      var v = f(cell);\n      var span = getSpan(cell, type);\n      return v / span;\n    };\n\n    var getSpan = function (cell, type) {\n      return $_3q82t2l5jfuw8q93.has(cell, type) ? parseInt($_3q82t2l5jfuw8q93.get(cell, type), 10) : 1;\n    };\n\n    var getRawWidth = function (element) {\n      var cssWidth = $_bfod2hlejfuw8qac.getRaw(element, 'width');\n      return cssWidth.fold(function () {\n        return Option.from($_3q82t2l5jfuw8q93.get(element, 'width'));\n      }, function (width) {\n        return Option.some(width);\n      });\n    };\n\n    var normalizePercentageWidth = function (cellWidth, tableSize) {\n      return cellWidth / tableSize.pixelWidth() * 100;\n    };\n\n    var choosePercentageSize = function (element, width, tableSize) {\n      if (percentageBasedSizeRegex.test(width)) {\n        var percentMatch = percentageBasedSizeRegex.exec(width);\n        return parseFloat(percentMatch[1]);\n      } else {\n        var fallbackWidth = $_fj252lmejfuw8qin.get(element);\n        var intWidth = parseInt(fallbackWidth, 10);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }\n    };\n\n    var getPercentageWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        var width = $_fj252lmejfuw8qin.get(cell);\n        var intWidth = parseInt(width, 10);\n        return normalizePercentageWidth(intWidth, tableSize);\n      }, function (width) {\n        return choosePercentageSize(cell, width, tableSize);\n      });\n    };\n\n    var normalizePixelWidth = function (cellWidth, tableSize) {\n      return cellWidth / 100 * tableSize.pixelWidth();\n    };\n\n    var choosePixelSize = function (element, width, tableSize) {\n      if (pixelBasedSizeRegex.test(width)) {\n        var pixelMatch = pixelBasedSizeRegex.exec(width);\n        return parseInt(pixelMatch[1], 10);\n      } else if (percentageBasedSizeRegex.test(width)) {\n        var percentMatch = percentageBasedSizeRegex.exec(width);\n        var floatWidth = parseFloat(percentMatch[1]);\n        return normalizePixelWidth(floatWidth, tableSize);\n      } else {\n        var fallbackWidth = $_fj252lmejfuw8qin.get(element);\n        return parseInt(fallbackWidth, 10);\n      }\n    };\n\n    var getPixelWidth = function (cell, tableSize) {\n      var width = getRawWidth(cell);\n      return width.fold(function () {\n        var width = $_fj252lmejfuw8qin.get(cell);\n        var intWidth = parseInt(width, 10);\n        return intWidth;\n      }, function (width) {\n        return choosePixelSize(cell, width, tableSize);\n      });\n    };\n\n    var getHeight$1 = function (cell) {\n      return get$5(cell, 'rowspan', getTotalHeight);\n    };\n\n    var getGenericWidth = function (cell) {\n      var width = getRawWidth(cell);\n      return width.bind(function (width) {\n        if (genericSizeRegex.test(width)) {\n          var match = genericSizeRegex.exec(width);\n          return Option.some({\n            width: $_20nfr6k7jfuw8q4g.constant(match[1]),\n            unit: $_20nfr6k7jfuw8q4g.constant(match[3])\n          });\n        } else {\n          return Option.none();\n        }\n      });\n    };\n\n    var setGenericWidth = function (cell, amount, unit) {\n      $_bfod2hlejfuw8qac.set(cell, 'width', amount + unit);\n    };\n\n    var $_by2skemajfuw8qhj = {\n      percentageBasedSizeRegex: $_20nfr6k7jfuw8q4g.constant(percentageBasedSizeRegex),\n      pixelBasedSizeRegex: $_20nfr6k7jfuw8q4g.constant(pixelBasedSizeRegex),\n      setPixelWidth: setPixelWidth,\n      setPercentageWidth: setPercentageWidth,\n      setHeight: setHeight,\n      getPixelWidth: getPixelWidth,\n      getPercentageWidth: getPercentageWidth,\n      getGenericWidth: getGenericWidth,\n      setGenericWidth: setGenericWidth,\n      getHeight: getHeight$1,\n      getRawWidth: getRawWidth\n    };\n\n    var halve = function (main, other) {\n      var width = $_by2skemajfuw8qhj.getGenericWidth(main);\n      width.each(function (width) {\n        var newWidth = width.width() / 2;\n        $_by2skemajfuw8qhj.setGenericWidth(main, newWidth, width.unit());\n        $_by2skemajfuw8qhj.setGenericWidth(other, newWidth, width.unit());\n      });\n    };\n\n    var $_57e49gm9jfuw8qhh = {\n      halve: halve\n    };\n\n    var attached = function (element, scope) {\n      var doc = scope || $_xbeoqkkjfuw8q73.fromDom(document.documentElement);\n      return $_11ympzlbjfuw8q9n.ancestor(element, $_20nfr6k7jfuw8q4g.curry($_e8rn66kojfuw8q7n.eq, doc)).isSome();\n    };\n\n    var windowOf = function (element) {\n      var dom = element.dom();\n      if (dom === dom.window) return element;\n      return $_a8gk30l6jfuw8q9c.isDocument(element) ? dom.defaultView || dom.parentWindow : null;\n    };\n\n    var $_a9ygj4mjjfuw8qj6 = {\n      attached: attached,\n      windowOf: windowOf\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n\n      return {\n        left: $_20nfr6k7jfuw8q4g.constant(left),\n        top: $_20nfr6k7jfuw8q4g.constant(top),\n        translate: translate\n      };\n    };\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return r(box.left, box.top);\n    };\n\n    var firstDefinedOrZero = function (a, b) {\n      return a !== undefined ? a : b !== undefined ? b : 0;\n    };\n\n    var absolute = function (element) {\n      var doc = element.dom().ownerDocument;\n      var body = doc.body;\n      var win = $_a9ygj4mjjfuw8qj6.windowOf($_xbeoqkkjfuw8q73.fromDom(doc));\n      var html = doc.documentElement;\n      var scrollTop = firstDefinedOrZero(win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n\n    var relative = function (element) {\n      var dom = element.dom();\n      return r(dom.offsetLeft, dom.offsetTop);\n    };\n\n    var viewport = function (element) {\n      var dom = element.dom();\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      var html = $_xbeoqkkjfuw8q73.fromDom(doc.documentElement);\n      if (body === dom) return r(body.offsetLeft, body.offsetTop);\n      if (!$_a9ygj4mjjfuw8qj6.attached(element, html)) return r(0, 0);\n      return boxPosition(dom);\n    };\n\n    var $_hsvzlmijfuw8qj4 = {\n      absolute: absolute,\n      relative: relative,\n      viewport: viewport\n    };\n    var rowInfo = $_5now9kbjfuw8q5e.immutable('row', 'y');\n    var colInfo = $_5now9kbjfuw8q5e.immutable('col', 'x');\n\n    var rtlEdge = function (cell) {\n      var pos = $_hsvzlmijfuw8qj4.absolute(cell);\n      return pos.left() + $_fj252lmejfuw8qin.getOuter(cell);\n    };\n\n    var ltrEdge = function (cell) {\n      return $_hsvzlmijfuw8qj4.absolute(cell).left();\n    };\n\n    var getLeftEdge = function (index, cell) {\n      return colInfo(index, ltrEdge(cell));\n    };\n\n    var getRightEdge = function (index, cell) {\n      return colInfo(index, rtlEdge(cell));\n    };\n\n    var getTop = function (cell) {\n      return $_hsvzlmijfuw8qj4.absolute(cell).top();\n    };\n\n    var getTopEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell));\n    };\n\n    var getBottomEdge = function (index, cell) {\n      return rowInfo(index, getTop(cell) + $_cymdhgmcjfuw8qif.getOuter(cell));\n    };\n\n    var findPositions = function (getInnerEdge, getOuterEdge, array) {\n      if (array.length === 0) return [];\n      var lines = $_tyr3yk5jfuw8q47.map(array.slice(1), function (cellOption, index) {\n        return cellOption.map(function (cell) {\n          return getInnerEdge(index, cell);\n        });\n      });\n      var lastLine = array[array.length - 1].map(function (cell) {\n        return getOuterEdge(array.length - 1, cell);\n      });\n      return lines.concat([lastLine]);\n    };\n\n    var negate = function (step, _table) {\n      return -step;\n    };\n\n    var height = {\n      delta: $_20nfr6k7jfuw8q4g.identity,\n      positions: $_20nfr6k7jfuw8q4g.curry(findPositions, getTopEdge, getBottomEdge),\n      edge: getTop\n    };\n    var ltr = {\n      delta: $_20nfr6k7jfuw8q4g.identity,\n      edge: ltrEdge,\n      positions: $_20nfr6k7jfuw8q4g.curry(findPositions, getLeftEdge, getRightEdge)\n    };\n    var rtl = {\n      delta: negate,\n      edge: rtlEdge,\n      positions: $_20nfr6k7jfuw8q4g.curry(findPositions, getRightEdge, getLeftEdge)\n    };\n    var $_16z2iamhjfuw8qir = {\n      height: height,\n      rtl: rtl,\n      ltr: ltr\n    };\n    var $_26mw5tmgjfuw8qiq = {\n      ltr: $_16z2iamhjfuw8qir.ltr,\n      rtl: $_16z2iamhjfuw8qir.rtl\n    };\n\n    function TableDirection(directionAt) {\n      var auto = function (table) {\n        return directionAt(table).isRtl() ? $_26mw5tmgjfuw8qiq.rtl : $_26mw5tmgjfuw8qiq.ltr;\n      };\n\n      var delta = function (amount, table) {\n        return auto(table).delta(amount, table);\n      };\n\n      var positions = function (cols, table) {\n        return auto(table).positions(cols, table);\n      };\n\n      var edge = function (cell) {\n        return auto(cell).edge(cell);\n      };\n\n      return {\n        delta: delta,\n        edge: edge,\n        positions: positions\n      };\n    }\n\n    var getGridSize = function (table) {\n      var input = $_dy3x0nkfjfuw8q5l.fromTable(table);\n      var warehouse = $_2ge24cldjfuw8qa3.generate(input);\n      return warehouse.grid();\n    };\n\n    var $_b452wimljfuw8qjd = {\n      getGridSize: getGridSize\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n\n      var get = function () {\n        return value;\n      };\n\n      var set = function (v) {\n        value = v;\n      };\n\n      var clone = function () {\n        return Cell(get());\n      };\n\n      return {\n        get: get,\n        set: set,\n        clone: clone\n      };\n    };\n\n    var base = function (handleUnsupported, required) {\n      return baseWith(handleUnsupported, required, {\n        validate: $_g6mvnrk8jfuw8q4k.isFunction,\n        label: 'function'\n      });\n    };\n\n    var baseWith = function (handleUnsupported, required, pred) {\n      if (required.length === 0) throw new Error('You must specify at least one required field.');\n      $_2j2nzkkejfuw8q5j.validateStrArr('required', required);\n      $_2j2nzkkejfuw8q5j.checkDupes(required);\n      return function (obj) {\n        var keys = $_11yiupkajfuw8q5c.keys(obj);\n        var allReqd = $_tyr3yk5jfuw8q47.forall(required, function (req) {\n          return $_tyr3yk5jfuw8q47.contains(keys, req);\n        });\n        if (!allReqd) $_2j2nzkkejfuw8q5j.reqMessage(required, keys);\n        handleUnsupported(required, keys);\n        var invalidKeys = $_tyr3yk5jfuw8q47.filter(required, function (key) {\n          return !pred.validate(obj[key], key);\n        });\n        if (invalidKeys.length > 0) $_2j2nzkkejfuw8q5j.invalidTypeMessage(invalidKeys, pred.label);\n        return obj;\n      };\n    };\n\n    var handleExact = function (required, keys) {\n      var unsupported = $_tyr3yk5jfuw8q47.filter(keys, function (key) {\n        return !$_tyr3yk5jfuw8q47.contains(required, key);\n      });\n      if (unsupported.length > 0) $_2j2nzkkejfuw8q5j.unsuppMessage(unsupported);\n    };\n\n    var allowExtra = $_20nfr6k7jfuw8q4g.noop;\n    var $_7z97w5mpjfuw8qkk = {\n      exactly: $_20nfr6k7jfuw8q4g.curry(base, handleExact),\n      ensure: $_20nfr6k7jfuw8q4g.curry(base, allowExtra),\n      ensureWith: $_20nfr6k7jfuw8q4g.curry(baseWith, allowExtra)\n    };\n\n    var elementToData = function (element) {\n      var colspan = $_3q82t2l5jfuw8q93.has(element, 'colspan') ? parseInt($_3q82t2l5jfuw8q93.get(element, 'colspan'), 10) : 1;\n      var rowspan = $_3q82t2l5jfuw8q93.has(element, 'rowspan') ? parseInt($_3q82t2l5jfuw8q93.get(element, 'rowspan'), 10) : 1;\n      return {\n        element: $_20nfr6k7jfuw8q4g.constant(element),\n        colspan: $_20nfr6k7jfuw8q4g.constant(colspan),\n        rowspan: $_20nfr6k7jfuw8q4g.constant(rowspan)\n      };\n    };\n\n    var modification = function (generators, _toData) {\n      contract(generators);\n      var position = Cell(Option.none());\n      var toData = _toData !== undefined ? _toData : elementToData;\n\n      var nu = function (data) {\n        return generators.cell(data);\n      };\n\n      var nuFrom = function (element) {\n        var data = toData(element);\n        return nu(data);\n      };\n\n      var add = function (element) {\n        var replacement = nuFrom(element);\n        if (position.get().isNone()) position.set(Option.some(replacement));\n        recent = Option.some({\n          item: element,\n          replacement: replacement\n        });\n        return replacement;\n      };\n\n      var recent = Option.none();\n\n      var getOrInit = function (element, comparator) {\n        return recent.fold(function () {\n          return add(element);\n        }, function (p) {\n          return comparator(element, p.item) ? p.replacement : add(element);\n        });\n      };\n\n      return {\n        getOrInit: getOrInit,\n        cursor: position.get\n      };\n    };\n\n    var transform = function (scope, tag) {\n      return function (generators) {\n        var position = Cell(Option.none());\n        contract(generators);\n        var list = [];\n\n        var find = function (element, comparator) {\n          return $_tyr3yk5jfuw8q47.find(list, function (x) {\n            return comparator(x.item, element);\n          });\n        };\n\n        var makeNew = function (element) {\n          var cell = generators.replace(element, tag, {\n            scope: scope\n          });\n          list.push({\n            item: element,\n            sub: cell\n          });\n          if (position.get().isNone()) position.set(Option.some(cell));\n          return cell;\n        };\n\n        var replaceOrInit = function (element, comparator) {\n          return find(element, comparator).fold(function () {\n            return makeNew(element);\n          }, function (p) {\n            return comparator(element, p.item) ? p.sub : makeNew(element);\n          });\n        };\n\n        return {\n          replaceOrInit: replaceOrInit,\n          cursor: position.get\n        };\n      };\n    };\n\n    var merging = function (generators) {\n      contract(generators);\n      var position = Cell(Option.none());\n\n      var combine = function (cell) {\n        if (position.get().isNone()) position.set(Option.some(cell));\n        return function () {\n          var raw = generators.cell({\n            element: $_20nfr6k7jfuw8q4g.constant(cell),\n            colspan: $_20nfr6k7jfuw8q4g.constant(1),\n            rowspan: $_20nfr6k7jfuw8q4g.constant(1)\n          });\n          $_bfod2hlejfuw8qac.remove(raw, 'width');\n          $_bfod2hlejfuw8qac.remove(cell, 'width');\n          return raw;\n        };\n      };\n\n      return {\n        combine: combine,\n        cursor: position.get\n      };\n    };\n\n    var contract = $_7z97w5mpjfuw8qkk.exactly(['cell', 'row', 'replace', 'gap']);\n    var $_eoocrvmnjfuw8qk1 = {\n      modification: modification,\n      transform: transform,\n      merging: merging\n    };\n    var blockList = ['body', 'p', 'div', 'article', 'aside', 'figcaption', 'figure', 'footer', 'header', 'nav', 'section', 'ol', 'ul', 'table', 'thead', 'tfoot', 'tbody', 'caption', 'tr', 'td', 'th', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'address'];\n\n    var isList = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return $_tyr3yk5jfuw8q47.contains(['ol', 'ul'], tagName);\n    };\n\n    var isBlock = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return $_tyr3yk5jfuw8q47.contains(blockList, tagName);\n    };\n\n    var isFormatting = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return $_tyr3yk5jfuw8q47.contains(['address', 'pre', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'], tagName);\n    };\n\n    var isHeading = function (universe, item) {\n      var tagName = universe.property().name(item);\n      return $_tyr3yk5jfuw8q47.contains(['h1', 'h2', 'h3', 'h4', 'h5', 'h6'], tagName);\n    };\n\n    var isContainer = function (universe, item) {\n      return $_tyr3yk5jfuw8q47.contains(['div', 'li', 'td', 'th', 'blockquote', 'body', 'caption'], universe.property().name(item));\n    };\n\n    var isEmptyTag = function (universe, item) {\n      return $_tyr3yk5jfuw8q47.contains(['br', 'img', 'hr', 'input'], universe.property().name(item));\n    };\n\n    var isFrame = function (universe, item) {\n      return universe.property().name(item) === 'iframe';\n    };\n\n    var isInline = function (universe, item) {\n      return !(isBlock(universe, item) || isEmptyTag(universe, item)) && universe.property().name(item) !== 'li';\n    };\n\n    var $_325i5bmsjfuw8qle = {\n      isBlock: isBlock,\n      isList: isList,\n      isFormatting: isFormatting,\n      isHeading: isHeading,\n      isContainer: isContainer,\n      isEmptyTag: isEmptyTag,\n      isFrame: isFrame,\n      isInline: isInline\n    };\n    var universe$1 = DomUniverse();\n\n    var isBlock$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isBlock(universe$1, element);\n    };\n\n    var isList$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isList(universe$1, element);\n    };\n\n    var isFormatting$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isFormatting(universe$1, element);\n    };\n\n    var isHeading$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isHeading(universe$1, element);\n    };\n\n    var isContainer$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isContainer(universe$1, element);\n    };\n\n    var isEmptyTag$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isEmptyTag(universe$1, element);\n    };\n\n    var isFrame$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isFrame(universe$1, element);\n    };\n\n    var isInline$1 = function (element) {\n      return $_325i5bmsjfuw8qle.isInline(universe$1, element);\n    };\n\n    var $_d9tdqtmrjfuw8ql9 = {\n      isBlock: isBlock$1,\n      isList: isList$1,\n      isFormatting: isFormatting$1,\n      isHeading: isHeading$1,\n      isContainer: isContainer$1,\n      isEmptyTag: isEmptyTag$1,\n      isFrame: isFrame$1,\n      isInline: isInline$1\n    };\n\n    var merge = function (cells) {\n      var isBr = function (el) {\n        return $_a8gk30l6jfuw8q9c.name(el) === 'br';\n      };\n\n      var advancedBr = function (children) {\n        return $_tyr3yk5jfuw8q47.forall(children, function (c) {\n          return isBr(c) || $_a8gk30l6jfuw8q9c.isText(c) && $_6j8y7blnjfuw8qc3.get(c).trim().length === 0;\n        });\n      };\n\n      var isListItem = function (el) {\n        return $_a8gk30l6jfuw8q9c.name(el) === 'li' || $_11ympzlbjfuw8q9n.ancestor(el, $_d9tdqtmrjfuw8ql9.isList).isSome();\n      };\n\n      var siblingIsBlock = function (el) {\n        return $_s8scrkmjfuw8q7a.nextSibling(el).map(function (rightSibling) {\n          if ($_d9tdqtmrjfuw8ql9.isBlock(rightSibling)) return true;\n\n          if ($_d9tdqtmrjfuw8ql9.isEmptyTag(rightSibling)) {\n            return $_a8gk30l6jfuw8q9c.name(rightSibling) === 'img' ? false : true;\n          }\n        }).getOr(false);\n      };\n\n      var markCell = function (cell) {\n        return $_ejrzj4lljfuw8qbw.last(cell).bind(function (rightEdge) {\n          var rightSiblingIsBlock = siblingIsBlock(rightEdge);\n          return $_s8scrkmjfuw8q7a.parent(rightEdge).map(function (parent) {\n            return rightSiblingIsBlock === true || isListItem(parent) || isBr(rightEdge) || $_d9tdqtmrjfuw8ql9.isBlock(parent) && !$_e8rn66kojfuw8q7n.eq(cell, parent) ? [] : [$_xbeoqkkjfuw8q73.fromTag('br')];\n          });\n        }).getOr([]);\n      };\n\n      var markContent = function () {\n        var content = $_tyr3yk5jfuw8q47.bind(cells, function (cell) {\n          var children = $_s8scrkmjfuw8q7a.children(cell);\n          return advancedBr(children) ? [] : children.concat(markCell(cell));\n        });\n        return content.length === 0 ? [$_xbeoqkkjfuw8q73.fromTag('br')] : content;\n      };\n\n      var contents = markContent();\n      $_fl1deelhjfuw8qax.empty(cells[0]);\n      $_9zaoqflijfuw8qb0.append(cells[0], contents);\n    };\n\n    var $_ancl40mqjfuw8qkm = {\n      merge: merge\n    };\n\n    var shallow$1 = function (old, nu) {\n      return nu;\n    };\n\n    var deep$1 = function (old, nu) {\n      var bothObjects = $_g6mvnrk8jfuw8q4k.isObject(old) && $_g6mvnrk8jfuw8q4k.isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n\n        for (var i = 0; i < objects.length; i++) objects[i] = arguments[i];\n\n        if (objects.length === 0) throw new Error('Can\\'t merge zero objects');\n        var ret = {};\n\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n\n          for (var key in curObject) if (curObject.hasOwnProperty(key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n\n        return ret;\n      };\n    };\n\n    var deepMerge = baseMerge(deep$1);\n    var merge$1 = baseMerge(shallow$1);\n    var $_91sgzmujfuw8qm5 = {\n      deepMerge: deepMerge,\n      merge: merge$1\n    };\n\n    var cat = function (arr) {\n      var r = [];\n\n      var push = function (x) {\n        r.push(x);\n      };\n\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n\n      return r;\n    };\n\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n\n        if (r.isSome()) {\n          return r;\n        }\n      }\n\n      return Option.none();\n    };\n\n    var liftN = function (arr, f) {\n      var r = [];\n\n      for (var i = 0; i < arr.length; i++) {\n        var x = arr[i];\n\n        if (x.isSome()) {\n          r.push(x.getOrDie());\n        } else {\n          return Option.none();\n        }\n      }\n\n      return Option.some(f.apply(null, r));\n    };\n\n    var $_cul8qomvjfuw8qm7 = {\n      cat: cat,\n      findMap: findMap,\n      liftN: liftN\n    };\n\n    var addCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells();\n      var before = cells.slice(0, index);\n      var after = cells.slice(index);\n      var newCells = before.concat([cell]).concat(after);\n      return setCells(gridRow, newCells);\n    };\n\n    var mutateCell = function (gridRow, index, cell) {\n      var cells = gridRow.cells();\n      cells[index] = cell;\n    };\n\n    var setCells = function (gridRow, cells) {\n      return $_ce5pyrkgjfuw8q5v.rowcells(cells, gridRow.section());\n    };\n\n    var mapCells = function (gridRow, f) {\n      var cells = gridRow.cells();\n      var r = $_tyr3yk5jfuw8q47.map(cells, f);\n      return $_ce5pyrkgjfuw8q5v.rowcells(r, gridRow.section());\n    };\n\n    var getCell = function (gridRow, index) {\n      return gridRow.cells()[index];\n    };\n\n    var getCellElement = function (gridRow, index) {\n      return getCell(gridRow, index).element();\n    };\n\n    var cellLength = function (gridRow) {\n      return gridRow.cells().length;\n    };\n\n    var $_aylxzgmyjfuw8qmj = {\n      addCell: addCell,\n      setCells: setCells,\n      mutateCell: mutateCell,\n      getCell: getCell,\n      getCellElement: getCellElement,\n      mapCells: mapCells,\n      cellLength: cellLength\n    };\n\n    var getColumn = function (grid, index) {\n      return $_tyr3yk5jfuw8q47.map(grid, function (row) {\n        return $_aylxzgmyjfuw8qmj.getCell(row, index);\n      });\n    };\n\n    var getRow = function (grid, index) {\n      return grid[index];\n    };\n\n    var findDiff = function (xs, comp) {\n      if (xs.length === 0) return 0;\n      var first = xs[0];\n      var index = $_tyr3yk5jfuw8q47.findIndex(xs, function (x) {\n        return !comp(first.element(), x.element());\n      });\n      return index.fold(function () {\n        return xs.length;\n      }, function (ind) {\n        return ind;\n      });\n    };\n\n    var subgrid = function (grid, row, column, comparator) {\n      var restOfRow = getRow(grid, row).cells().slice(column);\n      var endColIndex = findDiff(restOfRow, comparator);\n      var restOfColumn = getColumn(grid, column).slice(row);\n      var endRowIndex = findDiff(restOfColumn, comparator);\n      return {\n        colspan: $_20nfr6k7jfuw8q4g.constant(endColIndex),\n        rowspan: $_20nfr6k7jfuw8q4g.constant(endRowIndex)\n      };\n    };\n\n    var $_8v4imgmxjfuw8qme = {\n      subgrid: subgrid\n    };\n\n    var toDetails = function (grid, comparator) {\n      var seen = $_tyr3yk5jfuw8q47.map(grid, function (row, ri) {\n        return $_tyr3yk5jfuw8q47.map(row.cells(), function (col, ci) {\n          return false;\n        });\n      });\n\n      var updateSeen = function (ri, ci, rowspan, colspan) {\n        for (var r = ri; r < ri + rowspan; r++) {\n          for (var c = ci; c < ci + colspan; c++) {\n            seen[r][c] = true;\n          }\n        }\n      };\n\n      return $_tyr3yk5jfuw8q47.map(grid, function (row, ri) {\n        var details = $_tyr3yk5jfuw8q47.bind(row.cells(), function (cell, ci) {\n          if (seen[ri][ci] === false) {\n            var result = $_8v4imgmxjfuw8qme.subgrid(grid, ri, ci, comparator);\n            updateSeen(ri, ci, result.rowspan(), result.colspan());\n            return [$_ce5pyrkgjfuw8q5v.detailnew(cell.element(), result.rowspan(), result.colspan(), cell.isNew())];\n          } else {\n            return [];\n          }\n        });\n        return $_ce5pyrkgjfuw8q5v.rowdetails(details, row.section());\n      });\n    };\n\n    var toGrid = function (warehouse, generators, isNew) {\n      var grid = [];\n\n      for (var i = 0; i < warehouse.grid().rows(); i++) {\n        var rowCells = [];\n\n        for (var j = 0; j < warehouse.grid().columns(); j++) {\n          var element = $_2ge24cldjfuw8qa3.getAt(warehouse, i, j).map(function (item) {\n            return $_ce5pyrkgjfuw8q5v.elementnew(item.element(), isNew);\n          }).getOrThunk(function () {\n            return $_ce5pyrkgjfuw8q5v.elementnew(generators.gap(), true);\n          });\n          rowCells.push(element);\n        }\n\n        var row = $_ce5pyrkgjfuw8q5v.rowcells(rowCells, warehouse.all()[i].section());\n        grid.push(row);\n      }\n\n      return grid;\n    };\n\n    var $_cw9o3smwjfuw8qm9 = {\n      toDetails: toDetails,\n      toGrid: toGrid\n    };\n\n    var setIfNot = function (element, property, value, ignore) {\n      if (value === ignore) $_3q82t2l5jfuw8q93.remove(element, property);else $_3q82t2l5jfuw8q93.set(element, property, value);\n    };\n\n    var render = function (table, grid) {\n      var newRows = [];\n      var newCells = [];\n\n      var renderSection = function (gridSection, sectionName) {\n        var section = $_8wdrbmlajfuw8q9m.child(table, sectionName).getOrThunk(function () {\n          var tb = $_xbeoqkkjfuw8q73.fromTag(sectionName, $_s8scrkmjfuw8q7a.owner(table).dom());\n          $_fatuxylgjfuw8qav.append(table, tb);\n          return tb;\n        });\n        $_fl1deelhjfuw8qax.empty(section);\n        var rows = $_tyr3yk5jfuw8q47.map(gridSection, function (row) {\n          if (row.isNew()) {\n            newRows.push(row.element());\n          }\n\n          var tr = row.element();\n          $_fl1deelhjfuw8qax.empty(tr);\n          $_tyr3yk5jfuw8q47.each(row.cells(), function (cell) {\n            if (cell.isNew()) {\n              newCells.push(cell.element());\n            }\n\n            setIfNot(cell.element(), 'colspan', cell.colspan(), 1);\n            setIfNot(cell.element(), 'rowspan', cell.rowspan(), 1);\n            $_fatuxylgjfuw8qav.append(tr, cell.element());\n          });\n          return tr;\n        });\n        $_9zaoqflijfuw8qb0.append(section, rows);\n      };\n\n      var removeSection = function (sectionName) {\n        $_8wdrbmlajfuw8q9m.child(table, sectionName).bind($_fl1deelhjfuw8qax.remove);\n      };\n\n      var renderOrRemoveSection = function (gridSection, sectionName) {\n        if (gridSection.length > 0) {\n          renderSection(gridSection, sectionName);\n        } else {\n          removeSection(sectionName);\n        }\n      };\n\n      var headSection = [];\n      var bodySection = [];\n      var footSection = [];\n      $_tyr3yk5jfuw8q47.each(grid, function (row) {\n        switch (row.section()) {\n          case 'thead':\n            headSection.push(row);\n            break;\n\n          case 'tbody':\n            bodySection.push(row);\n            break;\n\n          case 'tfoot':\n            footSection.push(row);\n            break;\n        }\n      });\n      renderOrRemoveSection(headSection, 'thead');\n      renderOrRemoveSection(bodySection, 'tbody');\n      renderOrRemoveSection(footSection, 'tfoot');\n      return {\n        newRows: $_20nfr6k7jfuw8q4g.constant(newRows),\n        newCells: $_20nfr6k7jfuw8q4g.constant(newCells)\n      };\n    };\n\n    var copy$2 = function (grid) {\n      var rows = $_tyr3yk5jfuw8q47.map(grid, function (row) {\n        var tr = $_ddvp06lkjfuw8qbt.shallow(row.element());\n        $_tyr3yk5jfuw8q47.each(row.cells(), function (cell) {\n          var clonedCell = $_ddvp06lkjfuw8qbt.deep(cell.element());\n          setIfNot(clonedCell, 'colspan', cell.colspan(), 1);\n          setIfNot(clonedCell, 'rowspan', cell.rowspan(), 1);\n          $_fatuxylgjfuw8qav.append(tr, clonedCell);\n        });\n        return tr;\n      });\n      return rows;\n    };\n\n    var $_c9mejomzjfuw8qmn = {\n      render: render,\n      copy: copy$2\n    };\n\n    var repeat = function (repititions, f) {\n      var r = [];\n\n      for (var i = 0; i < repititions; i++) {\n        r.push(f(i));\n      }\n\n      return r;\n    };\n\n    var range$1 = function (start, end) {\n      var r = [];\n\n      for (var i = start; i < end; i++) {\n        r.push(i);\n      }\n\n      return r;\n    };\n\n    var unique = function (xs, comparator) {\n      var result = [];\n      $_tyr3yk5jfuw8q47.each(xs, function (x, i) {\n        if (i < xs.length - 1 && !comparator(x, xs[i + 1])) {\n          result.push(x);\n        } else if (i === xs.length - 1) {\n          result.push(x);\n        }\n      });\n      return result;\n    };\n\n    var deduce = function (xs, index) {\n      if (index < 0 || index >= xs.length - 1) return Option.none();\n      var current = xs[index].fold(function () {\n        var rest = $_tyr3yk5jfuw8q47.reverse(xs.slice(0, index));\n        return $_cul8qomvjfuw8qm7.findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (c) {\n        return Option.some({\n          value: c,\n          delta: 0\n        });\n      });\n      var next = xs[index + 1].fold(function () {\n        var rest = xs.slice(index + 1);\n        return $_cul8qomvjfuw8qm7.findMap(rest, function (a, i) {\n          return a.map(function (aa) {\n            return {\n              value: aa,\n              delta: i + 1\n            };\n          });\n        });\n      }, function (n) {\n        return Option.some({\n          value: n,\n          delta: 1\n        });\n      });\n      return current.bind(function (c) {\n        return next.map(function (n) {\n          var extras = n.delta + c.delta;\n          return Math.abs(n.value - c.value) / extras;\n        });\n      });\n    };\n\n    var $_fcnwwbn2jfuw8qoa = {\n      repeat: repeat,\n      range: range$1,\n      unique: unique,\n      deduce: deduce\n    };\n\n    var columns = function (warehouse) {\n      var grid = warehouse.grid();\n      var cols = $_fcnwwbn2jfuw8qoa.range(0, grid.columns());\n      var rows = $_fcnwwbn2jfuw8qoa.range(0, grid.rows());\n      return $_tyr3yk5jfuw8q47.map(cols, function (col) {\n        var getBlock = function () {\n          return $_tyr3yk5jfuw8q47.bind(rows, function (r) {\n            return $_2ge24cldjfuw8qa3.getAt(warehouse, r, col).filter(function (detail) {\n              return detail.column() === col;\n            }).fold($_20nfr6k7jfuw8q4g.constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n\n        var isSingle = function (detail) {\n          return detail.colspan() === 1;\n        };\n\n        var getFallback = function () {\n          return $_2ge24cldjfuw8qa3.getAt(warehouse, 0, col);\n        };\n\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n\n    var decide = function (getBlock, isSingle, getFallback) {\n      var inBlock = getBlock();\n      var singleInBlock = $_tyr3yk5jfuw8q47.find(inBlock, isSingle);\n      var detailOption = singleInBlock.orThunk(function () {\n        return Option.from(inBlock[0]).orThunk(getFallback);\n      });\n      return detailOption.map(function (detail) {\n        return detail.element();\n      });\n    };\n\n    var rows$1 = function (warehouse) {\n      var grid = warehouse.grid();\n      var rows = $_fcnwwbn2jfuw8qoa.range(0, grid.rows());\n      var cols = $_fcnwwbn2jfuw8qoa.range(0, grid.columns());\n      return $_tyr3yk5jfuw8q47.map(rows, function (row) {\n        var getBlock = function () {\n          return $_tyr3yk5jfuw8q47.bind(cols, function (c) {\n            return $_2ge24cldjfuw8qa3.getAt(warehouse, row, c).filter(function (detail) {\n              return detail.row() === row;\n            }).fold($_20nfr6k7jfuw8q4g.constant([]), function (detail) {\n              return [detail];\n            });\n          });\n        };\n\n        var isSingle = function (detail) {\n          return detail.rowspan() === 1;\n        };\n\n        var getFallback = function () {\n          return $_2ge24cldjfuw8qa3.getAt(warehouse, row, 0);\n        };\n\n        return decide(getBlock, isSingle, getFallback);\n      });\n    };\n\n    var $_9oko5pn1jfuw8qo0 = {\n      columns: columns,\n      rows: rows$1\n    };\n\n    var col = function (column, x, y, w, h) {\n      var blocker = $_xbeoqkkjfuw8q73.fromTag('div');\n      $_bfod2hlejfuw8qac.setAll(blocker, {\n        position: 'absolute',\n        left: x - w / 2 + 'px',\n        top: y + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      $_3q82t2l5jfuw8q93.setAll(blocker, {\n        'data-column': column,\n        'role': 'presentation'\n      });\n      return blocker;\n    };\n\n    var row$1 = function (row, x, y, w, h) {\n      var blocker = $_xbeoqkkjfuw8q73.fromTag('div');\n      $_bfod2hlejfuw8qac.setAll(blocker, {\n        position: 'absolute',\n        left: x + 'px',\n        top: y - h / 2 + 'px',\n        height: h + 'px',\n        width: w + 'px'\n      });\n      $_3q82t2l5jfuw8q93.setAll(blocker, {\n        'data-row': row,\n        'role': 'presentation'\n      });\n      return blocker;\n    };\n\n    var $_bis8idn3jfuw8qoi = {\n      col: col,\n      row: row$1\n    };\n\n    var css = function (namespace) {\n      var dashNamespace = namespace.replace(/\\./g, '-');\n\n      var resolve = function (str) {\n        return dashNamespace + '-' + str;\n      };\n\n      return {\n        resolve: resolve\n      };\n    };\n\n    var $_63w6atn5jfuw8qot = {\n      css: css\n    };\n    var styles = $_63w6atn5jfuw8qot.css('ephox-snooker');\n    var $_f6r94sn4jfuw8qoq = {\n      resolve: styles.resolve\n    };\n\n    function Toggler(turnOff, turnOn, initial) {\n      var active = initial || false;\n\n      var on = function () {\n        turnOn();\n        active = true;\n      };\n\n      var off = function () {\n        turnOff();\n        active = false;\n      };\n\n      var toggle = function () {\n        var f = active ? off : on;\n        f();\n      };\n\n      var isOn = function () {\n        return active;\n      };\n\n      return {\n        on: on,\n        off: off,\n        toggle: toggle,\n        isOn: isOn\n      };\n    }\n\n    var read = function (element, attr) {\n      var value = $_3q82t2l5jfuw8q93.get(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n\n    var add = function (element, attr, id) {\n      var old = read(element, attr);\n      var nu = old.concat([id]);\n      $_3q82t2l5jfuw8q93.set(element, attr, nu.join(' '));\n    };\n\n    var remove$3 = function (element, attr, id) {\n      var nu = $_tyr3yk5jfuw8q47.filter(read(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) $_3q82t2l5jfuw8q93.set(element, attr, nu.join(' '));else $_3q82t2l5jfuw8q93.remove(element, attr);\n    };\n\n    var $_61h5lon9jfuw8qp0 = {\n      read: read,\n      add: add,\n      remove: remove$3\n    };\n\n    var supports = function (element) {\n      return element.dom().classList !== undefined;\n    };\n\n    var get$6 = function (element) {\n      return $_61h5lon9jfuw8qp0.read(element, 'class');\n    };\n\n    var add$1 = function (element, clazz) {\n      return $_61h5lon9jfuw8qp0.add(element, 'class', clazz);\n    };\n\n    var remove$4 = function (element, clazz) {\n      return $_61h5lon9jfuw8qp0.remove(element, 'class', clazz);\n    };\n\n    var toggle = function (element, clazz) {\n      if ($_tyr3yk5jfuw8q47.contains(get$6(element), clazz)) {\n        remove$4(element, clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n\n    var $_f4rpvun8jfuw8qox = {\n      get: get$6,\n      add: add$1,\n      remove: remove$4,\n      toggle: toggle,\n      supports: supports\n    };\n\n    var add$2 = function (element, clazz) {\n      if ($_f4rpvun8jfuw8qox.supports(element)) element.dom().classList.add(clazz);else $_f4rpvun8jfuw8qox.add(element, clazz);\n    };\n\n    var cleanClass = function (element) {\n      var classList = $_f4rpvun8jfuw8qox.supports(element) ? element.dom().classList : $_f4rpvun8jfuw8qox.get(element);\n\n      if (classList.length === 0) {\n        $_3q82t2l5jfuw8q93.remove(element, 'class');\n      }\n    };\n\n    var remove$5 = function (element, clazz) {\n      if ($_f4rpvun8jfuw8qox.supports(element)) {\n        var classList = element.dom().classList;\n        classList.remove(clazz);\n      } else $_f4rpvun8jfuw8qox.remove(element, clazz);\n\n      cleanClass(element);\n    };\n\n    var toggle$1 = function (element, clazz) {\n      return $_f4rpvun8jfuw8qox.supports(element) ? element.dom().classList.toggle(clazz) : $_f4rpvun8jfuw8qox.toggle(element, clazz);\n    };\n\n    var toggler = function (element, clazz) {\n      var hasClasslist = $_f4rpvun8jfuw8qox.supports(element);\n      var classList = element.dom().classList;\n\n      var off = function () {\n        if (hasClasslist) classList.remove(clazz);else $_f4rpvun8jfuw8qox.remove(element, clazz);\n      };\n\n      var on = function () {\n        if (hasClasslist) classList.add(clazz);else $_f4rpvun8jfuw8qox.add(element, clazz);\n      };\n\n      return Toggler(off, on, has$1(element, clazz));\n    };\n\n    var has$1 = function (element, clazz) {\n      return $_f4rpvun8jfuw8qox.supports(element) && element.dom().classList.contains(clazz);\n    };\n\n    var $_fmcseon6jfuw8qou = {\n      add: add$2,\n      remove: remove$5,\n      toggle: toggle$1,\n      toggler: toggler,\n      has: has$1\n    };\n    var resizeBar = $_f6r94sn4jfuw8qoq.resolve('resizer-bar');\n    var resizeRowBar = $_f6r94sn4jfuw8qoq.resolve('resizer-rows');\n    var resizeColBar = $_f6r94sn4jfuw8qoq.resolve('resizer-cols');\n    var BAR_THICKNESS = 7;\n\n    var clear = function (wire) {\n      var previous = $_6c9d0hl7jfuw8q9d.descendants(wire.parent(), '.' + resizeBar);\n      $_tyr3yk5jfuw8q47.each(previous, $_fl1deelhjfuw8qax.remove);\n    };\n\n    var drawBar = function (wire, positions, create) {\n      var origin = wire.origin();\n      $_tyr3yk5jfuw8q47.each(positions, function (cpOption, i) {\n        cpOption.each(function (cp) {\n          var bar = create(origin, cp);\n          $_fmcseon6jfuw8qou.add(bar, resizeBar);\n          $_fatuxylgjfuw8qav.append(wire.parent(), bar);\n        });\n      });\n    };\n\n    var refreshCol = function (wire, colPositions, position, tableHeight) {\n      drawBar(wire, colPositions, function (origin, cp) {\n        var colBar = $_bis8idn3jfuw8qoi.col(cp.col(), cp.x() - origin.left(), position.top() - origin.top(), BAR_THICKNESS, tableHeight);\n        $_fmcseon6jfuw8qou.add(colBar, resizeColBar);\n        return colBar;\n      });\n    };\n\n    var refreshRow = function (wire, rowPositions, position, tableWidth) {\n      drawBar(wire, rowPositions, function (origin, cp) {\n        var rowBar = $_bis8idn3jfuw8qoi.row(cp.row(), position.left() - origin.left(), cp.y() - origin.top(), tableWidth, BAR_THICKNESS);\n        $_fmcseon6jfuw8qou.add(rowBar, resizeRowBar);\n        return rowBar;\n      });\n    };\n\n    var refreshGrid = function (wire, table, rows, cols, hdirection, vdirection) {\n      var position = $_hsvzlmijfuw8qj4.absolute(table);\n      var rowPositions = rows.length > 0 ? hdirection.positions(rows, table) : [];\n      refreshRow(wire, rowPositions, position, $_fj252lmejfuw8qin.getOuter(table));\n      var colPositions = cols.length > 0 ? vdirection.positions(cols, table) : [];\n      refreshCol(wire, colPositions, position, $_cymdhgmcjfuw8qif.getOuter(table));\n    };\n\n    var refresh = function (wire, table, hdirection, vdirection) {\n      clear(wire);\n      var list = $_dy3x0nkfjfuw8q5l.fromTable(table);\n      var warehouse = $_2ge24cldjfuw8qa3.generate(list);\n      var rows = $_9oko5pn1jfuw8qo0.rows(warehouse);\n      var cols = $_9oko5pn1jfuw8qo0.columns(warehouse);\n      refreshGrid(wire, table, rows, cols, hdirection, vdirection);\n    };\n\n    var each$2 = function (wire, f) {\n      var bars = $_6c9d0hl7jfuw8q9d.descendants(wire.parent(), '.' + resizeBar);\n      $_tyr3yk5jfuw8q47.each(bars, f);\n    };\n\n    var hide = function (wire) {\n      each$2(wire, function (bar) {\n        $_bfod2hlejfuw8qac.set(bar, 'display', 'none');\n      });\n    };\n\n    var show = function (wire) {\n      each$2(wire, function (bar) {\n        $_bfod2hlejfuw8qac.set(bar, 'display', 'block');\n      });\n    };\n\n    var isRowBar = function (element) {\n      return $_fmcseon6jfuw8qou.has(element, resizeRowBar);\n    };\n\n    var isColBar = function (element) {\n      return $_fmcseon6jfuw8qou.has(element, resizeColBar);\n    };\n\n    var $_jc1w5n0jfuw8qng = {\n      refresh: refresh,\n      hide: hide,\n      show: show,\n      destroy: clear,\n      isRowBar: isRowBar,\n      isColBar: isColBar\n    };\n\n    var fromWarehouse = function (warehouse, generators) {\n      return $_cw9o3smwjfuw8qm9.toGrid(warehouse, generators, false);\n    };\n\n    var deriveRows = function (rendered, generators) {\n      var findRow = function (details) {\n        var rowOfCells = $_cul8qomvjfuw8qm7.findMap(details, function (detail) {\n          return $_s8scrkmjfuw8q7a.parent(detail.element()).map(function (row) {\n            var isNew = $_s8scrkmjfuw8q7a.parent(row).isNone();\n            return $_ce5pyrkgjfuw8q5v.elementnew(row, isNew);\n          });\n        });\n        return rowOfCells.getOrThunk(function () {\n          return $_ce5pyrkgjfuw8q5v.elementnew(generators.row(), true);\n        });\n      };\n\n      return $_tyr3yk5jfuw8q47.map(rendered, function (details) {\n        var row = findRow(details.details());\n        return $_ce5pyrkgjfuw8q5v.rowdatanew(row.element(), details.details(), details.section(), row.isNew());\n      });\n    };\n\n    var toDetailList = function (grid, generators) {\n      var rendered = $_cw9o3smwjfuw8qm9.toDetails(grid, $_e8rn66kojfuw8q7n.eq);\n      return deriveRows(rendered, generators);\n    };\n\n    var findInWarehouse = function (warehouse, element) {\n      var all = $_tyr3yk5jfuw8q47.flatten($_tyr3yk5jfuw8q47.map(warehouse.all(), function (r) {\n        return r.cells();\n      }));\n      return $_tyr3yk5jfuw8q47.find(all, function (e) {\n        return $_e8rn66kojfuw8q7n.eq(element, e.element());\n      });\n    };\n\n    var run = function (operation, extract, adjustment, postAction, genWrappers) {\n      return function (wire, table, target, generators, direction) {\n        var input = $_dy3x0nkfjfuw8q5l.fromTable(table);\n        var warehouse = $_2ge24cldjfuw8qa3.generate(input);\n        var output = extract(warehouse, target).map(function (info) {\n          var model = fromWarehouse(warehouse, generators);\n          var result = operation(model, info, $_e8rn66kojfuw8q7n.eq, genWrappers(generators));\n          var grid = toDetailList(result.grid(), generators);\n          return {\n            grid: $_20nfr6k7jfuw8q4g.constant(grid),\n            cursor: result.cursor\n          };\n        });\n        return output.fold(function () {\n          return Option.none();\n        }, function (out) {\n          var newElements = $_c9mejomzjfuw8qmn.render(table, out.grid());\n          adjustment(table, out.grid(), direction);\n          postAction(table);\n          $_jc1w5n0jfuw8qng.refresh(wire, table, $_16z2iamhjfuw8qir.height, direction);\n          return Option.some({\n            cursor: out.cursor,\n            newRows: newElements.newRows,\n            newCells: newElements.newCells\n          });\n        });\n      };\n    };\n\n    var onCell = function (warehouse, target) {\n      return $_aqhz9okhjfuw8q5y.cell(target.element()).bind(function (cell) {\n        return findInWarehouse(warehouse, cell);\n      });\n    };\n\n    var onPaste = function (warehouse, target) {\n      return $_aqhz9okhjfuw8q5y.cell(target.element()).bind(function (cell) {\n        return findInWarehouse(warehouse, cell).map(function (details) {\n          return $_91sgzmujfuw8qm5.merge(details, {\n            generators: target.generators,\n            clipboard: target.clipboard\n          });\n        });\n      });\n    };\n\n    var onPasteRows = function (warehouse, target) {\n      var details = $_tyr3yk5jfuw8q47.map(target.selection(), function (cell) {\n        return $_aqhz9okhjfuw8q5y.cell(cell).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        });\n      });\n      var cells = $_cul8qomvjfuw8qm7.cat(details);\n      return cells.length > 0 ? Option.some($_91sgzmujfuw8qm5.merge({\n        cells: cells\n      }, {\n        generators: target.generators,\n        clipboard: target.clipboard\n      })) : Option.none();\n    };\n\n    var onMergable = function (warehouse, target) {\n      return target.mergable();\n    };\n\n    var onUnmergable = function (warehouse, target) {\n      return target.unmergable();\n    };\n\n    var onCells = function (warehouse, target) {\n      var details = $_tyr3yk5jfuw8q47.map(target.selection(), function (cell) {\n        return $_aqhz9okhjfuw8q5y.cell(cell).bind(function (lc) {\n          return findInWarehouse(warehouse, lc);\n        });\n      });\n      var cells = $_cul8qomvjfuw8qm7.cat(details);\n      return cells.length > 0 ? Option.some(cells) : Option.none();\n    };\n\n    var $_dis709mtjfuw8qlp = {\n      run: run,\n      toDetailList: toDetailList,\n      onCell: onCell,\n      onCells: onCells,\n      onPaste: onPaste,\n      onPasteRows: onPasteRows,\n      onMergable: onMergable,\n      onUnmergable: onUnmergable\n    };\n\n    var value$1 = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n\n      var or = function (opt) {\n        return value$1(o);\n      };\n\n      var orThunk = function (f) {\n        return value$1(o);\n      };\n\n      var map = function (f) {\n        return value$1(f(o));\n      };\n\n      var each = function (f) {\n        f(o);\n      };\n\n      var bind = function (f) {\n        return f(o);\n      };\n\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n\n      var exists = function (f) {\n        return f(o);\n      };\n\n      var forall = function (f) {\n        return f(o);\n      };\n\n      var toOption = function () {\n        return Option.some(o);\n      };\n\n      return {\n        is: is,\n        isValue: $_20nfr6k7jfuw8q4g.always,\n        isError: $_20nfr6k7jfuw8q4g.never,\n        getOr: $_20nfr6k7jfuw8q4g.constant(o),\n        getOrThunk: $_20nfr6k7jfuw8q4g.constant(o),\n        getOrDie: $_20nfr6k7jfuw8q4g.constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOption: toOption\n      };\n    };\n\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n\n      var getOrDie = function () {\n        return $_20nfr6k7jfuw8q4g.die(String(message))();\n      };\n\n      var or = function (opt) {\n        return opt;\n      };\n\n      var orThunk = function (f) {\n        return f();\n      };\n\n      var map = function (f) {\n        return error(message);\n      };\n\n      var bind = function (f) {\n        return error(message);\n      };\n\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n\n      return {\n        is: $_20nfr6k7jfuw8q4g.never,\n        isValue: $_20nfr6k7jfuw8q4g.never,\n        isError: $_20nfr6k7jfuw8q4g.always,\n        getOr: $_20nfr6k7jfuw8q4g.identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        each: $_20nfr6k7jfuw8q4g.noop,\n        bind: bind,\n        exists: $_20nfr6k7jfuw8q4g.never,\n        forall: $_20nfr6k7jfuw8q4g.always,\n        toOption: Option.none\n      };\n    };\n\n    var Result = {\n      value: value$1,\n      error: error\n    };\n\n    var measure = function (startAddress, gridA, gridB) {\n      if (startAddress.row() >= gridA.length || startAddress.column() > $_aylxzgmyjfuw8qmj.cellLength(gridA[0])) return Result.error('invalid start address out of table bounds, row: ' + startAddress.row() + ', column: ' + startAddress.column());\n      var rowRemainder = gridA.slice(startAddress.row());\n      var colRemainder = rowRemainder[0].cells().slice(startAddress.column());\n      var colRequired = $_aylxzgmyjfuw8qmj.cellLength(gridB[0]);\n      var rowRequired = gridB.length;\n      return Result.value({\n        rowDelta: $_20nfr6k7jfuw8q4g.constant(rowRemainder.length - rowRequired),\n        colDelta: $_20nfr6k7jfuw8q4g.constant(colRemainder.length - colRequired)\n      });\n    };\n\n    var measureWidth = function (gridA, gridB) {\n      var colLengthA = $_aylxzgmyjfuw8qmj.cellLength(gridA[0]);\n      var colLengthB = $_aylxzgmyjfuw8qmj.cellLength(gridB[0]);\n      return {\n        rowDelta: $_20nfr6k7jfuw8q4g.constant(0),\n        colDelta: $_20nfr6k7jfuw8q4g.constant(colLengthA - colLengthB)\n      };\n    };\n\n    var fill = function (cells, generator) {\n      return $_tyr3yk5jfuw8q47.map(cells, function () {\n        return $_ce5pyrkgjfuw8q5v.elementnew(generator.cell(), true);\n      });\n    };\n\n    var rowFill = function (grid, amount, generator) {\n      return grid.concat($_fcnwwbn2jfuw8qoa.repeat(amount, function (_row) {\n        return $_aylxzgmyjfuw8qmj.setCells(grid[grid.length - 1], fill(grid[grid.length - 1].cells(), generator));\n      }));\n    };\n\n    var colFill = function (grid, amount, generator) {\n      return $_tyr3yk5jfuw8q47.map(grid, function (row) {\n        return $_aylxzgmyjfuw8qmj.setCells(row, row.cells().concat(fill($_fcnwwbn2jfuw8qoa.range(0, amount), generator)));\n      });\n    };\n\n    var tailor = function (gridA, delta, generator) {\n      var fillCols = delta.colDelta() < 0 ? colFill : $_20nfr6k7jfuw8q4g.identity;\n      var fillRows = delta.rowDelta() < 0 ? rowFill : $_20nfr6k7jfuw8q4g.identity;\n      var modifiedCols = fillCols(gridA, Math.abs(delta.colDelta()), generator);\n      var tailoredGrid = fillRows(modifiedCols, Math.abs(delta.rowDelta()), generator);\n      return tailoredGrid;\n    };\n\n    var $_pbbdjnbjfuw8qpe = {\n      measure: measure,\n      measureWidth: measureWidth,\n      tailor: tailor\n    };\n\n    var merge$2 = function (grid, bounds, comparator, substitution) {\n      if (grid.length === 0) return grid;\n\n      for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n        for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n          $_aylxzgmyjfuw8qmj.mutateCell(grid[i], j, $_ce5pyrkgjfuw8q5v.elementnew(substitution(), false));\n        }\n      }\n\n      return grid;\n    };\n\n    var unmerge = function (grid, target, comparator, substitution) {\n      var first = true;\n\n      for (var i = 0; i < grid.length; i++) {\n        for (var j = 0; j < $_aylxzgmyjfuw8qmj.cellLength(grid[0]); j++) {\n          var current = $_aylxzgmyjfuw8qmj.getCellElement(grid[i], j);\n          var isToReplace = comparator(current, target);\n\n          if (isToReplace === true && first === false) {\n            $_aylxzgmyjfuw8qmj.mutateCell(grid[i], j, $_ce5pyrkgjfuw8q5v.elementnew(substitution(), true));\n          } else if (isToReplace === true) {\n            first = false;\n          }\n        }\n      }\n\n      return grid;\n    };\n\n    var uniqueCells = function (row, comparator) {\n      return $_tyr3yk5jfuw8q47.foldl(row, function (rest, cell) {\n        return $_tyr3yk5jfuw8q47.exists(rest, function (currentCell) {\n          return comparator(currentCell.element(), cell.element());\n        }) ? rest : rest.concat([cell]);\n      }, []);\n    };\n\n    var splitRows = function (grid, index, comparator, substitution) {\n      if (index > 0 && index < grid.length) {\n        var rowPrevCells = grid[index - 1].cells();\n        var cells = uniqueCells(rowPrevCells, comparator);\n        $_tyr3yk5jfuw8q47.each(cells, function (cell) {\n          var replacement = Option.none();\n\n          for (var i = index; i < grid.length; i++) {\n            for (var j = 0; j < $_aylxzgmyjfuw8qmj.cellLength(grid[0]); j++) {\n              var current = grid[i].cells()[j];\n              var isToReplace = comparator(current.element(), cell.element());\n\n              if (isToReplace) {\n                if (replacement.isNone()) {\n                  replacement = Option.some(substitution());\n                }\n\n                replacement.each(function (sub) {\n                  $_aylxzgmyjfuw8qmj.mutateCell(grid[i], j, $_ce5pyrkgjfuw8q5v.elementnew(sub, true));\n                });\n              }\n            }\n          }\n        });\n      }\n\n      return grid;\n    };\n\n    var $_72fqzkndjfuw8qpp = {\n      merge: merge$2,\n      unmerge: unmerge,\n      splitRows: splitRows\n    };\n\n    var isSpanning = function (grid, row, col, comparator) {\n      var candidate = $_aylxzgmyjfuw8qmj.getCell(grid[row], col);\n      var matching = $_20nfr6k7jfuw8q4g.curry(comparator, candidate.element());\n      var currentRow = grid[row];\n      return grid.length > 1 && $_aylxzgmyjfuw8qmj.cellLength(currentRow) > 1 && (col > 0 && matching($_aylxzgmyjfuw8qmj.getCellElement(currentRow, col - 1)) || col < currentRow.length - 1 && matching($_aylxzgmyjfuw8qmj.getCellElement(currentRow, col + 1)) || row > 0 && matching($_aylxzgmyjfuw8qmj.getCellElement(grid[row - 1], col)) || row < grid.length - 1 && matching($_aylxzgmyjfuw8qmj.getCellElement(grid[row + 1], col)));\n    };\n\n    var mergeTables = function (startAddress, gridA, gridB, generator, comparator) {\n      var startRow = startAddress.row();\n      var startCol = startAddress.column();\n      var mergeHeight = gridB.length;\n      var mergeWidth = $_aylxzgmyjfuw8qmj.cellLength(gridB[0]);\n      var endRow = startRow + mergeHeight;\n      var endCol = startCol + mergeWidth;\n\n      for (var r = startRow; r < endRow; r++) {\n        for (var c = startCol; c < endCol; c++) {\n          if (isSpanning(gridA, r, c, comparator)) {\n            $_72fqzkndjfuw8qpp.unmerge(gridA, $_aylxzgmyjfuw8qmj.getCellElement(gridA[r], c), comparator, generator.cell);\n          }\n\n          var newCell = $_aylxzgmyjfuw8qmj.getCellElement(gridB[r - startRow], c - startCol);\n          var replacement = generator.replace(newCell);\n          $_aylxzgmyjfuw8qmj.mutateCell(gridA[r], c, $_ce5pyrkgjfuw8q5v.elementnew(replacement, true));\n        }\n      }\n\n      return gridA;\n    };\n\n    var merge$3 = function (startAddress, gridA, gridB, generator, comparator) {\n      var result = $_pbbdjnbjfuw8qpe.measure(startAddress, gridA, gridB);\n      return result.map(function (delta) {\n        var fittedGrid = $_pbbdjnbjfuw8qpe.tailor(gridA, delta, generator);\n        return mergeTables(startAddress, fittedGrid, gridB, generator, comparator);\n      });\n    };\n\n    var insert = function (index, gridA, gridB, generator, comparator) {\n      $_72fqzkndjfuw8qpp.splitRows(gridA, index, comparator, generator.cell);\n      var delta = $_pbbdjnbjfuw8qpe.measureWidth(gridB, gridA);\n      var fittedNewGrid = $_pbbdjnbjfuw8qpe.tailor(gridB, delta, generator);\n      var secondDelta = $_pbbdjnbjfuw8qpe.measureWidth(gridA, fittedNewGrid);\n      var fittedOldGrid = $_pbbdjnbjfuw8qpe.tailor(gridA, secondDelta, generator);\n      return fittedOldGrid.slice(0, index).concat(fittedNewGrid).concat(fittedOldGrid.slice(index, fittedOldGrid.length));\n    };\n\n    var $_5jycvqnajfuw8qp5 = {\n      merge: merge$3,\n      insert: insert\n    };\n\n    var insertRowAt = function (grid, index, example, comparator, substitution) {\n      var before = grid.slice(0, index);\n      var after = grid.slice(index);\n      var between = $_aylxzgmyjfuw8qmj.mapCells(grid[example], function (ex, c) {\n        var withinSpan = index > 0 && index < grid.length && comparator($_aylxzgmyjfuw8qmj.getCellElement(grid[index - 1], c), $_aylxzgmyjfuw8qmj.getCellElement(grid[index], c));\n        var ret = withinSpan ? $_aylxzgmyjfuw8qmj.getCell(grid[index], c) : $_ce5pyrkgjfuw8q5v.elementnew(substitution(ex.element(), comparator), true);\n        return ret;\n      });\n      return before.concat([between]).concat(after);\n    };\n\n    var insertColumnAt = function (grid, index, example, comparator, substitution) {\n      return $_tyr3yk5jfuw8q47.map(grid, function (row) {\n        var withinSpan = index > 0 && index < $_aylxzgmyjfuw8qmj.cellLength(row) && comparator($_aylxzgmyjfuw8qmj.getCellElement(row, index - 1), $_aylxzgmyjfuw8qmj.getCellElement(row, index));\n        var sub = withinSpan ? $_aylxzgmyjfuw8qmj.getCell(row, index) : $_ce5pyrkgjfuw8q5v.elementnew(substitution($_aylxzgmyjfuw8qmj.getCellElement(row, example), comparator), true);\n        return $_aylxzgmyjfuw8qmj.addCell(row, index, sub);\n      });\n    };\n\n    var splitCellIntoColumns = function (grid, exampleRow, exampleCol, comparator, substitution) {\n      var index = exampleCol + 1;\n      return $_tyr3yk5jfuw8q47.map(grid, function (row, i) {\n        var isTargetCell = i === exampleRow;\n        var sub = isTargetCell ? $_ce5pyrkgjfuw8q5v.elementnew(substitution($_aylxzgmyjfuw8qmj.getCellElement(row, exampleCol), comparator), true) : $_aylxzgmyjfuw8qmj.getCell(row, exampleCol);\n        return $_aylxzgmyjfuw8qmj.addCell(row, index, sub);\n      });\n    };\n\n    var splitCellIntoRows = function (grid, exampleRow, exampleCol, comparator, substitution) {\n      var index = exampleRow + 1;\n      var before = grid.slice(0, index);\n      var after = grid.slice(index);\n      var between = $_aylxzgmyjfuw8qmj.mapCells(grid[exampleRow], function (ex, i) {\n        var isTargetCell = i === exampleCol;\n        return isTargetCell ? $_ce5pyrkgjfuw8q5v.elementnew(substitution(ex.element(), comparator), true) : ex;\n      });\n      return before.concat([between]).concat(after);\n    };\n\n    var deleteColumnsAt = function (grid, start, finish) {\n      var rows = $_tyr3yk5jfuw8q47.map(grid, function (row) {\n        var cells = row.cells().slice(0, start).concat(row.cells().slice(finish + 1));\n        return $_ce5pyrkgjfuw8q5v.rowcells(cells, row.section());\n      });\n      return $_tyr3yk5jfuw8q47.filter(rows, function (row) {\n        return row.cells().length > 0;\n      });\n    };\n\n    var deleteRowsAt = function (grid, start, finish) {\n      return grid.slice(0, start).concat(grid.slice(finish + 1));\n    };\n\n    var $_22uvfenejfuw8qpx = {\n      insertRowAt: insertRowAt,\n      insertColumnAt: insertColumnAt,\n      splitCellIntoColumns: splitCellIntoColumns,\n      splitCellIntoRows: splitCellIntoRows,\n      deleteRowsAt: deleteRowsAt,\n      deleteColumnsAt: deleteColumnsAt\n    };\n\n    var replaceIn = function (grid, targets, comparator, substitution) {\n      var isTarget = function (cell) {\n        return $_tyr3yk5jfuw8q47.exists(targets, function (target) {\n          return comparator(cell.element(), target.element());\n        });\n      };\n\n      return $_tyr3yk5jfuw8q47.map(grid, function (row) {\n        return $_aylxzgmyjfuw8qmj.mapCells(row, function (cell) {\n          return isTarget(cell) ? $_ce5pyrkgjfuw8q5v.elementnew(substitution(cell.element(), comparator), true) : cell;\n        });\n      });\n    };\n\n    var notStartRow = function (grid, rowIndex, colIndex, comparator) {\n      return $_aylxzgmyjfuw8qmj.getCellElement(grid[rowIndex], colIndex) !== undefined && rowIndex > 0 && comparator($_aylxzgmyjfuw8qmj.getCellElement(grid[rowIndex - 1], colIndex), $_aylxzgmyjfuw8qmj.getCellElement(grid[rowIndex], colIndex));\n    };\n\n    var notStartColumn = function (row, index, comparator) {\n      return index > 0 && comparator($_aylxzgmyjfuw8qmj.getCellElement(row, index - 1), $_aylxzgmyjfuw8qmj.getCellElement(row, index));\n    };\n\n    var replaceColumn = function (grid, index, comparator, substitution) {\n      var targets = $_tyr3yk5jfuw8q47.bind(grid, function (row, i) {\n        var alreadyAdded = notStartRow(grid, i, index, comparator) || notStartColumn(row, index, comparator);\n        return alreadyAdded ? [] : [$_aylxzgmyjfuw8qmj.getCell(row, index)];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n\n    var replaceRow = function (grid, index, comparator, substitution) {\n      var targetRow = grid[index];\n      var targets = $_tyr3yk5jfuw8q47.bind(targetRow.cells(), function (item, i) {\n        var alreadyAdded = notStartRow(grid, index, i, comparator) || notStartColumn(targetRow, i, comparator);\n        return alreadyAdded ? [] : [item];\n      });\n      return replaceIn(grid, targets, comparator, substitution);\n    };\n\n    var $_507pt2nfjfuw8qq2 = {\n      replaceColumn: replaceColumn,\n      replaceRow: replaceRow\n    };\n\n    var none$1 = function () {\n      return folder(function (n, o, l, m, r) {\n        return n();\n      });\n    };\n\n    var only = function (index) {\n      return folder(function (n, o, l, m, r) {\n        return o(index);\n      });\n    };\n\n    var left = function (index, next) {\n      return folder(function (n, o, l, m, r) {\n        return l(index, next);\n      });\n    };\n\n    var middle = function (prev, index, next) {\n      return folder(function (n, o, l, m, r) {\n        return m(prev, index, next);\n      });\n    };\n\n    var right = function (prev, index) {\n      return folder(function (n, o, l, m, r) {\n        return r(prev, index);\n      });\n    };\n\n    var folder = function (fold) {\n      return {\n        fold: fold\n      };\n    };\n\n    var $_17zkjbnijfuw8qqk = {\n      none: none$1,\n      only: only,\n      left: left,\n      middle: middle,\n      right: right\n    };\n\n    var neighbours$1 = function (input, index) {\n      if (input.length === 0) return $_17zkjbnijfuw8qqk.none();\n      if (input.length === 1) return $_17zkjbnijfuw8qqk.only(0);\n      if (index === 0) return $_17zkjbnijfuw8qqk.left(0, 1);\n      if (index === input.length - 1) return $_17zkjbnijfuw8qqk.right(index - 1, index);\n      if (index > 0 && index < input.length - 1) return $_17zkjbnijfuw8qqk.middle(index - 1, index, index + 1);\n      return $_17zkjbnijfuw8qqk.none();\n    };\n\n    var determine = function (input, column, step, tableSize) {\n      var result = input.slice(0);\n      var context = neighbours$1(input, column);\n\n      var zero = function (array) {\n        return $_tyr3yk5jfuw8q47.map(array, $_20nfr6k7jfuw8q4g.constant(0));\n      };\n\n      var onNone = $_20nfr6k7jfuw8q4g.constant(zero(result));\n\n      var onOnly = function (index) {\n        return tableSize.singleColumnWidth(result[index], step);\n      };\n\n      var onChange = function (index, next) {\n        if (step >= 0) {\n          var newNext = Math.max(tableSize.minCellWidth(), result[next] - step);\n          return zero(result.slice(0, index)).concat([step, newNext - result[next]]).concat(zero(result.slice(next + 1)));\n        } else {\n          var newThis = Math.max(tableSize.minCellWidth(), result[index] + step);\n          var diffx = result[index] - newThis;\n          return zero(result.slice(0, index)).concat([newThis - result[index], diffx]).concat(zero(result.slice(next + 1)));\n        }\n      };\n\n      var onLeft = onChange;\n\n      var onMiddle = function (prev, index, next) {\n        return onChange(index, next);\n      };\n\n      var onRight = function (prev, index) {\n        if (step >= 0) {\n          return zero(result.slice(0, index)).concat([step]);\n        } else {\n          var size = Math.max(tableSize.minCellWidth(), result[index] + step);\n          return zero(result.slice(0, index)).concat([size - result[index]]);\n        }\n      };\n\n      return context.fold(onNone, onOnly, onLeft, onMiddle, onRight);\n    };\n\n    var $_7b8knbnhjfuw8qqd = {\n      determine: determine\n    };\n\n    var getSpan$1 = function (cell, type) {\n      return $_3q82t2l5jfuw8q93.has(cell, type) && parseInt($_3q82t2l5jfuw8q93.get(cell, type), 10) > 1;\n    };\n\n    var hasColspan = function (cell) {\n      return getSpan$1(cell, 'colspan');\n    };\n\n    var hasRowspan = function (cell) {\n      return getSpan$1(cell, 'rowspan');\n    };\n\n    var getInt = function (element, property) {\n      return parseInt($_bfod2hlejfuw8qac.get(element, property), 10);\n    };\n\n    var $_63qtcvnkjfuw8qqu = {\n      hasColspan: hasColspan,\n      hasRowspan: hasRowspan,\n      minWidth: $_20nfr6k7jfuw8q4g.constant(10),\n      minHeight: $_20nfr6k7jfuw8q4g.constant(10),\n      getInt: getInt\n    };\n\n    var getRaw$1 = function (cell, property, getter) {\n      return $_bfod2hlejfuw8qac.getRaw(cell, property).fold(function () {\n        return getter(cell) + 'px';\n      }, function (raw) {\n        return raw;\n      });\n    };\n\n    var getRawW = function (cell) {\n      return getRaw$1(cell, 'width', $_by2skemajfuw8qhj.getPixelWidth);\n    };\n\n    var getRawH = function (cell) {\n      return getRaw$1(cell, 'height', $_by2skemajfuw8qhj.getHeight);\n    };\n\n    var getWidthFrom = function (warehouse, direction, getWidth, fallback, tableSize) {\n      var columns = $_9oko5pn1jfuw8qo0.columns(warehouse);\n      var backups = $_tyr3yk5jfuw8q47.map(columns, function (cellOption) {\n        return cellOption.map(direction.edge);\n      });\n      return $_tyr3yk5jfuw8q47.map(columns, function (cellOption, c) {\n        var columnCell = cellOption.filter($_20nfr6k7jfuw8q4g.not($_63qtcvnkjfuw8qqu.hasColspan));\n        return columnCell.fold(function () {\n          var deduced = $_fcnwwbn2jfuw8qoa.deduce(backups, c);\n          return fallback(deduced);\n        }, function (cell) {\n          return getWidth(cell, tableSize);\n        });\n      });\n    };\n\n    var getDeduced = function (deduced) {\n      return deduced.map(function (d) {\n        return d + 'px';\n      }).getOr('');\n    };\n\n    var getRawWidths = function (warehouse, direction) {\n      return getWidthFrom(warehouse, direction, getRawW, getDeduced);\n    };\n\n    var getPercentageWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, $_by2skemajfuw8qhj.getPercentageWidth, function (deduced) {\n        return deduced.fold(function () {\n          return tableSize.minCellWidth();\n        }, function (cellWidth) {\n          return cellWidth / tableSize.pixelWidth() * 100;\n        });\n      }, tableSize);\n    };\n\n    var getPixelWidths = function (warehouse, direction, tableSize) {\n      return getWidthFrom(warehouse, direction, $_by2skemajfuw8qhj.getPixelWidth, function (deduced) {\n        return deduced.getOrThunk(tableSize.minCellWidth);\n      }, tableSize);\n    };\n\n    var getHeightFrom = function (warehouse, direction, getHeight, fallback) {\n      var rows = $_9oko5pn1jfuw8qo0.rows(warehouse);\n      var backups = $_tyr3yk5jfuw8q47.map(rows, function (cellOption) {\n        return cellOption.map(direction.edge);\n      });\n      return $_tyr3yk5jfuw8q47.map(rows, function (cellOption, c) {\n        var rowCell = cellOption.filter($_20nfr6k7jfuw8q4g.not($_63qtcvnkjfuw8qqu.hasRowspan));\n        return rowCell.fold(function () {\n          var deduced = $_fcnwwbn2jfuw8qoa.deduce(backups, c);\n          return fallback(deduced);\n        }, function (cell) {\n          return getHeight(cell);\n        });\n      });\n    };\n\n    var getPixelHeights = function (warehouse, direction) {\n      return getHeightFrom(warehouse, direction, $_by2skemajfuw8qhj.getHeight, function (deduced) {\n        return deduced.getOrThunk($_63qtcvnkjfuw8qqu.minHeight);\n      });\n    };\n\n    var getRawHeights = function (warehouse, direction) {\n      return getHeightFrom(warehouse, direction, getRawH, getDeduced);\n    };\n\n    var $_694691njjfuw8qqm = {\n      getRawWidths: getRawWidths,\n      getPixelWidths: getPixelWidths,\n      getPercentageWidths: getPercentageWidths,\n      getPixelHeights: getPixelHeights,\n      getRawHeights: getRawHeights\n    };\n\n    var total = function (start, end, measures) {\n      var r = 0;\n\n      for (var i = start; i < end; i++) {\n        r += measures[i] !== undefined ? measures[i] : 0;\n      }\n\n      return r;\n    };\n\n    var recalculateWidth = function (warehouse, widths) {\n      var all = $_2ge24cldjfuw8qa3.justCells(warehouse);\n      return $_tyr3yk5jfuw8q47.map(all, function (cell) {\n        var width = total(cell.column(), cell.column() + cell.colspan(), widths);\n        return {\n          element: cell.element,\n          width: $_20nfr6k7jfuw8q4g.constant(width),\n          colspan: cell.colspan\n        };\n      });\n    };\n\n    var recalculateHeight = function (warehouse, heights) {\n      var all = $_2ge24cldjfuw8qa3.justCells(warehouse);\n      return $_tyr3yk5jfuw8q47.map(all, function (cell) {\n        var height = total(cell.row(), cell.row() + cell.rowspan(), heights);\n        return {\n          element: cell.element,\n          height: $_20nfr6k7jfuw8q4g.constant(height),\n          rowspan: cell.rowspan\n        };\n      });\n    };\n\n    var matchRowHeight = function (warehouse, heights) {\n      return $_tyr3yk5jfuw8q47.map(warehouse.all(), function (row, i) {\n        return {\n          element: row.element,\n          height: $_20nfr6k7jfuw8q4g.constant(heights[i])\n        };\n      });\n    };\n\n    var $_2ltb63nljfuw8qr5 = {\n      recalculateWidth: recalculateWidth,\n      recalculateHeight: recalculateHeight,\n      matchRowHeight: matchRowHeight\n    };\n\n    var percentageSize = function (width, element) {\n      var floatWidth = parseFloat(width);\n      var pixelWidth = $_fj252lmejfuw8qin.get(element);\n\n      var getCellDelta = function (delta) {\n        return delta / pixelWidth * 100;\n      };\n\n      var singleColumnWidth = function (width, _delta) {\n        return [100 - width];\n      };\n\n      var minCellWidth = function () {\n        return $_63qtcvnkjfuw8qqu.minWidth() / pixelWidth * 100;\n      };\n\n      var setTableWidth = function (table, _newWidths, delta) {\n        var total = floatWidth + delta;\n        $_by2skemajfuw8qhj.setPercentageWidth(table, total);\n      };\n\n      return {\n        width: $_20nfr6k7jfuw8q4g.constant(floatWidth),\n        pixelWidth: $_20nfr6k7jfuw8q4g.constant(pixelWidth),\n        getWidths: $_694691njjfuw8qqm.getPercentageWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: minCellWidth,\n        setElementWidth: $_by2skemajfuw8qhj.setPercentageWidth,\n        setTableWidth: setTableWidth\n      };\n    };\n\n    var pixelSize = function (width) {\n      var intWidth = parseInt(width, 10);\n      var getCellDelta = $_20nfr6k7jfuw8q4g.identity;\n\n      var singleColumnWidth = function (width, delta) {\n        var newNext = Math.max($_63qtcvnkjfuw8qqu.minWidth(), width + delta);\n        return [newNext - width];\n      };\n\n      var setTableWidth = function (table, newWidths, _delta) {\n        var total = $_tyr3yk5jfuw8q47.foldr(newWidths, function (b, a) {\n          return b + a;\n        }, 0);\n        $_by2skemajfuw8qhj.setPixelWidth(table, total);\n      };\n\n      return {\n        width: $_20nfr6k7jfuw8q4g.constant(intWidth),\n        pixelWidth: $_20nfr6k7jfuw8q4g.constant(intWidth),\n        getWidths: $_694691njjfuw8qqm.getPixelWidths,\n        getCellDelta: getCellDelta,\n        singleColumnWidth: singleColumnWidth,\n        minCellWidth: $_63qtcvnkjfuw8qqu.minWidth,\n        setElementWidth: $_by2skemajfuw8qhj.setPixelWidth,\n        setTableWidth: setTableWidth\n      };\n    };\n\n    var chooseSize = function (element, width) {\n      if ($_by2skemajfuw8qhj.percentageBasedSizeRegex().test(width)) {\n        var percentMatch = $_by2skemajfuw8qhj.percentageBasedSizeRegex().exec(width);\n        return percentageSize(percentMatch[1], element);\n      } else if ($_by2skemajfuw8qhj.pixelBasedSizeRegex().test(width)) {\n        var pixelMatch = $_by2skemajfuw8qhj.pixelBasedSizeRegex().exec(width);\n        return pixelSize(pixelMatch[1]);\n      } else {\n        var fallbackWidth = $_fj252lmejfuw8qin.get(element);\n        return pixelSize(fallbackWidth);\n      }\n    };\n\n    var getTableSize = function (element) {\n      var width = $_by2skemajfuw8qhj.getRawWidth(element);\n      return width.fold(function () {\n        var fallbackWidth = $_fj252lmejfuw8qin.get(element);\n        return pixelSize(fallbackWidth);\n      }, function (width) {\n        return chooseSize(element, width);\n      });\n    };\n\n    var $_2o9g1qnmjfuw8qrh = {\n      getTableSize: getTableSize\n    };\n\n    var getWarehouse$1 = function (list) {\n      return $_2ge24cldjfuw8qa3.generate(list);\n    };\n\n    var sumUp = function (newSize) {\n      return $_tyr3yk5jfuw8q47.foldr(newSize, function (b, a) {\n        return b + a;\n      }, 0);\n    };\n\n    var getTableWarehouse = function (table) {\n      var list = $_dy3x0nkfjfuw8q5l.fromTable(table);\n      return getWarehouse$1(list);\n    };\n\n    var adjustWidth = function (table, delta, index, direction) {\n      var tableSize = $_2o9g1qnmjfuw8qrh.getTableSize(table);\n      var step = tableSize.getCellDelta(delta);\n      var warehouse = getTableWarehouse(table);\n      var widths = tableSize.getWidths(warehouse, direction, tableSize);\n      var deltas = $_7b8knbnhjfuw8qqd.determine(widths, index, step, tableSize);\n      var newWidths = $_tyr3yk5jfuw8q47.map(deltas, function (dx, i) {\n        return dx + widths[i];\n      });\n      var newSizes = $_2ltb63nljfuw8qr5.recalculateWidth(warehouse, newWidths);\n      $_tyr3yk5jfuw8q47.each(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element(), cell.width());\n      });\n\n      if (index === warehouse.grid().columns() - 1) {\n        tableSize.setTableWidth(table, newWidths, step);\n      }\n    };\n\n    var adjustHeight = function (table, delta, index, direction) {\n      var warehouse = getTableWarehouse(table);\n      var heights = $_694691njjfuw8qqm.getPixelHeights(warehouse, direction);\n      var newHeights = $_tyr3yk5jfuw8q47.map(heights, function (dy, i) {\n        return index === i ? Math.max(delta + dy, $_63qtcvnkjfuw8qqu.minHeight()) : dy;\n      });\n      var newCellSizes = $_2ltb63nljfuw8qr5.recalculateHeight(warehouse, newHeights);\n      var newRowSizes = $_2ltb63nljfuw8qr5.matchRowHeight(warehouse, newHeights);\n      $_tyr3yk5jfuw8q47.each(newRowSizes, function (row) {\n        $_by2skemajfuw8qhj.setHeight(row.element(), row.height());\n      });\n      $_tyr3yk5jfuw8q47.each(newCellSizes, function (cell) {\n        $_by2skemajfuw8qhj.setHeight(cell.element(), cell.height());\n      });\n      var total = sumUp(newHeights);\n      $_by2skemajfuw8qhj.setHeight(table, total);\n    };\n\n    var adjustWidthTo = function (table, list, direction) {\n      var tableSize = $_2o9g1qnmjfuw8qrh.getTableSize(table);\n      var warehouse = getWarehouse$1(list);\n      var widths = tableSize.getWidths(warehouse, direction, tableSize);\n      var newSizes = $_2ltb63nljfuw8qr5.recalculateWidth(warehouse, widths);\n      $_tyr3yk5jfuw8q47.each(newSizes, function (cell) {\n        tableSize.setElementWidth(cell.element(), cell.width());\n      });\n      var total = $_tyr3yk5jfuw8q47.foldr(widths, function (b, a) {\n        return a + b;\n      }, 0);\n\n      if (newSizes.length > 0) {\n        tableSize.setElementWidth(table, total);\n      }\n    };\n\n    var $_cwciisngjfuw8qq6 = {\n      adjustWidth: adjustWidth,\n      adjustHeight: adjustHeight,\n      adjustWidthTo: adjustWidthTo\n    };\n\n    var prune = function (table) {\n      var cells = $_aqhz9okhjfuw8q5y.cells(table);\n      if (cells.length === 0) $_fl1deelhjfuw8qax.remove(table);\n    };\n\n    var outcome = $_5now9kbjfuw8q5e.immutable('grid', 'cursor');\n\n    var elementFromGrid = function (grid, row, column) {\n      return findIn(grid, row, column).orThunk(function () {\n        return findIn(grid, 0, 0);\n      });\n    };\n\n    var findIn = function (grid, row, column) {\n      return Option.from(grid[row]).bind(function (r) {\n        return Option.from(r.cells()[column]).bind(function (c) {\n          return Option.from(c.element());\n        });\n      });\n    };\n\n    var bundle = function (grid, row, column) {\n      return outcome(grid, findIn(grid, row, column));\n    };\n\n    var uniqueRows = function (details) {\n      return $_tyr3yk5jfuw8q47.foldl(details, function (rest, detail) {\n        return $_tyr3yk5jfuw8q47.exists(rest, function (currentDetail) {\n          return currentDetail.row() === detail.row();\n        }) ? rest : rest.concat([detail]);\n      }, []).sort(function (detailA, detailB) {\n        return detailA.row() - detailB.row();\n      });\n    };\n\n    var uniqueColumns = function (details) {\n      return $_tyr3yk5jfuw8q47.foldl(details, function (rest, detail) {\n        return $_tyr3yk5jfuw8q47.exists(rest, function (currentDetail) {\n          return currentDetail.column() === detail.column();\n        }) ? rest : rest.concat([detail]);\n      }, []).sort(function (detailA, detailB) {\n        return detailA.column() - detailB.column();\n      });\n    };\n\n    var insertRowBefore = function (grid, detail, comparator, genWrappers) {\n      var example = detail.row();\n      var targetIndex = detail.row();\n      var newGrid = $_22uvfenejfuw8qpx.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, targetIndex, detail.column());\n    };\n\n    var insertRowsBefore = function (grid, details, comparator, genWrappers) {\n      var example = details[0].row();\n      var targetIndex = details[0].row();\n      var rows = uniqueRows(details);\n      var newGrid = $_tyr3yk5jfuw8q47.foldl(rows, function (newGrid, _row) {\n        return $_22uvfenejfuw8qpx.insertRowAt(newGrid, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column());\n    };\n\n    var insertRowAfter = function (grid, detail, comparator, genWrappers) {\n      var example = detail.row();\n      var targetIndex = detail.row() + detail.rowspan();\n      var newGrid = $_22uvfenejfuw8qpx.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, targetIndex, detail.column());\n    };\n\n    var insertRowsAfter = function (grid, details, comparator, genWrappers) {\n      var rows = uniqueRows(details);\n      var example = rows[rows.length - 1].row();\n      var targetIndex = rows[rows.length - 1].row() + rows[rows.length - 1].rowspan();\n      var newGrid = $_tyr3yk5jfuw8q47.foldl(rows, function (newGrid, _row) {\n        return $_22uvfenejfuw8qpx.insertRowAt(newGrid, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, targetIndex, details[0].column());\n    };\n\n    var insertColumnBefore = function (grid, detail, comparator, genWrappers) {\n      var example = detail.column();\n      var targetIndex = detail.column();\n      var newGrid = $_22uvfenejfuw8qpx.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), targetIndex);\n    };\n\n    var insertColumnsBefore = function (grid, details, comparator, genWrappers) {\n      var columns = uniqueColumns(details);\n      var example = columns[0].column();\n      var targetIndex = columns[0].column();\n      var newGrid = $_tyr3yk5jfuw8q47.foldl(columns, function (newGrid, _row) {\n        return $_22uvfenejfuw8qpx.insertColumnAt(newGrid, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row(), targetIndex);\n    };\n\n    var insertColumnAfter = function (grid, detail, comparator, genWrappers) {\n      var example = detail.column();\n      var targetIndex = detail.column() + detail.colspan();\n      var newGrid = $_22uvfenejfuw8qpx.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), targetIndex);\n    };\n\n    var insertColumnsAfter = function (grid, details, comparator, genWrappers) {\n      var example = details[details.length - 1].column();\n      var targetIndex = details[details.length - 1].column() + details[details.length - 1].colspan();\n      var columns = uniqueColumns(details);\n      var newGrid = $_tyr3yk5jfuw8q47.foldl(columns, function (newGrid, _row) {\n        return $_22uvfenejfuw8qpx.insertColumnAt(newGrid, targetIndex, example, comparator, genWrappers.getOrInit);\n      }, grid);\n      return bundle(newGrid, details[0].row(), targetIndex);\n    };\n\n    var makeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = $_507pt2nfjfuw8qq2.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n\n    var makeColumnHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = $_507pt2nfjfuw8qq2.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n\n    var unmakeRowHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = $_507pt2nfjfuw8qq2.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n\n    var unmakeColumnHeader = function (grid, detail, comparator, genWrappers) {\n      var newGrid = $_507pt2nfjfuw8qq2.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n\n    var splitCellIntoColumns$1 = function (grid, detail, comparator, genWrappers) {\n      var newGrid = $_22uvfenejfuw8qpx.splitCellIntoColumns(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n\n    var splitCellIntoRows$1 = function (grid, detail, comparator, genWrappers) {\n      var newGrid = $_22uvfenejfuw8qpx.splitCellIntoRows(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n      return bundle(newGrid, detail.row(), detail.column());\n    };\n\n    var eraseColumns = function (grid, details, comparator, _genWrappers) {\n      var columns = uniqueColumns(details);\n      var newGrid = $_22uvfenejfuw8qpx.deleteColumnsAt(grid, columns[0].column(), columns[columns.length - 1].column());\n      var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n      return outcome(newGrid, cursor);\n    };\n\n    var eraseRows = function (grid, details, comparator, _genWrappers) {\n      var rows = uniqueRows(details);\n      var newGrid = $_22uvfenejfuw8qpx.deleteRowsAt(grid, rows[0].row(), rows[rows.length - 1].row());\n      var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n      return outcome(newGrid, cursor);\n    };\n\n    var mergeCells = function (grid, mergable, comparator, _genWrappers) {\n      var cells = mergable.cells();\n      $_ancl40mqjfuw8qkm.merge(cells);\n      var newGrid = $_72fqzkndjfuw8qpp.merge(grid, mergable.bounds(), comparator, $_20nfr6k7jfuw8q4g.constant(cells[0]));\n      return outcome(newGrid, Option.from(cells[0]));\n    };\n\n    var unmergeCells = function (grid, unmergable, comparator, genWrappers) {\n      var newGrid = $_tyr3yk5jfuw8q47.foldr(unmergable, function (b, cell) {\n        return $_72fqzkndjfuw8qpp.unmerge(b, cell, comparator, genWrappers.combine(cell));\n      }, grid);\n      return outcome(newGrid, Option.from(unmergable[0]));\n    };\n\n    var pasteCells = function (grid, pasteDetails, comparator, genWrappers) {\n      var gridify = function (table, generators) {\n        var list = $_dy3x0nkfjfuw8q5l.fromTable(table);\n        var wh = $_2ge24cldjfuw8qa3.generate(list);\n        return $_cw9o3smwjfuw8qm9.toGrid(wh, generators, true);\n      };\n\n      var gridB = gridify(pasteDetails.clipboard(), pasteDetails.generators());\n      var startAddress = $_ce5pyrkgjfuw8q5v.address(pasteDetails.row(), pasteDetails.column());\n      var mergedGrid = $_5jycvqnajfuw8qp5.merge(startAddress, grid, gridB, pasteDetails.generators(), comparator);\n      return mergedGrid.fold(function () {\n        return outcome(grid, Option.some(pasteDetails.element()));\n      }, function (nuGrid) {\n        var cursor = elementFromGrid(nuGrid, pasteDetails.row(), pasteDetails.column());\n        return outcome(nuGrid, cursor);\n      });\n    };\n\n    var gridifyRows = function (rows, generators, example) {\n      var pasteDetails = $_dy3x0nkfjfuw8q5l.fromPastedRows(rows, example);\n      var wh = $_2ge24cldjfuw8qa3.generate(pasteDetails);\n      return $_cw9o3smwjfuw8qm9.toGrid(wh, generators, true);\n    };\n\n    var pasteRowsBefore = function (grid, pasteDetails, comparator, genWrappers) {\n      var example = grid[pasteDetails.cells[0].row()];\n      var index = pasteDetails.cells[0].row();\n      var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n      var mergedGrid = $_5jycvqnajfuw8qp5.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n      return outcome(mergedGrid, cursor);\n    };\n\n    var pasteRowsAfter = function (grid, pasteDetails, comparator, genWrappers) {\n      var example = grid[pasteDetails.cells[0].row()];\n      var index = pasteDetails.cells[pasteDetails.cells.length - 1].row() + pasteDetails.cells[pasteDetails.cells.length - 1].rowspan();\n      var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n      var mergedGrid = $_5jycvqnajfuw8qp5.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n      var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n      return outcome(mergedGrid, cursor);\n    };\n\n    var resize = $_cwciisngjfuw8qq6.adjustWidthTo;\n    var $_2i21xzmmjfuw8qjg = {\n      insertRowBefore: $_dis709mtjfuw8qlp.run(insertRowBefore, $_dis709mtjfuw8qlp.onCell, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      insertRowsBefore: $_dis709mtjfuw8qlp.run(insertRowsBefore, $_dis709mtjfuw8qlp.onCells, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      insertRowAfter: $_dis709mtjfuw8qlp.run(insertRowAfter, $_dis709mtjfuw8qlp.onCell, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      insertRowsAfter: $_dis709mtjfuw8qlp.run(insertRowsAfter, $_dis709mtjfuw8qlp.onCells, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      insertColumnBefore: $_dis709mtjfuw8qlp.run(insertColumnBefore, $_dis709mtjfuw8qlp.onCell, resize, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      insertColumnsBefore: $_dis709mtjfuw8qlp.run(insertColumnsBefore, $_dis709mtjfuw8qlp.onCells, resize, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      insertColumnAfter: $_dis709mtjfuw8qlp.run(insertColumnAfter, $_dis709mtjfuw8qlp.onCell, resize, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      insertColumnsAfter: $_dis709mtjfuw8qlp.run(insertColumnsAfter, $_dis709mtjfuw8qlp.onCells, resize, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      splitCellIntoColumns: $_dis709mtjfuw8qlp.run(splitCellIntoColumns$1, $_dis709mtjfuw8qlp.onCell, resize, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      splitCellIntoRows: $_dis709mtjfuw8qlp.run(splitCellIntoRows$1, $_dis709mtjfuw8qlp.onCell, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      eraseColumns: $_dis709mtjfuw8qlp.run(eraseColumns, $_dis709mtjfuw8qlp.onCells, resize, prune, $_eoocrvmnjfuw8qk1.modification),\n      eraseRows: $_dis709mtjfuw8qlp.run(eraseRows, $_dis709mtjfuw8qlp.onCells, $_20nfr6k7jfuw8q4g.noop, prune, $_eoocrvmnjfuw8qk1.modification),\n      makeColumnHeader: $_dis709mtjfuw8qlp.run(makeColumnHeader, $_dis709mtjfuw8qlp.onCell, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.transform('row', 'th')),\n      unmakeColumnHeader: $_dis709mtjfuw8qlp.run(unmakeColumnHeader, $_dis709mtjfuw8qlp.onCell, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.transform(null, 'td')),\n      makeRowHeader: $_dis709mtjfuw8qlp.run(makeRowHeader, $_dis709mtjfuw8qlp.onCell, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.transform('col', 'th')),\n      unmakeRowHeader: $_dis709mtjfuw8qlp.run(unmakeRowHeader, $_dis709mtjfuw8qlp.onCell, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.transform(null, 'td')),\n      mergeCells: $_dis709mtjfuw8qlp.run(mergeCells, $_dis709mtjfuw8qlp.onMergable, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.merging),\n      unmergeCells: $_dis709mtjfuw8qlp.run(unmergeCells, $_dis709mtjfuw8qlp.onUnmergable, resize, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.merging),\n      pasteCells: $_dis709mtjfuw8qlp.run(pasteCells, $_dis709mtjfuw8qlp.onPaste, resize, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      pasteRowsBefore: $_dis709mtjfuw8qlp.run(pasteRowsBefore, $_dis709mtjfuw8qlp.onPasteRows, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification),\n      pasteRowsAfter: $_dis709mtjfuw8qlp.run(pasteRowsAfter, $_dis709mtjfuw8qlp.onPasteRows, $_20nfr6k7jfuw8q4g.noop, $_20nfr6k7jfuw8q4g.noop, $_eoocrvmnjfuw8qk1.modification)\n    };\n\n    var getBody$1 = function (editor) {\n      return $_xbeoqkkjfuw8q73.fromDom(editor.getBody());\n    };\n\n    var getIsRoot = function (editor) {\n      return function (element) {\n        return $_e8rn66kojfuw8q7n.eq(element, getBody$1(editor));\n      };\n    };\n\n    var removePxSuffix = function (size) {\n      return size ? size.replace(/px$/, '') : '';\n    };\n\n    var addSizeSuffix = function (size) {\n      if (/^[0-9]+$/.test(size)) {\n        size += 'px';\n      }\n\n      return size;\n    };\n\n    var $_5xkhf2nnjfuw8qrq = {\n      getBody: getBody$1,\n      getIsRoot: getIsRoot,\n      addSizeSuffix: addSizeSuffix,\n      removePxSuffix: removePxSuffix\n    };\n\n    var onDirection = function (isLtr, isRtl) {\n      return function (element) {\n        return getDirection(element) === 'rtl' ? isRtl : isLtr;\n      };\n    };\n\n    var getDirection = function (element) {\n      return $_bfod2hlejfuw8qac.get(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var $_a5xia4npjfuw8qs0 = {\n      onDirection: onDirection,\n      getDirection: getDirection\n    };\n    var ltr$1 = {\n      isRtl: $_20nfr6k7jfuw8q4g.constant(false)\n    };\n    var rtl$1 = {\n      isRtl: $_20nfr6k7jfuw8q4g.constant(true)\n    };\n\n    var directionAt = function (element) {\n      var dir = $_a5xia4npjfuw8qs0.getDirection(element);\n      return dir === 'rtl' ? rtl$1 : ltr$1;\n    };\n\n    var $_4xd1udnojfuw8qrw = {\n      directionAt: directionAt\n    };\n    var defaultTableToolbar = ['tableprops', 'tabledelete', '|', 'tableinsertrowbefore', 'tableinsertrowafter', 'tabledeleterow', '|', 'tableinsertcolbefore', 'tableinsertcolafter', 'tabledeletecol'];\n    var defaultStyles = {\n      'border-collapse': 'collapse',\n      'width': '100%'\n    };\n    var defaultAttributes = {\n      border: '1'\n    };\n\n    var getDefaultAttributes = function (editor) {\n      return editor.getParam('table_default_attributes', defaultAttributes, 'object');\n    };\n\n    var getDefaultStyles = function (editor) {\n      return editor.getParam('table_default_styles', defaultStyles, 'object');\n    };\n\n    var hasTableResizeBars = function (editor) {\n      return editor.getParam('table_resize_bars', true, 'boolean');\n    };\n\n    var hasTabNavigation = function (editor) {\n      return editor.getParam('table_tab_navigation', true, 'boolean');\n    };\n\n    var hasAdvancedCellTab = function (editor) {\n      return editor.getParam('table_cell_advtab', true, 'boolean');\n    };\n\n    var hasAdvancedRowTab = function (editor) {\n      return editor.getParam('table_row_advtab', true, 'boolean');\n    };\n\n    var hasAdvancedTableTab = function (editor) {\n      return editor.getParam('table_advtab', true, 'boolean');\n    };\n\n    var hasAppearanceOptions = function (editor) {\n      return editor.getParam('table_appearance_options', true, 'boolean');\n    };\n\n    var hasTableGrid = function (editor) {\n      return editor.getParam('table_grid', true, 'boolean');\n    };\n\n    var shouldStyleWithCss = function (editor) {\n      return editor.getParam('table_style_by_css', false, 'boolean');\n    };\n\n    var getCellClassList = function (editor) {\n      return editor.getParam('table_cell_class_list', [], 'array');\n    };\n\n    var getRowClassList = function (editor) {\n      return editor.getParam('table_row_class_list', [], 'array');\n    };\n\n    var getTableClassList = function (editor) {\n      return editor.getParam('table_class_list', [], 'array');\n    };\n\n    var getColorPickerCallback = function (editor) {\n      return editor.getParam('color_picker_callback');\n    };\n\n    var isPixelsForced = function (editor) {\n      return editor.getParam('table_responsive_width') === false;\n    };\n\n    var getCloneElements = function (editor) {\n      var cloneElements = editor.getParam('table_clone_elements');\n\n      if ($_g6mvnrk8jfuw8q4k.isString(cloneElements)) {\n        return Option.some(cloneElements.split(/[ ,]/));\n      } else if (Array.isArray(cloneElements)) {\n        return Option.some(cloneElements);\n      } else {\n        return Option.none();\n      }\n    };\n\n    var hasObjectResizing = function (editor) {\n      var objectResizing = editor.getParam('object_resizing', true);\n      return objectResizing === 'table' || objectResizing;\n    };\n\n    var getToolbar = function (editor) {\n      var toolbar = editor.getParam('table_toolbar', defaultTableToolbar);\n\n      if (toolbar === '' || toolbar === false) {\n        return [];\n      } else if ($_g6mvnrk8jfuw8q4k.isString(toolbar)) {\n        return toolbar.split(/[ ,]/);\n      } else if ($_g6mvnrk8jfuw8q4k.isArray(toolbar)) {\n        return toolbar;\n      } else {\n        return [];\n      }\n    };\n\n    var fireNewRow = function (editor, row) {\n      return editor.fire('newrow', {\n        node: row\n      });\n    };\n\n    var fireNewCell = function (editor, cell) {\n      return editor.fire('newcell', {\n        node: cell\n      });\n    };\n\n    var TableActions = function (editor, lazyWire) {\n      var isTableBody = function (editor) {\n        return $_a8gk30l6jfuw8q9c.name($_5xkhf2nnjfuw8qrq.getBody(editor)) === 'table';\n      };\n\n      var lastRowGuard = function (table) {\n        var size = $_b452wimljfuw8qjd.getGridSize(table);\n        return isTableBody(editor) === false || size.rows() > 1;\n      };\n\n      var lastColumnGuard = function (table) {\n        var size = $_b452wimljfuw8qjd.getGridSize(table);\n        return isTableBody(editor) === false || size.columns() > 1;\n      };\n\n      var cloneFormats = getCloneElements(editor);\n\n      var execute = function (operation, guard, mutate, lazyWire) {\n        return function (table, target) {\n          var dataStyleCells = $_6c9d0hl7jfuw8q9d.descendants(table, 'td[data-mce-style],th[data-mce-style]');\n          $_tyr3yk5jfuw8q47.each(dataStyleCells, function (cell) {\n            $_3q82t2l5jfuw8q93.remove(cell, 'data-mce-style');\n          });\n          var wire = lazyWire();\n          var doc = $_xbeoqkkjfuw8q73.fromDom(editor.getDoc());\n          var direction = TableDirection($_4xd1udnojfuw8qrw.directionAt);\n          var generators = $_5ohg1eljjfuw8qb4.cellOperations(mutate, doc, cloneFormats);\n          return guard(table) ? operation(wire, table, target, generators, direction).bind(function (result) {\n            $_tyr3yk5jfuw8q47.each(result.newRows(), function (row) {\n              fireNewRow(editor, row.dom());\n            });\n            $_tyr3yk5jfuw8q47.each(result.newCells(), function (cell) {\n              fireNewCell(editor, cell.dom());\n            });\n            return result.cursor().map(function (cell) {\n              var rng = editor.dom.createRng();\n              rng.setStart(cell.dom(), 0);\n              rng.setEnd(cell.dom(), 0);\n              return rng;\n            });\n          }) : Option.none();\n        };\n      };\n\n      var deleteRow = execute($_2i21xzmmjfuw8qjg.eraseRows, lastRowGuard, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var deleteColumn = execute($_2i21xzmmjfuw8qjg.eraseColumns, lastColumnGuard, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var insertRowsBefore = execute($_2i21xzmmjfuw8qjg.insertRowsBefore, $_20nfr6k7jfuw8q4g.always, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var insertRowsAfter = execute($_2i21xzmmjfuw8qjg.insertRowsAfter, $_20nfr6k7jfuw8q4g.always, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var insertColumnsBefore = execute($_2i21xzmmjfuw8qjg.insertColumnsBefore, $_20nfr6k7jfuw8q4g.always, $_57e49gm9jfuw8qhh.halve, lazyWire);\n      var insertColumnsAfter = execute($_2i21xzmmjfuw8qjg.insertColumnsAfter, $_20nfr6k7jfuw8q4g.always, $_57e49gm9jfuw8qhh.halve, lazyWire);\n      var mergeCells = execute($_2i21xzmmjfuw8qjg.mergeCells, $_20nfr6k7jfuw8q4g.always, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var unmergeCells = execute($_2i21xzmmjfuw8qjg.unmergeCells, $_20nfr6k7jfuw8q4g.always, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var pasteRowsBefore = execute($_2i21xzmmjfuw8qjg.pasteRowsBefore, $_20nfr6k7jfuw8q4g.always, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var pasteRowsAfter = execute($_2i21xzmmjfuw8qjg.pasteRowsAfter, $_20nfr6k7jfuw8q4g.always, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      var pasteCells = execute($_2i21xzmmjfuw8qjg.pasteCells, $_20nfr6k7jfuw8q4g.always, $_20nfr6k7jfuw8q4g.noop, lazyWire);\n      return {\n        deleteRow: deleteRow,\n        deleteColumn: deleteColumn,\n        insertRowsBefore: insertRowsBefore,\n        insertRowsAfter: insertRowsAfter,\n        insertColumnsBefore: insertColumnsBefore,\n        insertColumnsAfter: insertColumnsAfter,\n        mergeCells: mergeCells,\n        unmergeCells: unmergeCells,\n        pasteRowsBefore: pasteRowsBefore,\n        pasteRowsAfter: pasteRowsAfter,\n        pasteCells: pasteCells\n      };\n    };\n\n    var copyRows = function (table, target, generators) {\n      var list = $_dy3x0nkfjfuw8q5l.fromTable(table);\n      var house = $_2ge24cldjfuw8qa3.generate(list);\n      var details = $_dis709mtjfuw8qlp.onCells(house, target);\n      return details.map(function (selectedCells) {\n        var grid = $_cw9o3smwjfuw8qm9.toGrid(house, generators, false);\n        var slicedGrid = grid.slice(selectedCells[0].row(), selectedCells[selectedCells.length - 1].row() + selectedCells[selectedCells.length - 1].rowspan());\n        var slicedDetails = $_dis709mtjfuw8qlp.toDetailList(slicedGrid, generators);\n        return $_c9mejomzjfuw8qmn.copy(slicedDetails);\n      });\n    };\n\n    var $_8a78aqntjfuw8qsp = {\n      copyRows: copyRows\n    };\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getTDTHOverallStyle = function (dom, elm, name) {\n      var cells = dom.select('td,th', elm);\n      var firstChildStyle;\n\n      var checkChildren = function (firstChildStyle, elms) {\n        for (var i = 0; i < elms.length; i++) {\n          var currentStyle = dom.getStyle(elms[i], name);\n\n          if (typeof firstChildStyle === 'undefined') {\n            firstChildStyle = currentStyle;\n          }\n\n          if (firstChildStyle !== currentStyle) {\n            return '';\n          }\n        }\n\n        return firstChildStyle;\n      };\n\n      firstChildStyle = checkChildren(firstChildStyle, cells);\n      return firstChildStyle;\n    };\n\n    var applyAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('align' + name, {}, elm);\n      }\n    };\n\n    var applyVAlign = function (editor, elm, name) {\n      if (name) {\n        editor.formatter.apply('valign' + name, {}, elm);\n      }\n    };\n\n    var unApplyAlign = function (editor, elm) {\n      global$2.each('left center right'.split(' '), function (name) {\n        editor.formatter.remove('align' + name, {}, elm);\n      });\n    };\n\n    var unApplyVAlign = function (editor, elm) {\n      global$2.each('top middle bottom'.split(' '), function (name) {\n        editor.formatter.remove('valign' + name, {}, elm);\n      });\n    };\n\n    var $_ch6rvmnwjfuw8qt7 = {\n      applyAlign: applyAlign,\n      applyVAlign: applyVAlign,\n      unApplyAlign: unApplyAlign,\n      unApplyVAlign: unApplyVAlign,\n      getTDTHOverallStyle: getTDTHOverallStyle\n    };\n\n    var buildListItems = function (inputList, itemCallback, startItems) {\n      var appendItems = function (values, output) {\n        output = output || [];\n        global$2.each(values, function (item) {\n          var menuItem = {\n            text: item.text || item.title\n          };\n\n          if (item.menu) {\n            menuItem.menu = appendItems(item.menu);\n          } else {\n            menuItem.value = item.value;\n\n            if (itemCallback) {\n              itemCallback(menuItem);\n            }\n          }\n\n          output.push(menuItem);\n        });\n        return output;\n      };\n\n      return appendItems(inputList, startItems || []);\n    };\n\n    var updateStyleField = function (editor, evt) {\n      var dom = editor.dom;\n      var rootControl = evt.control.rootControl;\n      var data = rootControl.toJSON();\n      var css = dom.parseStyle(data.style);\n\n      if (evt.control.name() === 'style') {\n        rootControl.find('#borderStyle').value(css['border-style'] || '')[0].fire('select');\n        rootControl.find('#borderColor').value(css['border-color'] || '')[0].fire('change');\n        rootControl.find('#backgroundColor').value(css['background-color'] || '')[0].fire('change');\n        rootControl.find('#width').value(css.width || '').fire('change');\n        rootControl.find('#height').value(css.height || '').fire('change');\n      } else {\n        css['border-style'] = data.borderStyle;\n        css['border-color'] = data.borderColor;\n        css['background-color'] = data.backgroundColor;\n        css.width = data.width ? $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.width) : '';\n        css.height = data.height ? $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.height) : '';\n      }\n\n      rootControl.find('#style').value(dom.serializeStyle(dom.parseStyle(dom.serializeStyle(css))));\n    };\n\n    var extractAdvancedStyles = function (dom, elm) {\n      var css = dom.parseStyle(dom.getAttrib(elm, 'style'));\n      var data = {};\n\n      if (css['border-style']) {\n        data.borderStyle = css['border-style'];\n      }\n\n      if (css['border-color']) {\n        data.borderColor = css['border-color'];\n      }\n\n      if (css['background-color']) {\n        data.backgroundColor = css['background-color'];\n      }\n\n      data.style = dom.serializeStyle(css);\n      return data;\n    };\n\n    var createStyleForm = function (editor) {\n      var createColorPickAction = function () {\n        var colorPickerCallback = getColorPickerCallback(editor);\n\n        if (colorPickerCallback) {\n          return function (evt) {\n            return colorPickerCallback.call(editor, function (value) {\n              evt.control.value(value).fire('change');\n            }, evt.control.value());\n          };\n        }\n      };\n\n      return {\n        title: 'Advanced',\n        type: 'form',\n        defaults: {\n          onchange: $_20nfr6k7jfuw8q4g.curry(updateStyleField, editor)\n        },\n        items: [{\n          label: 'Style',\n          name: 'style',\n          type: 'textbox'\n        }, {\n          type: 'form',\n          padding: 0,\n          formItemDefaults: {\n            layout: 'grid',\n            alignH: ['start', 'right']\n          },\n          defaults: {\n            size: 7\n          },\n          items: [{\n            label: 'Border style',\n            type: 'listbox',\n            name: 'borderStyle',\n            width: 90,\n            onselect: $_20nfr6k7jfuw8q4g.curry(updateStyleField, editor),\n            values: [{\n              text: 'Select...',\n              value: ''\n            }, {\n              text: 'Solid',\n              value: 'solid'\n            }, {\n              text: 'Dotted',\n              value: 'dotted'\n            }, {\n              text: 'Dashed',\n              value: 'dashed'\n            }, {\n              text: 'Double',\n              value: 'double'\n            }, {\n              text: 'Groove',\n              value: 'groove'\n            }, {\n              text: 'Ridge',\n              value: 'ridge'\n            }, {\n              text: 'Inset',\n              value: 'inset'\n            }, {\n              text: 'Outset',\n              value: 'outset'\n            }, {\n              text: 'None',\n              value: 'none'\n            }, {\n              text: 'Hidden',\n              value: 'hidden'\n            }]\n          }, {\n            label: 'Border color',\n            type: 'colorbox',\n            name: 'borderColor',\n            onaction: createColorPickAction()\n          }, {\n            label: 'Background color',\n            type: 'colorbox',\n            name: 'backgroundColor',\n            onaction: createColorPickAction()\n          }]\n        }]\n      };\n    };\n\n    var $_2fnzp5nxjfuw8qt9 = {\n      createStyleForm: createStyleForm,\n      buildListItems: buildListItems,\n      updateStyleField: updateStyleField,\n      extractAdvancedStyles: extractAdvancedStyles\n    };\n\n    var updateStyles = function (elm, cssText) {\n      delete elm.dataset.mceStyle;\n      elm.style.cssText += ';' + cssText;\n    };\n\n    var extractDataFromElement = function (editor, elm) {\n      var dom = editor.dom;\n      var data = {\n        width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        scope: dom.getAttrib(elm, 'scope'),\n        class: dom.getAttrib(elm, 'class'),\n        type: elm.nodeName.toLowerCase(),\n        style: '',\n        align: '',\n        valign: ''\n      };\n      global$2.each('left center right'.split(' '), function (name) {\n        if (editor.formatter.matchNode(elm, 'align' + name)) {\n          data.align = name;\n        }\n      });\n      global$2.each('top middle bottom'.split(' '), function (name) {\n        if (editor.formatter.matchNode(elm, 'valign' + name)) {\n          data.valign = name;\n        }\n      });\n\n      if (hasAdvancedCellTab(editor)) {\n        global$2.extend(data, $_2fnzp5nxjfuw8qt9.extractAdvancedStyles(dom, elm));\n      }\n\n      return data;\n    };\n\n    var onSubmitCellForm = function (editor, cells, evt) {\n      var dom = editor.dom;\n      var data;\n\n      function setAttrib(elm, name, value) {\n        if (value) {\n          dom.setAttrib(elm, name, value);\n        }\n      }\n\n      function setStyle(elm, name, value) {\n        if (value) {\n          dom.setStyle(elm, name, value);\n        }\n      }\n\n      $_2fnzp5nxjfuw8qt9.updateStyleField(editor, evt);\n      data = evt.control.rootControl.toJSON();\n      editor.undoManager.transact(function () {\n        global$2.each(cells, function (cellElm) {\n          setAttrib(cellElm, 'scope', data.scope);\n\n          if (cells.length === 1) {\n            setAttrib(cellElm, 'style', data.style);\n          } else {\n            updateStyles(cellElm, data.style);\n          }\n\n          setAttrib(cellElm, 'class', data.class);\n          setStyle(cellElm, 'width', $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.width));\n          setStyle(cellElm, 'height', $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.height));\n\n          if (data.type && cellElm.nodeName.toLowerCase() !== data.type) {\n            cellElm = dom.rename(cellElm, data.type);\n          }\n\n          if (cells.length === 1) {\n            $_ch6rvmnwjfuw8qt7.unApplyAlign(editor, cellElm);\n            $_ch6rvmnwjfuw8qt7.unApplyVAlign(editor, cellElm);\n          }\n\n          if (data.align) {\n            $_ch6rvmnwjfuw8qt7.applyAlign(editor, cellElm, data.align);\n          }\n\n          if (data.valign) {\n            $_ch6rvmnwjfuw8qt7.applyVAlign(editor, cellElm, data.valign);\n          }\n        });\n        editor.focus();\n      });\n    };\n\n    var open = function (editor) {\n      var cellElm,\n          data,\n          classListCtrl,\n          cells = [];\n      cells = editor.dom.select('td[data-mce-selected],th[data-mce-selected]');\n      cellElm = editor.dom.getParent(editor.selection.getStart(), 'td,th');\n\n      if (!cells.length && cellElm) {\n        cells.push(cellElm);\n      }\n\n      cellElm = cellElm || cells[0];\n\n      if (!cellElm) {\n        return;\n      }\n\n      if (cells.length > 1) {\n        data = {\n          width: '',\n          height: '',\n          scope: '',\n          class: '',\n          align: '',\n          valign: '',\n          style: '',\n          type: cellElm.nodeName.toLowerCase()\n        };\n      } else {\n        data = extractDataFromElement(editor, cellElm);\n      }\n\n      if (getCellClassList(editor).length > 0) {\n        classListCtrl = {\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          values: $_2fnzp5nxjfuw8qt9.buildListItems(getCellClassList(editor), function (item) {\n            if (item.value) {\n              item.textStyle = function () {\n                return editor.formatter.getCssText({\n                  block: 'td',\n                  classes: [item.value]\n                });\n              };\n            }\n          })\n        };\n      }\n\n      var generalCellForm = {\n        type: 'form',\n        layout: 'flex',\n        direction: 'column',\n        labelGapCalc: 'children',\n        padding: 0,\n        items: [{\n          type: 'form',\n          layout: 'grid',\n          columns: 2,\n          labelGapCalc: false,\n          padding: 0,\n          defaults: {\n            type: 'textbox',\n            maxWidth: 50\n          },\n          items: [{\n            label: 'Width',\n            name: 'width',\n            onchange: $_20nfr6k7jfuw8q4g.curry($_2fnzp5nxjfuw8qt9.updateStyleField, editor)\n          }, {\n            label: 'Height',\n            name: 'height',\n            onchange: $_20nfr6k7jfuw8q4g.curry($_2fnzp5nxjfuw8qt9.updateStyleField, editor)\n          }, {\n            label: 'Cell type',\n            name: 'type',\n            type: 'listbox',\n            text: 'None',\n            minWidth: 90,\n            maxWidth: null,\n            values: [{\n              text: 'Cell',\n              value: 'td'\n            }, {\n              text: 'Header cell',\n              value: 'th'\n            }]\n          }, {\n            label: 'Scope',\n            name: 'scope',\n            type: 'listbox',\n            text: 'None',\n            minWidth: 90,\n            maxWidth: null,\n            values: [{\n              text: 'None',\n              value: ''\n            }, {\n              text: 'Row',\n              value: 'row'\n            }, {\n              text: 'Column',\n              value: 'col'\n            }, {\n              text: 'Row group',\n              value: 'rowgroup'\n            }, {\n              text: 'Column group',\n              value: 'colgroup'\n            }]\n          }, {\n            label: 'H Align',\n            name: 'align',\n            type: 'listbox',\n            text: 'None',\n            minWidth: 90,\n            maxWidth: null,\n            values: [{\n              text: 'None',\n              value: ''\n            }, {\n              text: 'Left',\n              value: 'left'\n            }, {\n              text: 'Center',\n              value: 'center'\n            }, {\n              text: 'Right',\n              value: 'right'\n            }]\n          }, {\n            label: 'V Align',\n            name: 'valign',\n            type: 'listbox',\n            text: 'None',\n            minWidth: 90,\n            maxWidth: null,\n            values: [{\n              text: 'None',\n              value: ''\n            }, {\n              text: 'Top',\n              value: 'top'\n            }, {\n              text: 'Middle',\n              value: 'middle'\n            }, {\n              text: 'Bottom',\n              value: 'bottom'\n            }]\n          }]\n        }, classListCtrl]\n      };\n\n      if (hasAdvancedCellTab(editor)) {\n        editor.windowManager.open({\n          title: 'Cell properties',\n          bodyType: 'tabpanel',\n          data: data,\n          body: [{\n            title: 'General',\n            type: 'form',\n            items: generalCellForm\n          }, $_2fnzp5nxjfuw8qt9.createStyleForm(editor)],\n          onsubmit: $_20nfr6k7jfuw8q4g.curry(onSubmitCellForm, editor, cells)\n        });\n      } else {\n        editor.windowManager.open({\n          title: 'Cell properties',\n          data: data,\n          body: generalCellForm,\n          onsubmit: $_20nfr6k7jfuw8q4g.curry(onSubmitCellForm, editor, cells)\n        });\n      }\n    };\n\n    var $_48j9iinvjfuw8qsu = {\n      open: open\n    };\n\n    var extractDataFromElement$1 = function (editor, elm) {\n      var dom = editor.dom;\n      var data = {\n        height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n        scope: dom.getAttrib(elm, 'scope'),\n        class: dom.getAttrib(elm, 'class'),\n        align: '',\n        style: '',\n        type: elm.parentNode.nodeName.toLowerCase()\n      };\n      global$2.each('left center right'.split(' '), function (name) {\n        if (editor.formatter.matchNode(elm, 'align' + name)) {\n          data.align = name;\n        }\n      });\n\n      if (hasAdvancedRowTab(editor)) {\n        global$2.extend(data, $_2fnzp5nxjfuw8qt9.extractAdvancedStyles(dom, elm));\n      }\n\n      return data;\n    };\n\n    var switchRowType = function (dom, rowElm, toType) {\n      var tableElm = dom.getParent(rowElm, 'table');\n      var oldParentElm = rowElm.parentNode;\n      var parentElm = dom.select(toType, tableElm)[0];\n\n      if (!parentElm) {\n        parentElm = dom.create(toType);\n\n        if (tableElm.firstChild) {\n          if (tableElm.firstChild.nodeName === 'CAPTION') {\n            dom.insertAfter(parentElm, tableElm.firstChild);\n          } else {\n            tableElm.insertBefore(parentElm, tableElm.firstChild);\n          }\n        } else {\n          tableElm.appendChild(parentElm);\n        }\n      }\n\n      parentElm.appendChild(rowElm);\n\n      if (!oldParentElm.hasChildNodes()) {\n        dom.remove(oldParentElm);\n      }\n    };\n\n    function onSubmitRowForm(editor, rows, oldData, evt) {\n      var dom = editor.dom;\n\n      function setAttrib(elm, name, value) {\n        if (value) {\n          dom.setAttrib(elm, name, value);\n        }\n      }\n\n      function setStyle(elm, name, value) {\n        if (value) {\n          dom.setStyle(elm, name, value);\n        }\n      }\n\n      $_2fnzp5nxjfuw8qt9.updateStyleField(editor, evt);\n      var data = evt.control.rootControl.toJSON();\n      editor.undoManager.transact(function () {\n        global$2.each(rows, function (rowElm) {\n          setAttrib(rowElm, 'scope', data.scope);\n          setAttrib(rowElm, 'style', data.style);\n          setAttrib(rowElm, 'class', data.class);\n          setStyle(rowElm, 'height', $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.height));\n\n          if (data.type !== rowElm.parentNode.nodeName.toLowerCase()) {\n            switchRowType(editor.dom, rowElm, data.type);\n          }\n\n          if (data.align !== oldData.align) {\n            $_ch6rvmnwjfuw8qt7.unApplyAlign(editor, rowElm);\n            $_ch6rvmnwjfuw8qt7.applyAlign(editor, rowElm, data.align);\n          }\n        });\n        editor.focus();\n      });\n    }\n\n    var open$1 = function (editor) {\n      var dom = editor.dom;\n      var tableElm, cellElm, rowElm, classListCtrl, data;\n      var rows = [];\n      var generalRowForm;\n      tableElm = dom.getParent(editor.selection.getStart(), 'table');\n      cellElm = dom.getParent(editor.selection.getStart(), 'td,th');\n      global$2.each(tableElm.rows, function (row) {\n        global$2.each(row.cells, function (cell) {\n          if (dom.getAttrib(cell, 'data-mce-selected') || cell === cellElm) {\n            rows.push(row);\n            return false;\n          }\n        });\n      });\n      rowElm = rows[0];\n\n      if (!rowElm) {\n        return;\n      }\n\n      if (rows.length > 1) {\n        data = {\n          height: '',\n          scope: '',\n          style: '',\n          class: '',\n          align: '',\n          type: rowElm.parentNode.nodeName.toLowerCase()\n        };\n      } else {\n        data = extractDataFromElement$1(editor, rowElm);\n      }\n\n      if (getRowClassList(editor).length > 0) {\n        classListCtrl = {\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          values: $_2fnzp5nxjfuw8qt9.buildListItems(getRowClassList(editor), function (item) {\n            if (item.value) {\n              item.textStyle = function () {\n                return editor.formatter.getCssText({\n                  block: 'tr',\n                  classes: [item.value]\n                });\n              };\n            }\n          })\n        };\n      }\n\n      generalRowForm = {\n        type: 'form',\n        columns: 2,\n        padding: 0,\n        defaults: {\n          type: 'textbox'\n        },\n        items: [{\n          type: 'listbox',\n          name: 'type',\n          label: 'Row type',\n          text: 'Header',\n          maxWidth: null,\n          values: [{\n            text: 'Header',\n            value: 'thead'\n          }, {\n            text: 'Body',\n            value: 'tbody'\n          }, {\n            text: 'Footer',\n            value: 'tfoot'\n          }]\n        }, {\n          type: 'listbox',\n          name: 'align',\n          label: 'Alignment',\n          text: 'None',\n          maxWidth: null,\n          values: [{\n            text: 'None',\n            value: ''\n          }, {\n            text: 'Left',\n            value: 'left'\n          }, {\n            text: 'Center',\n            value: 'center'\n          }, {\n            text: 'Right',\n            value: 'right'\n          }]\n        }, {\n          label: 'Height',\n          name: 'height'\n        }, classListCtrl]\n      };\n\n      if (hasAdvancedRowTab(editor)) {\n        editor.windowManager.open({\n          title: 'Row properties',\n          data: data,\n          bodyType: 'tabpanel',\n          body: [{\n            title: 'General',\n            type: 'form',\n            items: generalRowForm\n          }, $_2fnzp5nxjfuw8qt9.createStyleForm(editor)],\n          onsubmit: $_20nfr6k7jfuw8q4g.curry(onSubmitRowForm, editor, rows, data)\n        });\n      } else {\n        editor.windowManager.open({\n          title: 'Row properties',\n          data: data,\n          body: generalRowForm,\n          onsubmit: $_20nfr6k7jfuw8q4g.curry(onSubmitRowForm, editor, rows, data)\n        });\n      }\n    };\n\n    var $_cshv4qnyjfuw8qtf = {\n      open: open$1\n    };\n    var global$3 = tinymce.util.Tools.resolve('tinymce.Env');\n    var DefaultRenderOptions = {\n      styles: {\n        'border-collapse': 'collapse',\n        width: '100%'\n      },\n      attributes: {\n        border: '1'\n      },\n      percentages: true\n    };\n\n    var makeTable = function () {\n      return $_xbeoqkkjfuw8q73.fromTag('table');\n    };\n\n    var tableBody = function () {\n      return $_xbeoqkkjfuw8q73.fromTag('tbody');\n    };\n\n    var tableRow = function () {\n      return $_xbeoqkkjfuw8q73.fromTag('tr');\n    };\n\n    var tableHeaderCell = function () {\n      return $_xbeoqkkjfuw8q73.fromTag('th');\n    };\n\n    var tableCell = function () {\n      return $_xbeoqkkjfuw8q73.fromTag('td');\n    };\n\n    var render$1 = function (rows, columns, rowHeaders, columnHeaders, renderOpts) {\n      if (renderOpts === void 0) {\n        renderOpts = DefaultRenderOptions;\n      }\n\n      var table = makeTable();\n      $_bfod2hlejfuw8qac.setAll(table, renderOpts.styles);\n      $_3q82t2l5jfuw8q93.setAll(table, renderOpts.attributes);\n      var tbody = tableBody();\n      $_fatuxylgjfuw8qav.append(table, tbody);\n      var trs = [];\n\n      for (var i = 0; i < rows; i++) {\n        var tr = tableRow();\n\n        for (var j = 0; j < columns; j++) {\n          var td = i < rowHeaders || j < columnHeaders ? tableHeaderCell() : tableCell();\n\n          if (j < columnHeaders) {\n            $_3q82t2l5jfuw8q93.set(td, 'scope', 'row');\n          }\n\n          if (i < rowHeaders) {\n            $_3q82t2l5jfuw8q93.set(td, 'scope', 'col');\n          }\n\n          $_fatuxylgjfuw8qav.append(td, $_xbeoqkkjfuw8q73.fromTag('br'));\n\n          if (renderOpts.percentages) {\n            $_bfod2hlejfuw8qac.set(td, 'width', 100 / columns + '%');\n          }\n\n          $_fatuxylgjfuw8qav.append(tr, td);\n        }\n\n        trs.push(tr);\n      }\n\n      $_9zaoqflijfuw8qb0.append(tbody, trs);\n      return table;\n    };\n\n    var get$7 = function (element) {\n      return element.dom().innerHTML;\n    };\n\n    var set$5 = function (element, content) {\n      var owner = $_s8scrkmjfuw8q7a.owner(element);\n      var docDom = owner.dom();\n      var fragment = $_xbeoqkkjfuw8q73.fromDom(docDom.createDocumentFragment());\n      var contentElements = $_du13u9lpjfuw8qce.fromHtml(content, docDom);\n      $_9zaoqflijfuw8qb0.append(fragment, contentElements);\n      $_fl1deelhjfuw8qax.empty(element);\n      $_fatuxylgjfuw8qav.append(element, fragment);\n    };\n\n    var getOuter$2 = function (element) {\n      var container = $_xbeoqkkjfuw8q73.fromTag('div');\n      var clone = $_xbeoqkkjfuw8q73.fromDom(element.dom().cloneNode(true));\n      $_fatuxylgjfuw8qav.append(container, clone);\n      return get$7(container);\n    };\n\n    var $_76qisuo4jfuw8qut = {\n      get: get$7,\n      set: set$5,\n      getOuter: getOuter$2\n    };\n\n    var placeCaretInCell = function (editor, cell) {\n      editor.selection.select(cell.dom(), true);\n      editor.selection.collapse(true);\n    };\n\n    var selectFirstCellInTable = function (editor, tableElm) {\n      $_8wdrbmlajfuw8q9m.descendant(tableElm, 'td,th').each($_20nfr6k7jfuw8q4g.curry(placeCaretInCell, editor));\n    };\n\n    var fireEvents = function (editor, table) {\n      $_tyr3yk5jfuw8q47.each($_6c9d0hl7jfuw8q9d.descendants(table, 'tr'), function (row) {\n        fireNewRow(editor, row.dom());\n        $_tyr3yk5jfuw8q47.each($_6c9d0hl7jfuw8q9d.descendants(row, 'th,td'), function (cell) {\n          fireNewCell(editor, cell.dom());\n        });\n      });\n    };\n\n    var isPercentage = function (width) {\n      return $_g6mvnrk8jfuw8q4k.isString(width) && width.indexOf('%') !== -1;\n    };\n\n    var insert$1 = function (editor, columns, rows) {\n      var defaultStyles = getDefaultStyles(editor);\n      var options = {\n        styles: defaultStyles,\n        attributes: getDefaultAttributes(editor),\n        percentages: isPercentage(defaultStyles.width) && !isPixelsForced(editor)\n      };\n      var table = render$1(rows, columns, 0, 0, options);\n      $_3q82t2l5jfuw8q93.set(table, 'data-mce-id', '__mce');\n      var html = $_76qisuo4jfuw8qut.getOuter(table);\n      editor.insertContent(html);\n      return $_8wdrbmlajfuw8q9m.descendant($_5xkhf2nnjfuw8qrq.getBody(editor), 'table[data-mce-id=\"__mce\"]').map(function (table) {\n        if (isPixelsForced(editor)) {\n          $_bfod2hlejfuw8qac.set(table, 'width', $_bfod2hlejfuw8qac.get(table, 'width'));\n        }\n\n        $_3q82t2l5jfuw8q93.remove(table, 'data-mce-id');\n        fireEvents(editor, table);\n        selectFirstCellInTable(editor, table);\n        return table.dom();\n      }).getOr(null);\n    };\n\n    var $_1mq3b3o1jfuw8qtu = {\n      insert: insert$1\n    };\n\n    function styleTDTH(dom, elm, name, value) {\n      if (elm.tagName === 'TD' || elm.tagName === 'TH') {\n        dom.setStyle(elm, name, value);\n      } else {\n        if (elm.children) {\n          for (var i = 0; i < elm.children.length; i++) {\n            styleTDTH(dom, elm.children[i], name, value);\n          }\n        }\n      }\n    }\n\n    var extractDataFromElement$2 = function (editor, tableElm) {\n      var dom = editor.dom;\n      var data = {\n        width: dom.getStyle(tableElm, 'width') || dom.getAttrib(tableElm, 'width'),\n        height: dom.getStyle(tableElm, 'height') || dom.getAttrib(tableElm, 'height'),\n        cellspacing: dom.getStyle(tableElm, 'border-spacing') || dom.getAttrib(tableElm, 'cellspacing'),\n        cellpadding: dom.getAttrib(tableElm, 'data-mce-cell-padding') || dom.getAttrib(tableElm, 'cellpadding') || $_ch6rvmnwjfuw8qt7.getTDTHOverallStyle(editor.dom, tableElm, 'padding'),\n        border: dom.getAttrib(tableElm, 'data-mce-border') || dom.getAttrib(tableElm, 'border') || $_ch6rvmnwjfuw8qt7.getTDTHOverallStyle(editor.dom, tableElm, 'border'),\n        borderColor: dom.getAttrib(tableElm, 'data-mce-border-color'),\n        caption: !!dom.select('caption', tableElm)[0],\n        class: dom.getAttrib(tableElm, 'class')\n      };\n      global$2.each('left center right'.split(' '), function (name) {\n        if (editor.formatter.matchNode(tableElm, 'align' + name)) {\n          data.align = name;\n        }\n      });\n\n      if (hasAdvancedTableTab(editor)) {\n        global$2.extend(data, $_2fnzp5nxjfuw8qt9.extractAdvancedStyles(dom, tableElm));\n      }\n\n      return data;\n    };\n\n    var applyDataToElement = function (editor, tableElm, data) {\n      var dom = editor.dom;\n      var attrs = {};\n      var styles = {};\n      attrs.class = data.class;\n      styles.height = $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.height);\n\n      if (dom.getAttrib(tableElm, 'width') && !shouldStyleWithCss(editor)) {\n        attrs.width = $_5xkhf2nnjfuw8qrq.removePxSuffix(data.width);\n      } else {\n        styles.width = $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.width);\n      }\n\n      if (shouldStyleWithCss(editor)) {\n        styles['border-width'] = $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.border);\n        styles['border-spacing'] = $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.cellspacing);\n        global$2.extend(attrs, {\n          'data-mce-border-color': data.borderColor,\n          'data-mce-cell-padding': data.cellpadding,\n          'data-mce-border': data.border\n        });\n      } else {\n        global$2.extend(attrs, {\n          border: data.border,\n          cellpadding: data.cellpadding,\n          cellspacing: data.cellspacing\n        });\n      }\n\n      if (shouldStyleWithCss(editor)) {\n        if (tableElm.children) {\n          for (var i = 0; i < tableElm.children.length; i++) {\n            styleTDTH(dom, tableElm.children[i], {\n              'border-width': $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.border),\n              'border-color': data.borderColor,\n              'padding': $_5xkhf2nnjfuw8qrq.addSizeSuffix(data.cellpadding)\n            });\n          }\n        }\n      }\n\n      if (data.style) {\n        global$2.extend(styles, dom.parseStyle(data.style));\n      } else {\n        styles = global$2.extend({}, dom.parseStyle(dom.getAttrib(tableElm, 'style')), styles);\n      }\n\n      attrs.style = dom.serializeStyle(styles);\n      dom.setAttribs(tableElm, attrs);\n    };\n\n    var onSubmitTableForm = function (editor, tableElm, evt) {\n      var dom = editor.dom;\n      var captionElm;\n      var data;\n      $_2fnzp5nxjfuw8qt9.updateStyleField(editor, evt);\n      data = evt.control.rootControl.toJSON();\n\n      if (data.class === false) {\n        delete data.class;\n      }\n\n      editor.undoManager.transact(function () {\n        if (!tableElm) {\n          tableElm = $_1mq3b3o1jfuw8qtu.insert(editor, data.cols || 1, data.rows || 1);\n        }\n\n        applyDataToElement(editor, tableElm, data);\n        captionElm = dom.select('caption', tableElm)[0];\n\n        if (captionElm && !data.caption) {\n          dom.remove(captionElm);\n        }\n\n        if (!captionElm && data.caption) {\n          captionElm = dom.create('caption');\n          captionElm.innerHTML = !global$3.ie ? '<br data-mce-bogus=\"1\"/>' : '\\xA0';\n          tableElm.insertBefore(captionElm, tableElm.firstChild);\n        }\n\n        $_ch6rvmnwjfuw8qt7.unApplyAlign(editor, tableElm);\n\n        if (data.align) {\n          $_ch6rvmnwjfuw8qt7.applyAlign(editor, tableElm, data.align);\n        }\n\n        editor.focus();\n        editor.addVisual();\n      });\n    };\n\n    var open$2 = function (editor, isProps) {\n      var dom = editor.dom;\n      var tableElm,\n          colsCtrl,\n          rowsCtrl,\n          classListCtrl,\n          data = {},\n          generalTableForm;\n\n      if (isProps === true) {\n        tableElm = dom.getParent(editor.selection.getStart(), 'table');\n\n        if (tableElm) {\n          data = extractDataFromElement$2(editor, tableElm);\n        }\n      } else {\n        colsCtrl = {\n          label: 'Cols',\n          name: 'cols'\n        };\n        rowsCtrl = {\n          label: 'Rows',\n          name: 'rows'\n        };\n      }\n\n      if (getTableClassList(editor).length > 0) {\n        if (data.class) {\n          data.class = data.class.replace(/\\s*mce\\-item\\-table\\s*/g, '');\n        }\n\n        classListCtrl = {\n          name: 'class',\n          type: 'listbox',\n          label: 'Class',\n          values: $_2fnzp5nxjfuw8qt9.buildListItems(getTableClassList(editor), function (item) {\n            if (item.value) {\n              item.textStyle = function () {\n                return editor.formatter.getCssText({\n                  block: 'table',\n                  classes: [item.value]\n                });\n              };\n            }\n          })\n        };\n      }\n\n      generalTableForm = {\n        type: 'form',\n        layout: 'flex',\n        direction: 'column',\n        labelGapCalc: 'children',\n        padding: 0,\n        items: [{\n          type: 'form',\n          labelGapCalc: false,\n          padding: 0,\n          layout: 'grid',\n          columns: 2,\n          defaults: {\n            type: 'textbox',\n            maxWidth: 50\n          },\n          items: hasAppearanceOptions(editor) ? [colsCtrl, rowsCtrl, {\n            label: 'Width',\n            name: 'width',\n            onchange: $_20nfr6k7jfuw8q4g.curry($_2fnzp5nxjfuw8qt9.updateStyleField, editor)\n          }, {\n            label: 'Height',\n            name: 'height',\n            onchange: $_20nfr6k7jfuw8q4g.curry($_2fnzp5nxjfuw8qt9.updateStyleField, editor)\n          }, {\n            label: 'Cell spacing',\n            name: 'cellspacing'\n          }, {\n            label: 'Cell padding',\n            name: 'cellpadding'\n          }, {\n            label: 'Border',\n            name: 'border'\n          }, {\n            label: 'Caption',\n            name: 'caption',\n            type: 'checkbox'\n          }] : [colsCtrl, rowsCtrl, {\n            label: 'Width',\n            name: 'width',\n            onchange: $_20nfr6k7jfuw8q4g.curry($_2fnzp5nxjfuw8qt9.updateStyleField, editor)\n          }, {\n            label: 'Height',\n            name: 'height',\n            onchange: $_20nfr6k7jfuw8q4g.curry($_2fnzp5nxjfuw8qt9.updateStyleField, editor)\n          }]\n        }, {\n          label: 'Alignment',\n          name: 'align',\n          type: 'listbox',\n          text: 'None',\n          values: [{\n            text: 'None',\n            value: ''\n          }, {\n            text: 'Left',\n            value: 'left'\n          }, {\n            text: 'Center',\n            value: 'center'\n          }, {\n            text: 'Right',\n            value: 'right'\n          }]\n        }, classListCtrl]\n      };\n\n      if (hasAdvancedTableTab(editor)) {\n        editor.windowManager.open({\n          title: 'Table properties',\n          data: data,\n          bodyType: 'tabpanel',\n          body: [{\n            title: 'General',\n            type: 'form',\n            items: generalTableForm\n          }, $_2fnzp5nxjfuw8qt9.createStyleForm(editor)],\n          onsubmit: $_20nfr6k7jfuw8q4g.curry(onSubmitTableForm, editor, tableElm)\n        });\n      } else {\n        editor.windowManager.open({\n          title: 'Table properties',\n          data: data,\n          body: generalTableForm,\n          onsubmit: $_20nfr6k7jfuw8q4g.curry(onSubmitTableForm, editor, tableElm)\n        });\n      }\n    };\n\n    var $_ad8brjnzjfuw8qtm = {\n      open: open$2\n    };\n    var each$3 = global$2.each;\n\n    var registerCommands = function (editor, actions, cellSelection, selections, clipboardRows) {\n      var isRoot = $_5xkhf2nnjfuw8qrq.getIsRoot(editor);\n\n      var eraseTable = function () {\n        var cell = $_xbeoqkkjfuw8q73.fromDom(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n        var table = $_aqhz9okhjfuw8q5y.table(cell, isRoot);\n        table.filter($_20nfr6k7jfuw8q4g.not(isRoot)).each(function (table) {\n          var cursor = $_xbeoqkkjfuw8q73.fromText('');\n          $_fatuxylgjfuw8qav.after(table, cursor);\n          $_fl1deelhjfuw8qax.remove(table);\n          var rng = editor.dom.createRng();\n          rng.setStart(cursor.dom(), 0);\n          rng.setEnd(cursor.dom(), 0);\n          editor.selection.setRng(rng);\n        });\n      };\n\n      var getSelectionStartCell = function () {\n        return $_xbeoqkkjfuw8q73.fromDom(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n      };\n\n      var getTableFromCell = function (cell) {\n        return $_aqhz9okhjfuw8q5y.table(cell, isRoot);\n      };\n\n      var actOnSelection = function (execute) {\n        var cell = getSelectionStartCell();\n        var table = getTableFromCell(cell);\n        table.each(function (table) {\n          var targets = $_5b7h1hlqjfuw8qci.forMenu(selections, table, cell);\n          execute(table, targets).each(function (rng) {\n            editor.selection.setRng(rng);\n            editor.focus();\n            cellSelection.clear(table);\n          });\n        });\n      };\n\n      var copyRowSelection = function (execute) {\n        var cell = getSelectionStartCell();\n        var table = getTableFromCell(cell);\n        return table.bind(function (table) {\n          var doc = $_xbeoqkkjfuw8q73.fromDom(editor.getDoc());\n          var targets = $_5b7h1hlqjfuw8qci.forMenu(selections, table, cell);\n          var generators = $_5ohg1eljjfuw8qb4.cellOperations($_20nfr6k7jfuw8q4g.noop, doc, Option.none());\n          return $_8a78aqntjfuw8qsp.copyRows(table, targets, generators);\n        });\n      };\n\n      var pasteOnSelection = function (execute) {\n        clipboardRows.get().each(function (rows) {\n          var clonedRows = $_tyr3yk5jfuw8q47.map(rows, function (row) {\n            return $_ddvp06lkjfuw8qbt.deep(row);\n          });\n          var cell = getSelectionStartCell();\n          var table = getTableFromCell(cell);\n          table.bind(function (table) {\n            var doc = $_xbeoqkkjfuw8q73.fromDom(editor.getDoc());\n            var generators = $_5ohg1eljjfuw8qb4.paste(doc);\n            var targets = $_5b7h1hlqjfuw8qci.pasteRows(selections, table, cell, clonedRows, generators);\n            execute(table, targets).each(function (rng) {\n              editor.selection.setRng(rng);\n              editor.focus();\n              cellSelection.clear(table);\n            });\n          });\n        });\n      };\n\n      each$3({\n        mceTableSplitCells: function () {\n          actOnSelection(actions.unmergeCells);\n        },\n        mceTableMergeCells: function () {\n          actOnSelection(actions.mergeCells);\n        },\n        mceTableInsertRowBefore: function () {\n          actOnSelection(actions.insertRowsBefore);\n        },\n        mceTableInsertRowAfter: function () {\n          actOnSelection(actions.insertRowsAfter);\n        },\n        mceTableInsertColBefore: function () {\n          actOnSelection(actions.insertColumnsBefore);\n        },\n        mceTableInsertColAfter: function () {\n          actOnSelection(actions.insertColumnsAfter);\n        },\n        mceTableDeleteCol: function () {\n          actOnSelection(actions.deleteColumn);\n        },\n        mceTableDeleteRow: function () {\n          actOnSelection(actions.deleteRow);\n        },\n        mceTableCutRow: function (grid) {\n          clipboardRows.set(copyRowSelection());\n          actOnSelection(actions.deleteRow);\n        },\n        mceTableCopyRow: function (grid) {\n          clipboardRows.set(copyRowSelection());\n        },\n        mceTablePasteRowBefore: function (grid) {\n          pasteOnSelection(actions.pasteRowsBefore);\n        },\n        mceTablePasteRowAfter: function (grid) {\n          pasteOnSelection(actions.pasteRowsAfter);\n        },\n        mceTableDelete: eraseTable\n      }, function (func, name) {\n        editor.addCommand(name, func);\n      });\n      each$3({\n        mceInsertTable: $_20nfr6k7jfuw8q4g.curry($_ad8brjnzjfuw8qtm.open, editor),\n        mceTableProps: $_20nfr6k7jfuw8q4g.curry($_ad8brjnzjfuw8qtm.open, editor, true),\n        mceTableRowProps: $_20nfr6k7jfuw8q4g.curry($_cshv4qnyjfuw8qtf.open, editor),\n        mceTableCellProps: $_20nfr6k7jfuw8q4g.curry($_48j9iinvjfuw8qsu.open, editor)\n      }, function (func, name) {\n        editor.addCommand(name, function (ui, val) {\n          func(val);\n        });\n      });\n    };\n\n    var $_srry6nsjfuw8qs8 = {\n      registerCommands: registerCommands\n    };\n\n    var only$1 = function (element) {\n      var parent = Option.from(element.dom().documentElement).map($_xbeoqkkjfuw8q73.fromDom).getOr(element);\n      return {\n        parent: $_20nfr6k7jfuw8q4g.constant(parent),\n        view: $_20nfr6k7jfuw8q4g.constant(element),\n        origin: $_20nfr6k7jfuw8q4g.constant(r(0, 0))\n      };\n    };\n\n    var detached = function (editable, chrome) {\n      var origin = $_20nfr6k7jfuw8q4g.curry($_hsvzlmijfuw8qj4.absolute, chrome);\n      return {\n        parent: $_20nfr6k7jfuw8q4g.constant(chrome),\n        view: $_20nfr6k7jfuw8q4g.constant(editable),\n        origin: origin\n      };\n    };\n\n    var body$1 = function (editable, chrome) {\n      return {\n        parent: $_20nfr6k7jfuw8q4g.constant(chrome),\n        view: $_20nfr6k7jfuw8q4g.constant(editable),\n        origin: $_20nfr6k7jfuw8q4g.constant(r(0, 0))\n      };\n    };\n\n    var $_e4gwgeo6jfuw8qvi = {\n      only: only$1,\n      detached: detached,\n      body: body$1\n    };\n\n    function Event(fields) {\n      var struct = $_5now9kbjfuw8q5e.immutable.apply(null, fields);\n      var handlers = [];\n\n      var bind = function (handler) {\n        if (handler === undefined) {\n          throw 'Event bind error: undefined handler';\n        }\n\n        handlers.push(handler);\n      };\n\n      var unbind = function (handler) {\n        handlers = $_tyr3yk5jfuw8q47.filter(handlers, function (h) {\n          return h !== handler;\n        });\n      };\n\n      var trigger = function () {\n        var event = struct.apply(null, arguments);\n        $_tyr3yk5jfuw8q47.each(handlers, function (handler) {\n          handler(event);\n        });\n      };\n\n      return {\n        bind: bind,\n        unbind: unbind,\n        trigger: trigger\n      };\n    }\n\n    var create = function (typeDefs) {\n      var registry = $_11yiupkajfuw8q5c.map(typeDefs, function (event) {\n        return {\n          bind: event.bind,\n          unbind: event.unbind\n        };\n      });\n      var trigger = $_11yiupkajfuw8q5c.map(typeDefs, function (event) {\n        return event.trigger;\n      });\n      return {\n        registry: registry,\n        trigger: trigger\n      };\n    };\n\n    var $_1fbhhho9jfuw8qw4 = {\n      create: create\n    };\n    var mode = $_7z97w5mpjfuw8qkk.exactly(['compare', 'extract', 'mutate', 'sink']);\n    var sink = $_7z97w5mpjfuw8qkk.exactly(['element', 'start', 'stop', 'destroy']);\n    var api$3 = $_7z97w5mpjfuw8qkk.exactly(['forceDrop', 'drop', 'move', 'delayDrop']);\n    var $_aqs1mcodjfuw8qxk = {\n      mode: mode,\n      sink: sink,\n      api: api$3\n    };\n    var styles$1 = $_63w6atn5jfuw8qot.css('ephox-dragster');\n    var $_41gm3bofjfuw8qxz = {\n      resolve: styles$1.resolve\n    };\n\n    function Blocker(options) {\n      var settings = $_91sgzmujfuw8qm5.merge({\n        'layerClass': $_41gm3bofjfuw8qxz.resolve('blocker')\n      }, options);\n      var div = $_xbeoqkkjfuw8q73.fromTag('div');\n      $_3q82t2l5jfuw8q93.set(div, 'role', 'presentation');\n      $_bfod2hlejfuw8qac.setAll(div, {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        width: '100%',\n        height: '100%'\n      });\n      $_fmcseon6jfuw8qou.add(div, $_41gm3bofjfuw8qxz.resolve('blocker'));\n      $_fmcseon6jfuw8qou.add(div, settings.layerClass);\n\n      var element = function () {\n        return div;\n      };\n\n      var destroy = function () {\n        $_fl1deelhjfuw8qax.remove(div);\n      };\n\n      return {\n        element: element,\n        destroy: destroy\n      };\n    }\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        'target': $_20nfr6k7jfuw8q4g.constant(target),\n        'x': $_20nfr6k7jfuw8q4g.constant(x),\n        'y': $_20nfr6k7jfuw8q4g.constant(y),\n        'stop': stop,\n        'prevent': prevent,\n        'kill': kill,\n        'raw': $_20nfr6k7jfuw8q4g.constant(raw)\n      };\n    };\n\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (!filter(rawEvent)) return;\n        var target = $_xbeoqkkjfuw8q73.fromDom(rawEvent.target);\n\n        var stop = function () {\n          rawEvent.stopPropagation();\n        };\n\n        var prevent = function () {\n          rawEvent.preventDefault();\n        };\n\n        var kill = $_20nfr6k7jfuw8q4g.compose(prevent, stop);\n        var evt = mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n        handler(evt);\n      };\n    };\n\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom().addEventListener(event, wrapped, useCapture);\n      return {\n        unbind: $_20nfr6k7jfuw8q4g.curry(unbind, element, event, wrapped, useCapture)\n      };\n    };\n\n    var bind$1 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n\n    var capture = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, true);\n    };\n\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom().removeEventListener(event, handler, useCapture);\n    };\n\n    var $_fal932ohjfuw8qy6 = {\n      bind: bind$1,\n      capture: capture\n    };\n    var filter$1 = $_20nfr6k7jfuw8q4g.constant(true);\n\n    var bind$2 = function (element, event, handler) {\n      return $_fal932ohjfuw8qy6.bind(element, event, filter$1, handler);\n    };\n\n    var capture$1 = function (element, event, handler) {\n      return $_fal932ohjfuw8qy6.capture(element, event, filter$1, handler);\n    };\n\n    var $_6fxiitogjfuw8qy3 = {\n      bind: bind$2,\n      capture: capture$1\n    };\n\n    var compare = function (old, nu) {\n      return r(nu.left() - old.left(), nu.top() - old.top());\n    };\n\n    var extract$1 = function (event) {\n      return Option.some(r(event.x(), event.y()));\n    };\n\n    var mutate$1 = function (mutation, info) {\n      mutation.mutate(info.left(), info.top());\n    };\n\n    var sink$1 = function (dragApi, settings) {\n      var blocker = Blocker(settings);\n      var mdown = $_6fxiitogjfuw8qy3.bind(blocker.element(), 'mousedown', dragApi.forceDrop);\n      var mup = $_6fxiitogjfuw8qy3.bind(blocker.element(), 'mouseup', dragApi.drop);\n      var mmove = $_6fxiitogjfuw8qy3.bind(blocker.element(), 'mousemove', dragApi.move);\n      var mout = $_6fxiitogjfuw8qy3.bind(blocker.element(), 'mouseout', dragApi.delayDrop);\n\n      var destroy = function () {\n        blocker.destroy();\n        mup.unbind();\n        mmove.unbind();\n        mout.unbind();\n        mdown.unbind();\n      };\n\n      var start = function (parent) {\n        $_fatuxylgjfuw8qav.append(parent, blocker.element());\n      };\n\n      var stop = function () {\n        $_fl1deelhjfuw8qax.remove(blocker.element());\n      };\n\n      return $_aqs1mcodjfuw8qxk.sink({\n        element: blocker.element,\n        start: start,\n        stop: stop,\n        destroy: destroy\n      });\n    };\n\n    var MouseDrag = $_aqs1mcodjfuw8qxk.mode({\n      compare: compare,\n      extract: extract$1,\n      sink: sink$1,\n      mutate: mutate$1\n    });\n\n    function InDrag() {\n      var previous = Option.none();\n\n      var reset = function () {\n        previous = Option.none();\n      };\n\n      var update = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.compare(old, nu);\n        });\n        previous = Option.some(nu);\n        return result;\n      };\n\n      var onEvent = function (event, mode) {\n        var dataOption = mode.extract(event);\n        dataOption.each(function (data) {\n          var offset = update(mode, data);\n          offset.each(function (d) {\n            events.trigger.move(d);\n          });\n        });\n      };\n\n      var events = $_1fbhhho9jfuw8qw4.create({\n        move: Event(['info'])\n      });\n      return {\n        onEvent: onEvent,\n        reset: reset,\n        events: events.registry\n      };\n    }\n\n    function NoDrag(anchor) {\n      var onEvent = function (event, mode) {};\n\n      return {\n        onEvent: onEvent,\n        reset: $_20nfr6k7jfuw8q4g.noop\n      };\n    }\n\n    function Movement() {\n      var noDragState = NoDrag();\n      var inDragState = InDrag();\n      var dragState = noDragState;\n\n      var on = function () {\n        dragState.reset();\n        dragState = inDragState;\n      };\n\n      var off = function () {\n        dragState.reset();\n        dragState = noDragState;\n      };\n\n      var onEvent = function (event, mode) {\n        dragState.onEvent(event, mode);\n      };\n\n      var isOn = function () {\n        return dragState === inDragState;\n      };\n\n      return {\n        on: on,\n        off: off,\n        isOn: isOn,\n        onEvent: onEvent,\n        events: inDragState.events\n      };\n    }\n\n    var adaptable = function (fn, rate) {\n      var timer = null;\n      var args = null;\n\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n          args = null;\n        }\n      };\n\n      var throttle = function () {\n        args = arguments;\n\n        if (timer === null) {\n          timer = setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n            args = null;\n          }, rate);\n        }\n      };\n\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var first$4 = function (fn, rate) {\n      var timer = null;\n\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n\n      var throttle = function () {\n        var args = arguments;\n\n        if (timer === null) {\n          timer = setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n            args = null;\n          }, rate);\n        }\n      };\n\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var last$3 = function (fn, rate) {\n      var timer = null;\n\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n\n      var throttle = function () {\n        var args = arguments;\n        if (timer !== null) clearTimeout(timer);\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n          args = null;\n        }, rate);\n      };\n\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var $_4fpdigomjfuw8qyv = {\n      adaptable: adaptable,\n      first: first$4,\n      last: last$3\n    };\n\n    var setup = function (mutation, mode, settings) {\n      var active = false;\n      var events = $_1fbhhho9jfuw8qw4.create({\n        start: Event([]),\n        stop: Event([])\n      });\n      var movement = Movement();\n\n      var drop = function () {\n        sink.stop();\n\n        if (movement.isOn()) {\n          movement.off();\n          events.trigger.stop();\n        }\n      };\n\n      var throttledDrop = $_4fpdigomjfuw8qyv.last(drop, 200);\n\n      var go = function (parent) {\n        sink.start(parent);\n        movement.on();\n        events.trigger.start();\n      };\n\n      var mousemove = function (event, ui) {\n        throttledDrop.cancel();\n        movement.onEvent(event, mode);\n      };\n\n      movement.events.move.bind(function (event) {\n        mode.mutate(mutation, event.info());\n      });\n\n      var on = function () {\n        active = true;\n      };\n\n      var off = function () {\n        active = false;\n      };\n\n      var runIfActive = function (f) {\n        return function () {\n          var args = Array.prototype.slice.call(arguments, 0);\n\n          if (active) {\n            return f.apply(null, args);\n          }\n        };\n      };\n\n      var sink = mode.sink($_aqs1mcodjfuw8qxk.api({\n        forceDrop: drop,\n        drop: runIfActive(drop),\n        move: runIfActive(mousemove),\n        delayDrop: runIfActive(throttledDrop.throttle)\n      }), settings);\n\n      var destroy = function () {\n        sink.destroy();\n      };\n\n      return {\n        element: sink.element,\n        go: go,\n        on: on,\n        off: off,\n        destroy: destroy,\n        events: events.registry\n      };\n    };\n\n    var $_bv42lfoijfuw8qyb = {\n      setup: setup\n    };\n\n    var transform$1 = function (mutation, options) {\n      var settings = options !== undefined ? options : {};\n      var mode = settings.mode !== undefined ? settings.mode : MouseDrag;\n      return $_bv42lfoijfuw8qyb.setup(mutation, mode, options);\n    };\n\n    var $_a1giepobjfuw8qx7 = {\n      transform: transform$1\n    };\n\n    function Mutation() {\n      var events = $_1fbhhho9jfuw8qw4.create({\n        'drag': Event(['xDelta', 'yDelta'])\n      });\n\n      var mutate = function (x, y) {\n        events.trigger.drag(x, y);\n      };\n\n      return {\n        mutate: mutate,\n        events: events.registry\n      };\n    }\n\n    function BarMutation() {\n      var events = $_1fbhhho9jfuw8qw4.create({\n        drag: Event(['xDelta', 'yDelta', 'target'])\n      });\n      var target = Option.none();\n      var delegate = Mutation();\n      delegate.events.drag.bind(function (event) {\n        target.each(function (t) {\n          events.trigger.drag(event.xDelta(), event.yDelta(), t);\n        });\n      });\n\n      var assign = function (t) {\n        target = Option.some(t);\n      };\n\n      var get = function () {\n        return target;\n      };\n\n      return {\n        assign: assign,\n        get: get,\n        mutate: delegate.mutate,\n        events: events.registry\n      };\n    }\n\n    var any = function (selector) {\n      return $_8wdrbmlajfuw8q9m.first(selector).isSome();\n    };\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return $_8wdrbmlajfuw8q9m.ancestor(scope, selector, isRoot).isSome();\n    };\n\n    var sibling$2 = function (scope, selector) {\n      return $_8wdrbmlajfuw8q9m.sibling(scope, selector).isSome();\n    };\n\n    var child$3 = function (scope, selector) {\n      return $_8wdrbmlajfuw8q9m.child(scope, selector).isSome();\n    };\n\n    var descendant$2 = function (scope, selector) {\n      return $_8wdrbmlajfuw8q9m.descendant(scope, selector).isSome();\n    };\n\n    var closest$2 = function (scope, selector, isRoot) {\n      return $_8wdrbmlajfuw8q9m.closest(scope, selector, isRoot).isSome();\n    };\n\n    var $_44mfk0opjfuw8qze = {\n      any: any,\n      ancestor: ancestor$2,\n      sibling: sibling$2,\n      child: child$3,\n      descendant: descendant$2,\n      closest: closest$2\n    };\n    var resizeBarDragging = $_f6r94sn4jfuw8qoq.resolve('resizer-bar-dragging');\n\n    function BarManager(wire, direction, hdirection) {\n      var mutation = BarMutation();\n      var resizing = $_a1giepobjfuw8qx7.transform(mutation, {});\n      var hoverTable = Option.none();\n\n      var getResizer = function (element, type) {\n        return Option.from($_3q82t2l5jfuw8q93.get(element, type));\n      };\n\n      mutation.events.drag.bind(function (event) {\n        getResizer(event.target(), 'data-row').each(function (_dataRow) {\n          var currentRow = $_63qtcvnkjfuw8qqu.getInt(event.target(), 'top');\n          $_bfod2hlejfuw8qac.set(event.target(), 'top', currentRow + event.yDelta() + 'px');\n        });\n        getResizer(event.target(), 'data-column').each(function (_dataCol) {\n          var currentCol = $_63qtcvnkjfuw8qqu.getInt(event.target(), 'left');\n          $_bfod2hlejfuw8qac.set(event.target(), 'left', currentCol + event.xDelta() + 'px');\n        });\n      });\n\n      var getDelta = function (target, direction) {\n        var newX = $_63qtcvnkjfuw8qqu.getInt(target, direction);\n        var oldX = parseInt($_3q82t2l5jfuw8q93.get(target, 'data-initial-' + direction), 10);\n        return newX - oldX;\n      };\n\n      resizing.events.stop.bind(function () {\n        mutation.get().each(function (target) {\n          hoverTable.each(function (table) {\n            getResizer(target, 'data-row').each(function (row) {\n              var delta = getDelta(target, 'top');\n              $_3q82t2l5jfuw8q93.remove(target, 'data-initial-top');\n              events.trigger.adjustHeight(table, delta, parseInt(row, 10));\n            });\n            getResizer(target, 'data-column').each(function (column) {\n              var delta = getDelta(target, 'left');\n              $_3q82t2l5jfuw8q93.remove(target, 'data-initial-left');\n              events.trigger.adjustWidth(table, delta, parseInt(column, 10));\n            });\n            $_jc1w5n0jfuw8qng.refresh(wire, table, hdirection, direction);\n          });\n        });\n      });\n\n      var handler = function (target, direction) {\n        events.trigger.startAdjust();\n        mutation.assign(target);\n        $_3q82t2l5jfuw8q93.set(target, 'data-initial-' + direction, parseInt($_bfod2hlejfuw8qac.get(target, direction), 10));\n        $_fmcseon6jfuw8qou.add(target, resizeBarDragging);\n        $_bfod2hlejfuw8qac.set(target, 'opacity', '0.2');\n        resizing.go(wire.parent());\n      };\n\n      var mousedown = $_6fxiitogjfuw8qy3.bind(wire.parent(), 'mousedown', function (event) {\n        if ($_jc1w5n0jfuw8qng.isRowBar(event.target())) handler(event.target(), 'top');\n        if ($_jc1w5n0jfuw8qng.isColBar(event.target())) handler(event.target(), 'left');\n      });\n\n      var isRoot = function (e) {\n        return $_e8rn66kojfuw8q7n.eq(e, wire.view());\n      };\n\n      var mouseover = $_6fxiitogjfuw8qy3.bind(wire.view(), 'mouseover', function (event) {\n        if ($_a8gk30l6jfuw8q9c.name(event.target()) === 'table' || $_44mfk0opjfuw8qze.closest(event.target(), 'table', isRoot)) {\n          hoverTable = $_a8gk30l6jfuw8q9c.name(event.target()) === 'table' ? Option.some(event.target()) : $_8wdrbmlajfuw8q9m.ancestor(event.target(), 'table', isRoot);\n          hoverTable.each(function (ht) {\n            $_jc1w5n0jfuw8qng.refresh(wire, ht, hdirection, direction);\n          });\n        } else if ($_atd1tul9jfuw8q9i.inBody(event.target())) {\n          $_jc1w5n0jfuw8qng.destroy(wire);\n        }\n      });\n\n      var destroy = function () {\n        mousedown.unbind();\n        mouseover.unbind();\n        resizing.destroy();\n        $_jc1w5n0jfuw8qng.destroy(wire);\n      };\n\n      var refresh = function (tbl) {\n        $_jc1w5n0jfuw8qng.refresh(wire, tbl, hdirection, direction);\n      };\n\n      var events = $_1fbhhho9jfuw8qw4.create({\n        adjustHeight: Event(['table', 'delta', 'row']),\n        adjustWidth: Event(['table', 'delta', 'column']),\n        startAdjust: Event([])\n      });\n      return {\n        destroy: destroy,\n        refresh: refresh,\n        on: resizing.on,\n        off: resizing.off,\n        hideBars: $_20nfr6k7jfuw8q4g.curry($_jc1w5n0jfuw8qng.hide, wire),\n        showBars: $_20nfr6k7jfuw8q4g.curry($_jc1w5n0jfuw8qng.show, wire),\n        events: events.registry\n      };\n    }\n\n    function TableResize(wire, vdirection) {\n      var hdirection = $_16z2iamhjfuw8qir.height;\n      var manager = BarManager(wire, vdirection, hdirection);\n      var events = $_1fbhhho9jfuw8qw4.create({\n        beforeResize: Event(['table']),\n        afterResize: Event(['table']),\n        startDrag: Event([])\n      });\n      manager.events.adjustHeight.bind(function (event) {\n        events.trigger.beforeResize(event.table());\n        var delta = hdirection.delta(event.delta(), event.table());\n        $_cwciisngjfuw8qq6.adjustHeight(event.table(), delta, event.row(), hdirection);\n        events.trigger.afterResize(event.table());\n      });\n      manager.events.startAdjust.bind(function (event) {\n        events.trigger.startDrag();\n      });\n      manager.events.adjustWidth.bind(function (event) {\n        events.trigger.beforeResize(event.table());\n        var delta = vdirection.delta(event.delta(), event.table());\n        $_cwciisngjfuw8qq6.adjustWidth(event.table(), delta, event.column(), vdirection);\n        events.trigger.afterResize(event.table());\n      });\n      return {\n        on: manager.on,\n        off: manager.off,\n        hideBars: manager.hideBars,\n        showBars: manager.showBars,\n        destroy: manager.destroy,\n        events: events.registry\n      };\n    }\n\n    var createContainer = function () {\n      var container = $_xbeoqkkjfuw8q73.fromTag('div');\n      $_bfod2hlejfuw8qac.setAll(container, {\n        position: 'static',\n        height: '0',\n        width: '0',\n        padding: '0',\n        margin: '0',\n        border: '0'\n      });\n      $_fatuxylgjfuw8qav.append($_atd1tul9jfuw8q9i.body(), container);\n      return container;\n    };\n\n    var get$8 = function (editor, container) {\n      return editor.inline ? $_e4gwgeo6jfuw8qvi.body($_5xkhf2nnjfuw8qrq.getBody(editor), createContainer()) : $_e4gwgeo6jfuw8qvi.only($_xbeoqkkjfuw8q73.fromDom(editor.getDoc()));\n    };\n\n    var remove$6 = function (editor, wire) {\n      if (editor.inline) {\n        $_fl1deelhjfuw8qax.remove(wire.parent());\n      }\n    };\n\n    var $_fdmzdaoqjfuw8qzh = {\n      get: get$8,\n      remove: remove$6\n    };\n\n    var ResizeHandler = function (editor) {\n      var selectionRng = Option.none();\n      var resize = Option.none();\n      var wire = Option.none();\n      var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n      var startW, startRawW;\n\n      var isTable = function (elm) {\n        return elm.nodeName === 'TABLE';\n      };\n\n      var getRawWidth = function (elm) {\n        return editor.dom.getStyle(elm, 'width') || editor.dom.getAttrib(elm, 'width');\n      };\n\n      var lazyResize = function () {\n        return resize;\n      };\n\n      var lazyWire = function () {\n        return wire.getOr($_e4gwgeo6jfuw8qvi.only($_xbeoqkkjfuw8q73.fromDom(editor.getBody())));\n      };\n\n      var destroy = function () {\n        resize.each(function (sz) {\n          sz.destroy();\n        });\n        wire.each(function (w) {\n          $_fdmzdaoqjfuw8qzh.remove(editor, w);\n        });\n      };\n\n      editor.on('init', function () {\n        var direction = TableDirection($_4xd1udnojfuw8qrw.directionAt);\n        var rawWire = $_fdmzdaoqjfuw8qzh.get(editor);\n        wire = Option.some(rawWire);\n\n        if (hasObjectResizing(editor) && hasTableResizeBars(editor)) {\n          var sz = TableResize(rawWire, direction);\n          sz.on();\n          sz.events.startDrag.bind(function (event) {\n            selectionRng = Option.some(editor.selection.getRng());\n          });\n          sz.events.afterResize.bind(function (event) {\n            var table = event.table();\n            var dataStyleCells = $_6c9d0hl7jfuw8q9d.descendants(table, 'td[data-mce-style],th[data-mce-style]');\n            $_tyr3yk5jfuw8q47.each(dataStyleCells, function (cell) {\n              $_3q82t2l5jfuw8q93.remove(cell, 'data-mce-style');\n            });\n            selectionRng.each(function (rng) {\n              editor.selection.setRng(rng);\n              editor.focus();\n            });\n            editor.undoManager.add();\n          });\n          resize = Option.some(sz);\n        }\n      });\n      editor.on('ObjectResizeStart', function (e) {\n        var targetElm = e.target;\n\n        if (isTable(targetElm)) {\n          startW = e.width;\n          startRawW = getRawWidth(targetElm);\n        }\n      });\n      editor.on('ObjectResized', function (e) {\n        var targetElm = e.target;\n\n        if (isTable(targetElm)) {\n          var table = targetElm;\n\n          if (percentageBasedSizeRegex.test(startRawW)) {\n            var percentW = parseFloat(percentageBasedSizeRegex.exec(startRawW)[1]);\n            var targetPercentW = e.width * percentW / startW;\n            editor.dom.setStyle(table, 'width', targetPercentW + '%');\n          } else {\n            var newCellSizes_1 = [];\n            global$2.each(table.rows, function (row) {\n              global$2.each(row.cells, function (cell) {\n                var width = editor.dom.getStyle(cell, 'width', true);\n                newCellSizes_1.push({\n                  cell: cell,\n                  width: width\n                });\n              });\n            });\n            global$2.each(newCellSizes_1, function (newCellSize) {\n              editor.dom.setStyle(newCellSize.cell, 'width', newCellSize.width);\n              editor.dom.setAttrib(newCellSize.cell, 'width', null);\n            });\n          }\n        }\n      });\n      return {\n        lazyResize: lazyResize,\n        lazyWire: lazyWire,\n        destroy: destroy\n      };\n    };\n\n    var none$2 = function (current) {\n      return folder$1(function (n, f, m, l) {\n        return n(current);\n      });\n    };\n\n    var first$5 = function (current) {\n      return folder$1(function (n, f, m, l) {\n        return f(current);\n      });\n    };\n\n    var middle$1 = function (current, target) {\n      return folder$1(function (n, f, m, l) {\n        return m(current, target);\n      });\n    };\n\n    var last$4 = function (current) {\n      return folder$1(function (n, f, m, l) {\n        return l(current);\n      });\n    };\n\n    var folder$1 = function (fold) {\n      return {\n        fold: fold\n      };\n    };\n\n    var $_wsunjotjfuw8r0k = {\n      none: none$2,\n      first: first$5,\n      middle: middle$1,\n      last: last$4\n    };\n\n    var detect$4 = function (current, isRoot) {\n      return $_aqhz9okhjfuw8q5y.table(current, isRoot).bind(function (table) {\n        var all = $_aqhz9okhjfuw8q5y.cells(table);\n        var index = $_tyr3yk5jfuw8q47.findIndex(all, function (x) {\n          return $_e8rn66kojfuw8q7n.eq(current, x);\n        });\n        return index.map(function (ind) {\n          return {\n            index: $_20nfr6k7jfuw8q4g.constant(ind),\n            all: $_20nfr6k7jfuw8q4g.constant(all)\n          };\n        });\n      });\n    };\n\n    var next = function (current, isRoot) {\n      var detection = detect$4(current, isRoot);\n      return detection.fold(function () {\n        return $_wsunjotjfuw8r0k.none(current);\n      }, function (info) {\n        return info.index() + 1 < info.all().length ? $_wsunjotjfuw8r0k.middle(current, info.all()[info.index() + 1]) : $_wsunjotjfuw8r0k.last(current);\n      });\n    };\n\n    var prev = function (current, isRoot) {\n      var detection = detect$4(current, isRoot);\n      return detection.fold(function () {\n        return $_wsunjotjfuw8r0k.none();\n      }, function (info) {\n        return info.index() - 1 >= 0 ? $_wsunjotjfuw8r0k.middle(current, info.all()[info.index() - 1]) : $_wsunjotjfuw8r0k.first(current);\n      });\n    };\n\n    var $_947ovkosjfuw8r0c = {\n      next: next,\n      prev: prev\n    };\n    var adt = $_7sbzam7jfuw8qgu.generate([{\n      'before': ['element']\n    }, {\n      'on': ['element', 'offset']\n    }, {\n      after: ['element']\n    }]);\n\n    var cata$1 = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n\n    var getStart = function (situ) {\n      return situ.fold($_20nfr6k7jfuw8q4g.identity, $_20nfr6k7jfuw8q4g.identity, $_20nfr6k7jfuw8q4g.identity);\n    };\n\n    var $_cuk0n0ovjfuw8r0r = {\n      before: adt.before,\n      on: adt.on,\n      after: adt.after,\n      cata: cata$1,\n      getStart: getStart\n    };\n    var type$2 = $_7sbzam7jfuw8qgu.generate([{\n      domRange: ['rng']\n    }, {\n      relative: ['startSitu', 'finishSitu']\n    }, {\n      exact: ['start', 'soffset', 'finish', 'foffset']\n    }]);\n    var range$2 = $_5now9kbjfuw8q5e.immutable('start', 'soffset', 'finish', 'foffset');\n\n    var exactFromRange = function (simRange) {\n      return type$2.exact(simRange.start(), simRange.soffset(), simRange.finish(), simRange.foffset());\n    };\n\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return $_xbeoqkkjfuw8q73.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, finishSitu) {\n          return $_cuk0n0ovjfuw8r0r.getStart(startSitu);\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return start;\n        }\n      });\n    };\n\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return $_s8scrkmjfuw8q7a.defaultView(start);\n    };\n\n    var $_bv1jwpoujfuw8r0m = {\n      domRange: type$2.domRange,\n      relative: type$2.relative,\n      exact: type$2.exact,\n      exactFromRange: exactFromRange,\n      range: range$2,\n      getWin: getWin\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = $_s8scrkmjfuw8q7a.owner(start);\n      var rng = doc.dom().createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n\n    var commonAncestorContainer = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      return $_xbeoqkkjfuw8q73.fromDom(r.commonAncestorContainer);\n    };\n\n    var after$2 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = $_e8rn66kojfuw8q7n.eq(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var $_5xef0moxjfuw8r17 = {\n      after: after$2,\n      commonAncestorContainer: commonAncestorContainer\n    };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || document;\n      var fragment = doc.createDocumentFragment();\n      $_tyr3yk5jfuw8q47.each(elements, function (element) {\n        fragment.appendChild(element.dom());\n      });\n      return $_xbeoqkkjfuw8q73.fromDom(fragment);\n    };\n\n    var $_8a834noyjfuw8r19 = {\n      fromElements: fromElements\n    };\n\n    var selectNodeContents = function (win, element) {\n      var rng = win.document.createRange();\n      selectNodeContentsUsing(rng, element);\n      return rng;\n    };\n\n    var selectNodeContentsUsing = function (rng, element) {\n      rng.selectNodeContents(element.dom());\n    };\n\n    var isWithin$1 = function (outerRange, innerRange) {\n      return innerRange.compareBoundaryPoints(outerRange.END_TO_START, outerRange) < 1 && innerRange.compareBoundaryPoints(outerRange.START_TO_END, outerRange) > -1;\n    };\n\n    var create$1 = function (win) {\n      return win.document.createRange();\n    };\n\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom());\n      }, function (e, o) {\n        rng.setStart(e.dom(), o);\n      }, function (e) {\n        rng.setStartAfter(e.dom());\n      });\n    };\n\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom());\n      }, function (e, o) {\n        rng.setEnd(e.dom(), o);\n      }, function (e) {\n        rng.setEndAfter(e.dom());\n      });\n    };\n\n    var replaceWith = function (rng, fragment) {\n      deleteContents(rng);\n      rng.insertNode(fragment.dom());\n    };\n\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom(), soffset);\n      rng.setEnd(finish.dom(), foffset);\n      return rng;\n    };\n\n    var deleteContents = function (rng) {\n      rng.deleteContents();\n    };\n\n    var cloneFragment = function (rng) {\n      var fragment = rng.cloneContents();\n      return $_xbeoqkkjfuw8q73.fromDom(fragment);\n    };\n\n    var toRect = function (rect) {\n      return {\n        left: $_20nfr6k7jfuw8q4g.constant(rect.left),\n        top: $_20nfr6k7jfuw8q4g.constant(rect.top),\n        right: $_20nfr6k7jfuw8q4g.constant(rect.right),\n        bottom: $_20nfr6k7jfuw8q4g.constant(rect.bottom),\n        width: $_20nfr6k7jfuw8q4g.constant(rect.width),\n        height: $_20nfr6k7jfuw8q4g.constant(rect.height)\n      };\n    };\n\n    var getFirstRect = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Option.some(rect).map(toRect) : Option.none();\n    };\n\n    var getBounds$1 = function (rng) {\n      var rect = rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Option.some(rect).map(toRect) : Option.none();\n    };\n\n    var toString = function (rng) {\n      return rng.toString();\n    };\n\n    var $_dkhwcmozjfuw8r1d = {\n      create: create$1,\n      replaceWith: replaceWith,\n      selectNodeContents: selectNodeContents,\n      selectNodeContentsUsing: selectNodeContentsUsing,\n      relativeToNative: relativeToNative,\n      exactToNative: exactToNative,\n      deleteContents: deleteContents,\n      cloneFragment: cloneFragment,\n      getFirstRect: getFirstRect,\n      getBounds: getBounds$1,\n      isWithin: isWithin$1,\n      toString: toString\n    };\n    var adt$1 = $_7sbzam7jfuw8qgu.generate([{\n      ltr: ['start', 'soffset', 'finish', 'foffset']\n    }, {\n      rtl: ['start', 'soffset', 'finish', 'foffset']\n    }]);\n\n    var fromRange = function (win, type, range) {\n      return type($_xbeoqkkjfuw8q73.fromDom(range.startContainer), range.startOffset, $_xbeoqkkjfuw8q73.fromDom(range.endContainer), range.endOffset);\n    };\n\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: $_20nfr6k7jfuw8q4g.constant(rng),\n            rtl: Option.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: $_cfqymdkujfuw8q85.cached(function () {\n              return $_dkhwcmozjfuw8r1d.relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: $_cfqymdkujfuw8q85.cached(function () {\n              return Option.some($_dkhwcmozjfuw8r1d.relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: $_cfqymdkujfuw8q85.cached(function () {\n              return $_dkhwcmozjfuw8r1d.exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: $_cfqymdkujfuw8q85.cached(function () {\n              return Option.some($_dkhwcmozjfuw8r1d.exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$1.rtl($_xbeoqkkjfuw8q73.fromDom(rev.endContainer), rev.endOffset, $_xbeoqkkjfuw8q73.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$1.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$1.ltr, rng);\n      }\n    };\n\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom(), soffset);\n          rng.setEnd(finish.dom(), foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom(), foffset);\n          rng.setEnd(start.dom(), soffset);\n          return rng;\n        }\n      });\n    };\n\n    var $_c9xxrpp0jfuw8r1k = {\n      ltr: adt$1.ltr,\n      rtl: adt$1.rtl,\n      diagnose: diagnose,\n      asLtrRange: asLtrRange\n    };\n\n    var searchForPoint = function (rectForOffset, x, y, maxX, length) {\n      if (length === 0) return 0;else if (x === maxX) return length - 1;\n      var xDelta = maxX;\n\n      for (var i = 1; i < length; i++) {\n        var rect = rectForOffset(i);\n        var curDeltaX = Math.abs(x - rect.left);\n\n        if (y > rect.bottom) {} else if (y < rect.top || curDeltaX > xDelta) {\n          return i - 1;\n        } else {\n          xDelta = curDeltaX;\n        }\n      }\n\n      return 0;\n    };\n\n    var inRect = function (rect, x, y) {\n      return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n    };\n\n    var $_4j2zpup3jfuw8r2b = {\n      inRect: inRect,\n      searchForPoint: searchForPoint\n    };\n\n    var locateOffset = function (doc, textnode, x, y, rect) {\n      var rangeForOffset = function (offset) {\n        var r = doc.dom().createRange();\n        r.setStart(textnode.dom(), offset);\n        r.collapse(true);\n        return r;\n      };\n\n      var rectForOffset = function (offset) {\n        var r = rangeForOffset(offset);\n        return r.getBoundingClientRect();\n      };\n\n      var length = $_6j8y7blnjfuw8qc3.get(textnode).length;\n      var offset = $_4j2zpup3jfuw8r2b.searchForPoint(rectForOffset, x, y, rect.right, length);\n      return rangeForOffset(offset);\n    };\n\n    var locate = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rects = r.getClientRects();\n      var foundRect = $_cul8qomvjfuw8qm7.findMap(rects, function (rect) {\n        return $_4j2zpup3jfuw8r2b.inRect(rect, x, y) ? Option.some(rect) : Option.none();\n      });\n      return foundRect.map(function (rect) {\n        return locateOffset(doc, node, x, y, rect);\n      });\n    };\n\n    var $_11d3zhp4jfuw8r2c = {\n      locate: locate\n    };\n\n    var searchInChildren = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      var nodes = $_s8scrkmjfuw8q7a.children(node);\n      return $_cul8qomvjfuw8qm7.findMap(nodes, function (n) {\n        r.selectNode(n.dom());\n        return $_4j2zpup3jfuw8r2b.inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Option.none();\n      });\n    };\n\n    var locateNode = function (doc, node, x, y) {\n      var locator = $_a8gk30l6jfuw8q9c.isText(node) ? $_11d3zhp4jfuw8r2c.locate : searchInChildren;\n      return locator(doc, node, x, y);\n    };\n\n    var locate$1 = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return locateNode(doc, node, boundedX, boundedY);\n    };\n\n    var $_6f632yp2jfuw8r25 = {\n      locate: locate$1\n    };\n    var COLLAPSE_TO_LEFT = true;\n    var COLLAPSE_TO_RIGHT = false;\n\n    var getCollapseDirection = function (rect, x) {\n      return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n    };\n\n    var createCollapsedNode = function (doc, target, collapseDirection) {\n      var r = doc.dom().createRange();\n      r.selectNode(target.dom());\n      r.collapse(collapseDirection);\n      return r;\n    };\n\n    var locateInElement = function (doc, node, x) {\n      var cursorRange = doc.dom().createRange();\n      cursorRange.selectNode(node.dom());\n      var rect = cursorRange.getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      var f = collapseDirection === COLLAPSE_TO_LEFT ? $_ejrzj4lljfuw8qbw.first : $_ejrzj4lljfuw8qbw.last;\n      return f(node).map(function (target) {\n        return createCollapsedNode(doc, target, collapseDirection);\n      });\n    };\n\n    var locateInEmpty = function (doc, node, x) {\n      var rect = node.dom().getBoundingClientRect();\n      var collapseDirection = getCollapseDirection(rect, x);\n      return Option.some(createCollapsedNode(doc, node, collapseDirection));\n    };\n\n    var search = function (doc, node, x) {\n      var f = $_s8scrkmjfuw8q7a.children(node).length === 0 ? locateInEmpty : locateInElement;\n      return f(doc, node, x);\n    };\n\n    var $_azsqu2p5jfuw8r2i = {\n      search: search\n    };\n\n    var caretPositionFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretPositionFromPoint(x, y)).bind(function (pos) {\n        if (pos.offsetNode === null) return Option.none();\n        var r = doc.dom().createRange();\n        r.setStart(pos.offsetNode, pos.offset);\n        r.collapse();\n        return Option.some(r);\n      });\n    };\n\n    var caretRangeFromPoint = function (doc, x, y) {\n      return Option.from(doc.dom().caretRangeFromPoint(x, y));\n    };\n\n    var searchTextNodes = function (doc, node, x, y) {\n      var r = doc.dom().createRange();\n      r.selectNode(node.dom());\n      var rect = r.getBoundingClientRect();\n      var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n      var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n      return $_6f632yp2jfuw8r25.locate(doc, node, boundedX, boundedY);\n    };\n\n    var searchFromPoint = function (doc, x, y) {\n      return $_xbeoqkkjfuw8q73.fromPoint(doc, x, y).bind(function (elem) {\n        var fallback = function () {\n          return $_azsqu2p5jfuw8r2i.search(doc, elem, x);\n        };\n\n        return $_s8scrkmjfuw8q7a.children(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n      });\n    };\n\n    var availableSearch = document.caretPositionFromPoint ? caretPositionFromPoint : document.caretRangeFromPoint ? caretRangeFromPoint : searchFromPoint;\n\n    var fromPoint$1 = function (win, x, y) {\n      var doc = $_xbeoqkkjfuw8q73.fromDom(win.document);\n      return availableSearch(doc, x, y).map(function (rng) {\n        return $_bv1jwpoujfuw8r0m.range($_xbeoqkkjfuw8q73.fromDom(rng.startContainer), rng.startOffset, $_xbeoqkkjfuw8q73.fromDom(rng.endContainer), rng.endOffset);\n      });\n    };\n\n    var $_lw04hp1jfuw8r1v = {\n      fromPoint: fromPoint$1\n    };\n\n    var withinContainer = function (win, ancestor, outerRange, selector) {\n      var innerRange = $_dkhwcmozjfuw8r1d.create(win);\n      var self = $_enn9uikjjfuw8q6w.is(ancestor, selector) ? [ancestor] : [];\n      var elements = self.concat($_6c9d0hl7jfuw8q9d.descendants(ancestor, selector));\n      return $_tyr3yk5jfuw8q47.filter(elements, function (elem) {\n        $_dkhwcmozjfuw8r1d.selectNodeContentsUsing(innerRange, elem);\n        return $_dkhwcmozjfuw8r1d.isWithin(outerRange, innerRange);\n      });\n    };\n\n    var find$3 = function (win, selection, selector) {\n      var outerRange = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      var ancestor = $_xbeoqkkjfuw8q73.fromDom(outerRange.commonAncestorContainer);\n      return $_a8gk30l6jfuw8q9c.isElement(ancestor) ? withinContainer(win, ancestor, outerRange, selector) : [];\n    };\n\n    var $_7efy22p6jfuw8r2m = {\n      find: find$3\n    };\n\n    var beforeSpecial = function (element, offset) {\n      var name = $_a8gk30l6jfuw8q9c.name(element);\n      if ('input' === name) return $_cuk0n0ovjfuw8r0r.after(element);else if (!$_tyr3yk5jfuw8q47.contains(['br', 'img'], name)) return $_cuk0n0ovjfuw8r0r.on(element, offset);else return offset === 0 ? $_cuk0n0ovjfuw8r0r.before(element) : $_cuk0n0ovjfuw8r0r.after(element);\n    };\n\n    var preprocessRelative = function (startSitu, finishSitu) {\n      var start = startSitu.fold($_cuk0n0ovjfuw8r0r.before, beforeSpecial, $_cuk0n0ovjfuw8r0r.after);\n      var finish = finishSitu.fold($_cuk0n0ovjfuw8r0r.before, beforeSpecial, $_cuk0n0ovjfuw8r0r.after);\n      return $_bv1jwpoujfuw8r0m.relative(start, finish);\n    };\n\n    var preprocessExact = function (start, soffset, finish, foffset) {\n      var startSitu = beforeSpecial(start, soffset);\n      var finishSitu = beforeSpecial(finish, foffset);\n      return $_bv1jwpoujfuw8r0m.relative(startSitu, finishSitu);\n    };\n\n    var preprocess = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          var start = $_xbeoqkkjfuw8q73.fromDom(rng.startContainer);\n          var finish = $_xbeoqkkjfuw8q73.fromDom(rng.endContainer);\n          return preprocessExact(start, rng.startOffset, finish, rng.endOffset);\n        },\n        relative: preprocessRelative,\n        exact: preprocessExact\n      });\n    };\n\n    var $_cjts8ap7jfuw8r2q = {\n      beforeSpecial: beforeSpecial,\n      preprocess: preprocess,\n      preprocessRelative: preprocessRelative,\n      preprocessExact: preprocessExact\n    };\n\n    var doSetNativeRange = function (win, rng) {\n      Option.from(win.getSelection()).each(function (selection) {\n        selection.removeAllRanges();\n        selection.addRange(rng);\n      });\n    };\n\n    var doSetRange = function (win, start, soffset, finish, foffset) {\n      var rng = $_dkhwcmozjfuw8r1d.exactToNative(win, start, soffset, finish, foffset);\n      doSetNativeRange(win, rng);\n    };\n\n    var findWithin = function (win, selection, selector) {\n      return $_7efy22p6jfuw8r2m.find(win, selection, selector);\n    };\n\n    var setRangeFromRelative = function (win, relative) {\n      return $_c9xxrpp0jfuw8r1k.diagnose(win, relative).match({\n        ltr: function (start, soffset, finish, foffset) {\n          doSetRange(win, start, soffset, finish, foffset);\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var selection = win.getSelection();\n\n          if (selection.setBaseAndExtent) {\n            selection.setBaseAndExtent(start.dom(), soffset, finish.dom(), foffset);\n          } else if (selection.extend) {\n            selection.collapse(start.dom(), soffset);\n            selection.extend(finish.dom(), foffset);\n          } else {\n            doSetRange(win, finish, foffset, start, soffset);\n          }\n        }\n      });\n    };\n\n    var setExact = function (win, start, soffset, finish, foffset) {\n      var relative = $_cjts8ap7jfuw8r2q.preprocessExact(start, soffset, finish, foffset);\n      setRangeFromRelative(win, relative);\n    };\n\n    var setRelative = function (win, startSitu, finishSitu) {\n      var relative = $_cjts8ap7jfuw8r2q.preprocessRelative(startSitu, finishSitu);\n      setRangeFromRelative(win, relative);\n    };\n\n    var toNative = function (selection) {\n      var win = $_bv1jwpoujfuw8r0m.getWin(selection).dom();\n\n      var getDomRange = function (start, soffset, finish, foffset) {\n        return $_dkhwcmozjfuw8r1d.exactToNative(win, start, soffset, finish, foffset);\n      };\n\n      var filtered = $_cjts8ap7jfuw8r2q.preprocess(selection);\n      return $_c9xxrpp0jfuw8r1k.diagnose(win, filtered).match({\n        ltr: getDomRange,\n        rtl: getDomRange\n      });\n    };\n\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Option.some($_bv1jwpoujfuw8r0m.range($_xbeoqkkjfuw8q73.fromDom(firstRng.startContainer), firstRng.startOffset, $_xbeoqkkjfuw8q73.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Option.none();\n      }\n    };\n\n    var doGetExact = function (selection) {\n      var anchorNode = $_xbeoqkkjfuw8q73.fromDom(selection.anchorNode);\n      var focusNode = $_xbeoqkkjfuw8q73.fromDom(selection.focusNode);\n      return $_5xef0moxjfuw8r17.after(anchorNode, selection.anchorOffset, focusNode, selection.focusOffset) ? Option.some($_bv1jwpoujfuw8r0m.range($_xbeoqkkjfuw8q73.fromDom(selection.anchorNode), selection.anchorOffset, $_xbeoqkkjfuw8q73.fromDom(selection.focusNode), selection.focusOffset)) : readRange(selection);\n    };\n\n    var setToElement = function (win, element) {\n      var rng = $_dkhwcmozjfuw8r1d.selectNodeContents(win, element);\n      doSetNativeRange(win, rng);\n    };\n\n    var forElement = function (win, element) {\n      var rng = $_dkhwcmozjfuw8r1d.selectNodeContents(win, element);\n      return $_bv1jwpoujfuw8r0m.range($_xbeoqkkjfuw8q73.fromDom(rng.startContainer), rng.startOffset, $_xbeoqkkjfuw8q73.fromDom(rng.endContainer), rng.endOffset);\n    };\n\n    var getExact = function (win) {\n      var selection = win.getSelection();\n      return selection.rangeCount > 0 ? doGetExact(selection) : Option.none();\n    };\n\n    var get$9 = function (win) {\n      return getExact(win).map(function (range) {\n        return $_bv1jwpoujfuw8r0m.exact(range.start(), range.soffset(), range.finish(), range.foffset());\n      });\n    };\n\n    var getFirstRect$1 = function (win, selection) {\n      var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      return $_dkhwcmozjfuw8r1d.getFirstRect(rng);\n    };\n\n    var getBounds$2 = function (win, selection) {\n      var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      return $_dkhwcmozjfuw8r1d.getBounds(rng);\n    };\n\n    var getAtPoint = function (win, x, y) {\n      return $_lw04hp1jfuw8r1v.fromPoint(win, x, y);\n    };\n\n    var getAsString = function (win, selection) {\n      var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      return $_dkhwcmozjfuw8r1d.toString(rng);\n    };\n\n    var clear$1 = function (win) {\n      var selection = win.getSelection();\n      selection.removeAllRanges();\n    };\n\n    var clone$2 = function (win, selection) {\n      var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      return $_dkhwcmozjfuw8r1d.cloneFragment(rng);\n    };\n\n    var replace$1 = function (win, selection, elements) {\n      var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      var fragment = $_8a834noyjfuw8r19.fromElements(elements, win.document);\n      $_dkhwcmozjfuw8r1d.replaceWith(rng, fragment);\n    };\n\n    var deleteAt = function (win, selection) {\n      var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      $_dkhwcmozjfuw8r1d.deleteContents(rng);\n    };\n\n    var isCollapsed = function (start, soffset, finish, foffset) {\n      return $_e8rn66kojfuw8q7n.eq(start, finish) && soffset === foffset;\n    };\n\n    var $_3gcdhqowjfuw8r11 = {\n      setExact: setExact,\n      getExact: getExact,\n      get: get$9,\n      setRelative: setRelative,\n      toNative: toNative,\n      setToElement: setToElement,\n      clear: clear$1,\n      clone: clone$2,\n      replace: replace$1,\n      deleteAt: deleteAt,\n      forElement: forElement,\n      getFirstRect: getFirstRect$1,\n      getBounds: getBounds$2,\n      getAtPoint: getAtPoint,\n      findWithin: findWithin,\n      getAsString: getAsString,\n      isCollapsed: isCollapsed\n    };\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var forward = function (editor, isRoot, cell, lazyWire) {\n      return go(editor, isRoot, $_947ovkosjfuw8r0c.next(cell), lazyWire);\n    };\n\n    var backward = function (editor, isRoot, cell, lazyWire) {\n      return go(editor, isRoot, $_947ovkosjfuw8r0c.prev(cell), lazyWire);\n    };\n\n    var getCellFirstCursorPosition = function (editor, cell) {\n      var selection = $_bv1jwpoujfuw8r0m.exact(cell, 0, cell, 0);\n      return $_3gcdhqowjfuw8r11.toNative(selection);\n    };\n\n    var getNewRowCursorPosition = function (editor, table) {\n      var rows = $_6c9d0hl7jfuw8q9d.descendants(table, 'tr');\n      return $_tyr3yk5jfuw8q47.last(rows).bind(function (last) {\n        return $_8wdrbmlajfuw8q9m.descendant(last, 'td,th').map(function (first) {\n          return getCellFirstCursorPosition(editor, first);\n        });\n      });\n    };\n\n    var go = function (editor, isRoot, cell, actions, lazyWire) {\n      return cell.fold(Option.none, Option.none, function (current, next) {\n        return $_ejrzj4lljfuw8qbw.first(next).map(function (cell) {\n          return getCellFirstCursorPosition(editor, cell);\n        });\n      }, function (current) {\n        return $_aqhz9okhjfuw8q5y.table(current, isRoot).bind(function (table) {\n          var targets = $_5b7h1hlqjfuw8qci.noMenu(current);\n          editor.undoManager.transact(function () {\n            actions.insertRowsAfter(table, targets);\n          });\n          return getNewRowCursorPosition(editor, table);\n        });\n      });\n    };\n\n    var rootElements = ['table', 'li', 'dl'];\n\n    var handle$1 = function (event, editor, actions, lazyWire) {\n      if (event.keyCode === global$4.TAB) {\n        var body_1 = $_5xkhf2nnjfuw8qrq.getBody(editor);\n\n        var isRoot_1 = function (element) {\n          var name = $_a8gk30l6jfuw8q9c.name(element);\n          return $_e8rn66kojfuw8q7n.eq(element, body_1) || $_tyr3yk5jfuw8q47.contains(rootElements, name);\n        };\n\n        var rng = editor.selection.getRng();\n\n        if (rng.collapsed) {\n          var start = $_xbeoqkkjfuw8q73.fromDom(rng.startContainer);\n          $_aqhz9okhjfuw8q5y.cell(start, isRoot_1).each(function (cell) {\n            event.preventDefault();\n            var navigation = event.shiftKey ? backward : forward;\n            var rng = navigation(editor, isRoot_1, cell, actions, lazyWire);\n            rng.each(function (range) {\n              editor.selection.setRng(range);\n            });\n          });\n        }\n      }\n    };\n\n    var $_djb8ceorjfuw8qzt = {\n      handle: handle$1\n    };\n    var response = $_5now9kbjfuw8q5e.immutable('selection', 'kill');\n    var $_b7ap4hpbjfuw8r3x = {\n      response: response\n    };\n\n    var isKey = function (key) {\n      return function (keycode) {\n        return keycode === key;\n      };\n    };\n\n    var isUp = isKey(38);\n    var isDown = isKey(40);\n\n    var isNavigation = function (keycode) {\n      return keycode >= 37 && keycode <= 40;\n    };\n\n    var $_9n04otpcjfuw8r40 = {\n      ltr: {\n        isBackward: isKey(37),\n        isForward: isKey(39)\n      },\n      rtl: {\n        isBackward: isKey(39),\n        isForward: isKey(37)\n      },\n      isUp: isUp,\n      isDown: isDown,\n      isNavigation: isNavigation\n    };\n\n    var convertToRange = function (win, selection) {\n      var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, selection);\n      return {\n        start: $_20nfr6k7jfuw8q4g.constant($_xbeoqkkjfuw8q73.fromDom(rng.startContainer)),\n        soffset: $_20nfr6k7jfuw8q4g.constant(rng.startOffset),\n        finish: $_20nfr6k7jfuw8q4g.constant($_xbeoqkkjfuw8q73.fromDom(rng.endContainer)),\n        foffset: $_20nfr6k7jfuw8q4g.constant(rng.endOffset)\n      };\n    };\n\n    var makeSitus = function (start, soffset, finish, foffset) {\n      return {\n        start: $_20nfr6k7jfuw8q4g.constant($_cuk0n0ovjfuw8r0r.on(start, soffset)),\n        finish: $_20nfr6k7jfuw8q4g.constant($_cuk0n0ovjfuw8r0r.on(finish, foffset))\n      };\n    };\n\n    var $_81eh29pejfuw8r4k = {\n      convertToRange: convertToRange,\n      makeSitus: makeSitus\n    };\n    var isSafari = $_fqgee0ktjfuw8q83.detect().browser.isSafari();\n\n    var get$10 = function (_doc) {\n      var doc = _doc !== undefined ? _doc.dom() : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return r(x, y);\n    };\n\n    var to = function (x, y, _doc) {\n      var doc = _doc !== undefined ? _doc.dom() : document;\n      var win = doc.defaultView;\n      win.scrollTo(x, y);\n    };\n\n    var by = function (x, y, _doc) {\n      var doc = _doc !== undefined ? _doc.dom() : document;\n      var win = doc.defaultView;\n      win.scrollBy(x, y);\n    };\n\n    var setToElement$1 = function (win, element) {\n      var pos = $_hsvzlmijfuw8qj4.absolute(element);\n      var doc = $_xbeoqkkjfuw8q73.fromDom(win.document);\n      to(pos.left(), pos.top(), doc);\n    };\n\n    var preserve$1 = function (doc, f) {\n      var before = get$10(doc);\n      f();\n      var after = get$10(doc);\n\n      if (before.top() !== after.top() || before.left() !== after.left()) {\n        to(before.left(), before.top(), doc);\n      }\n    };\n\n    var capture$2 = function (doc) {\n      var previous = Option.none();\n\n      var save = function () {\n        previous = Option.some(get$10(doc));\n      };\n\n      var restore = function () {\n        previous.each(function (p) {\n          to(p.left(), p.top(), doc);\n        });\n      };\n\n      save();\n      return {\n        save: save,\n        restore: restore\n      };\n    };\n\n    var intoView = function (element, alignToTop) {\n      if (isSafari && $_g6mvnrk8jfuw8q4k.isFunction(element.dom().scrollIntoViewIfNeeded)) {\n        element.dom().scrollIntoViewIfNeeded(false);\n      } else {\n        element.dom().scrollIntoView(alignToTop);\n      }\n    };\n\n    var intoViewIfNeeded = function (element, container) {\n      var containerBox = container.dom().getBoundingClientRect();\n      var elementBox = element.dom().getBoundingClientRect();\n\n      if (elementBox.top < containerBox.top) {\n        intoView(element, true);\n      } else if (elementBox.bottom > containerBox.bottom) {\n        intoView(element, false);\n      }\n    };\n\n    var scrollBarWidth = function () {\n      var scrollDiv = $_xbeoqkkjfuw8q73.fromHtml('<div style=\"width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;\"></div>');\n      $_fatuxylgjfuw8qav.after($_atd1tul9jfuw8q9i.body(), scrollDiv);\n      var w = scrollDiv.dom().offsetWidth - scrollDiv.dom().clientWidth;\n      $_fl1deelhjfuw8qax.remove(scrollDiv);\n      return w;\n    };\n\n    var $_xvhf9pfjfuw8r51 = {\n      get: get$10,\n      to: to,\n      by: by,\n      preserve: preserve$1,\n      capture: capture$2,\n      intoView: intoView,\n      intoViewIfNeeded: intoViewIfNeeded,\n      setToElement: setToElement$1,\n      scrollBarWidth: scrollBarWidth\n    };\n\n    function WindowBridge(win) {\n      var elementFromPoint = function (x, y) {\n        return Option.from(win.document.elementFromPoint(x, y)).map($_xbeoqkkjfuw8q73.fromDom);\n      };\n\n      var getRect = function (element) {\n        return element.dom().getBoundingClientRect();\n      };\n\n      var getRangedRect = function (start, soffset, finish, foffset) {\n        var sel = $_bv1jwpoujfuw8r0m.exact(start, soffset, finish, foffset);\n        return $_3gcdhqowjfuw8r11.getFirstRect(win, sel).map(function (structRect) {\n          return $_11yiupkajfuw8q5c.map(structRect, $_20nfr6k7jfuw8q4g.apply);\n        });\n      };\n\n      var getSelection = function () {\n        return $_3gcdhqowjfuw8r11.get(win).map(function (exactAdt) {\n          return $_81eh29pejfuw8r4k.convertToRange(win, exactAdt);\n        });\n      };\n\n      var fromSitus = function (situs) {\n        var relative = $_bv1jwpoujfuw8r0m.relative(situs.start(), situs.finish());\n        return $_81eh29pejfuw8r4k.convertToRange(win, relative);\n      };\n\n      var situsFromPoint = function (x, y) {\n        return $_3gcdhqowjfuw8r11.getAtPoint(win, x, y).map(function (exact) {\n          return {\n            start: $_20nfr6k7jfuw8q4g.constant($_cuk0n0ovjfuw8r0r.on(exact.start(), exact.soffset())),\n            finish: $_20nfr6k7jfuw8q4g.constant($_cuk0n0ovjfuw8r0r.on(exact.finish(), exact.foffset()))\n          };\n        });\n      };\n\n      var clearSelection = function () {\n        $_3gcdhqowjfuw8r11.clear(win);\n      };\n\n      var selectContents = function (element) {\n        $_3gcdhqowjfuw8r11.setToElement(win, element);\n      };\n\n      var setSelection = function (sel) {\n        $_3gcdhqowjfuw8r11.setExact(win, sel.start(), sel.soffset(), sel.finish(), sel.foffset());\n      };\n\n      var setRelativeSelection = function (start, finish) {\n        $_3gcdhqowjfuw8r11.setRelative(win, start, finish);\n      };\n\n      var getInnerHeight = function () {\n        return win.innerHeight;\n      };\n\n      var getScrollY = function () {\n        var pos = $_xvhf9pfjfuw8r51.get($_xbeoqkkjfuw8q73.fromDom(win.document));\n        return pos.top();\n      };\n\n      var scrollBy = function (x, y) {\n        $_xvhf9pfjfuw8r51.by(x, y, $_xbeoqkkjfuw8q73.fromDom(win.document));\n      };\n\n      return {\n        elementFromPoint: elementFromPoint,\n        getRect: getRect,\n        getRangedRect: getRangedRect,\n        getSelection: getSelection,\n        fromSitus: fromSitus,\n        situsFromPoint: situsFromPoint,\n        clearSelection: clearSelection,\n        setSelection: setSelection,\n        setRelativeSelection: setRelativeSelection,\n        selectContents: selectContents,\n        getInnerHeight: getInnerHeight,\n        getScrollY: getScrollY,\n        scrollBy: scrollBy\n      };\n    }\n\n    var sync = function (container, isRoot, start, soffset, finish, foffset, selectRange) {\n      if (!($_e8rn66kojfuw8q7n.eq(start, finish) && soffset === foffset)) {\n        return $_8wdrbmlajfuw8q9m.closest(start, 'td,th', isRoot).bind(function (s) {\n          return $_8wdrbmlajfuw8q9m.closest(finish, 'td,th', isRoot).bind(function (f) {\n            return detect$5(container, isRoot, s, f, selectRange);\n          });\n        });\n      } else {\n        return Option.none();\n      }\n    };\n\n    var detect$5 = function (container, isRoot, start, finish, selectRange) {\n      if (!$_e8rn66kojfuw8q7n.eq(start, finish)) {\n        return $_dpd405ltjfuw8qd8.identify(start, finish, isRoot).bind(function (cellSel) {\n          var boxes = cellSel.boxes().getOr([]);\n\n          if (boxes.length > 0) {\n            selectRange(container, boxes, cellSel.start(), cellSel.finish());\n            return Option.some($_b7ap4hpbjfuw8r3x.response(Option.some($_81eh29pejfuw8r4k.makeSitus(start, 0, start, $_6vfowrlmjfuw8qbz.getEnd(start))), true));\n          } else {\n            return Option.none();\n          }\n        });\n      } else {\n        return Option.none();\n      }\n    };\n\n    var update = function (rows, columns, container, selected, annotations) {\n      var updateSelection = function (newSels) {\n        annotations.clear(container);\n        annotations.selectRange(container, newSels.boxes(), newSels.start(), newSels.finish());\n        return newSels.boxes();\n      };\n\n      return $_dpd405ltjfuw8qd8.shiftSelection(selected, rows, columns, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(updateSelection);\n    };\n\n    var $_7ulhzpgjfuw8r5b = {\n      sync: sync,\n      detect: detect$5,\n      update: update\n    };\n    var nu$3 = $_5now9kbjfuw8q5e.immutableBag(['left', 'top', 'right', 'bottom'], []);\n\n    var moveDown = function (caret, amount) {\n      return nu$3({\n        left: caret.left(),\n        top: caret.top() + amount,\n        right: caret.right(),\n        bottom: caret.bottom() + amount\n      });\n    };\n\n    var moveUp = function (caret, amount) {\n      return nu$3({\n        left: caret.left(),\n        top: caret.top() - amount,\n        right: caret.right(),\n        bottom: caret.bottom() - amount\n      });\n    };\n\n    var moveBottomTo = function (caret, bottom) {\n      var height = caret.bottom() - caret.top();\n      return nu$3({\n        left: caret.left(),\n        top: bottom - height,\n        right: caret.right(),\n        bottom: bottom\n      });\n    };\n\n    var moveTopTo = function (caret, top) {\n      var height = caret.bottom() - caret.top();\n      return nu$3({\n        left: caret.left(),\n        top: top,\n        right: caret.right(),\n        bottom: top + height\n      });\n    };\n\n    var translate = function (caret, xDelta, yDelta) {\n      return nu$3({\n        left: caret.left() + xDelta,\n        top: caret.top() + yDelta,\n        right: caret.right() + xDelta,\n        bottom: caret.bottom() + yDelta\n      });\n    };\n\n    var getTop$1 = function (caret) {\n      return caret.top();\n    };\n\n    var getBottom = function (caret) {\n      return caret.bottom();\n    };\n\n    var toString$1 = function (caret) {\n      return '(' + caret.left() + ', ' + caret.top() + ') -> (' + caret.right() + ', ' + caret.bottom() + ')';\n    };\n\n    var $_37xezepjjfuw8r6q = {\n      nu: nu$3,\n      moveUp: moveUp,\n      moveDown: moveDown,\n      moveBottomTo: moveBottomTo,\n      moveTopTo: moveTopTo,\n      getTop: getTop$1,\n      getBottom: getBottom,\n      translate: translate,\n      toString: toString$1\n    };\n\n    var getPartialBox = function (bridge, element, offset) {\n      if (offset >= 0 && offset < $_6vfowrlmjfuw8qbz.getEnd(element)) return bridge.getRangedRect(element, offset, element, offset + 1);else if (offset > 0) return bridge.getRangedRect(element, offset - 1, element, offset);\n      return Option.none();\n    };\n\n    var toCaret = function (rect) {\n      return $_37xezepjjfuw8r6q.nu({\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom\n      });\n    };\n\n    var getElemBox = function (bridge, element) {\n      return Option.some(bridge.getRect(element));\n    };\n\n    var getBoxAt = function (bridge, element, offset) {\n      if ($_a8gk30l6jfuw8q9c.isElement(element)) return getElemBox(bridge, element).map(toCaret);else if ($_a8gk30l6jfuw8q9c.isText(element)) return getPartialBox(bridge, element, offset).map(toCaret);else return Option.none();\n    };\n\n    var getEntireBox = function (bridge, element) {\n      if ($_a8gk30l6jfuw8q9c.isElement(element)) return getElemBox(bridge, element).map(toCaret);else if ($_a8gk30l6jfuw8q9c.isText(element)) return bridge.getRangedRect(element, 0, element, $_6vfowrlmjfuw8qbz.getEnd(element)).map(toCaret);else return Option.none();\n    };\n\n    var $_8xl6tpkjfuw8r6u = {\n      getBoxAt: getBoxAt,\n      getEntireBox: getEntireBox\n    };\n    var traverse = $_5now9kbjfuw8q5e.immutable('item', 'mode');\n\n    var backtrack = function (universe, item, direction, _transition) {\n      var transition = _transition !== undefined ? _transition : sidestep;\n      return universe.property().parent(item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n\n    var sidestep = function (universe, item, direction, _transition) {\n      var transition = _transition !== undefined ? _transition : advance;\n      return direction.sibling(universe, item).map(function (p) {\n        return traverse(p, transition);\n      });\n    };\n\n    var advance = function (universe, item, direction, _transition) {\n      var transition = _transition !== undefined ? _transition : advance;\n      var children = universe.property().children(item);\n      var result = direction.first(children);\n      return result.map(function (r) {\n        return traverse(r, transition);\n      });\n    };\n\n    var successors = [{\n      current: backtrack,\n      next: sidestep,\n      fallback: Option.none()\n    }, {\n      current: sidestep,\n      next: advance,\n      fallback: Option.some(backtrack)\n    }, {\n      current: advance,\n      next: advance,\n      fallback: Option.some(sidestep)\n    }];\n\n    var go$1 = function (universe, item, mode, direction, rules) {\n      var rules = rules !== undefined ? rules : successors;\n      var ruleOpt = $_tyr3yk5jfuw8q47.find(rules, function (succ) {\n        return succ.current === mode;\n      });\n      return ruleOpt.bind(function (rule) {\n        return rule.current(universe, item, direction, rule.next).orThunk(function () {\n          return rule.fallback.bind(function (fb) {\n            return go$1(universe, item, fb, direction);\n          });\n        });\n      });\n    };\n\n    var $_12nww3ppjfuw8r7x = {\n      backtrack: backtrack,\n      sidestep: sidestep,\n      advance: advance,\n      go: go$1\n    };\n\n    var left$1 = function () {\n      var sibling = function (universe, item) {\n        return universe.query().prevSibling(item);\n      };\n\n      var first = function (children) {\n        return children.length > 0 ? Option.some(children[children.length - 1]) : Option.none();\n      };\n\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n\n    var right$1 = function () {\n      var sibling = function (universe, item) {\n        return universe.query().nextSibling(item);\n      };\n\n      var first = function (children) {\n        return children.length > 0 ? Option.some(children[0]) : Option.none();\n      };\n\n      return {\n        sibling: sibling,\n        first: first\n      };\n    };\n\n    var $_135xakpqjfuw8r85 = {\n      left: left$1,\n      right: right$1\n    };\n\n    var hone = function (universe, item, predicate, mode, direction, isRoot) {\n      var next = $_12nww3ppjfuw8r7x.go(universe, item, mode, direction);\n      return next.bind(function (n) {\n        if (isRoot(n.item())) return Option.none();else return predicate(n.item()) ? Option.some(n.item()) : hone(universe, n.item(), predicate, n.mode(), direction, isRoot);\n      });\n    };\n\n    var left$2 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, $_12nww3ppjfuw8r7x.sidestep, $_135xakpqjfuw8r85.left(), isRoot);\n    };\n\n    var right$2 = function (universe, item, predicate, isRoot) {\n      return hone(universe, item, predicate, $_12nww3ppjfuw8r7x.sidestep, $_135xakpqjfuw8r85.right(), isRoot);\n    };\n\n    var $_6b0zg3pojfuw8r7t = {\n      left: left$2,\n      right: right$2\n    };\n\n    var isLeaf = function (universe, element) {\n      return universe.property().children(element).length === 0;\n    };\n\n    var before$2 = function (universe, item, isRoot) {\n      return seekLeft(universe, item, $_20nfr6k7jfuw8q4g.curry(isLeaf, universe), isRoot);\n    };\n\n    var after$3 = function (universe, item, isRoot) {\n      return seekRight(universe, item, $_20nfr6k7jfuw8q4g.curry(isLeaf, universe), isRoot);\n    };\n\n    var seekLeft = function (universe, item, predicate, isRoot) {\n      return $_6b0zg3pojfuw8r7t.left(universe, item, predicate, isRoot);\n    };\n\n    var seekRight = function (universe, item, predicate, isRoot) {\n      return $_6b0zg3pojfuw8r7t.right(universe, item, predicate, isRoot);\n    };\n\n    var walkers = function () {\n      return {\n        left: $_135xakpqjfuw8r85.left,\n        right: $_135xakpqjfuw8r85.right\n      };\n    };\n\n    var walk = function (universe, item, mode, direction, _rules) {\n      return $_12nww3ppjfuw8r7x.go(universe, item, mode, direction, _rules);\n    };\n\n    var $_fivsmpnjfuw8r7p = {\n      before: before$2,\n      after: after$3,\n      seekLeft: seekLeft,\n      seekRight: seekRight,\n      walkers: walkers,\n      walk: walk,\n      backtrack: $_12nww3ppjfuw8r7x.backtrack,\n      sidestep: $_12nww3ppjfuw8r7x.sidestep,\n      advance: $_12nww3ppjfuw8r7x.advance\n    };\n    var universe$2 = DomUniverse();\n\n    var gather = function (element, prune, transform) {\n      return $_fivsmpnjfuw8r7p.gather(universe$2, element, prune, transform);\n    };\n\n    var before$3 = function (element, isRoot) {\n      return $_fivsmpnjfuw8r7p.before(universe$2, element, isRoot);\n    };\n\n    var after$4 = function (element, isRoot) {\n      return $_fivsmpnjfuw8r7p.after(universe$2, element, isRoot);\n    };\n\n    var seekLeft$1 = function (element, predicate, isRoot) {\n      return $_fivsmpnjfuw8r7p.seekLeft(universe$2, element, predicate, isRoot);\n    };\n\n    var seekRight$1 = function (element, predicate, isRoot) {\n      return $_fivsmpnjfuw8r7p.seekRight(universe$2, element, predicate, isRoot);\n    };\n\n    var walkers$1 = function () {\n      return $_fivsmpnjfuw8r7p.walkers();\n    };\n\n    var walk$1 = function (item, mode, direction, _rules) {\n      return $_fivsmpnjfuw8r7p.walk(universe$2, item, mode, direction, _rules);\n    };\n\n    var $_fgafb6pmjfuw8r7l = {\n      gather: gather,\n      before: before$3,\n      after: after$4,\n      seekLeft: seekLeft$1,\n      seekRight: seekRight$1,\n      walkers: walkers$1,\n      walk: walk$1\n    };\n    var JUMP_SIZE = 5;\n    var NUM_RETRIES = 100;\n    var adt$2 = $_7sbzam7jfuw8qgu.generate([{\n      'none': []\n    }, {\n      'retry': ['caret']\n    }]);\n\n    var isOutside = function (caret, box) {\n      return caret.left() < box.left() || Math.abs(box.right() - caret.left()) < 1 || caret.left() > box.right();\n    };\n\n    var inOutsideBlock = function (bridge, element, caret) {\n      return $_11ympzlbjfuw8q9n.closest(element, $_d9tdqtmrjfuw8ql9.isBlock).fold($_20nfr6k7jfuw8q4g.constant(false), function (cell) {\n        return $_8xl6tpkjfuw8r6u.getEntireBox(bridge, cell).exists(function (box) {\n          return isOutside(caret, box);\n        });\n      });\n    };\n\n    var adjustDown = function (bridge, element, guessBox, original, caret) {\n      var lowerCaret = $_37xezepjjfuw8r6q.moveDown(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.bottom() - original.bottom()) < 1) return adt$2.retry(lowerCaret);else if (guessBox.top() > caret.bottom()) return adt$2.retry(lowerCaret);else if (guessBox.top() === caret.bottom()) return adt$2.retry($_37xezepjjfuw8r6q.moveDown(caret, 1));else return inOutsideBlock(bridge, element, caret) ? adt$2.retry($_37xezepjjfuw8r6q.translate(lowerCaret, JUMP_SIZE, 0)) : adt$2.none();\n    };\n\n    var adjustUp = function (bridge, element, guessBox, original, caret) {\n      var higherCaret = $_37xezepjjfuw8r6q.moveUp(caret, JUMP_SIZE);\n      if (Math.abs(guessBox.top() - original.top()) < 1) return adt$2.retry(higherCaret);else if (guessBox.bottom() < caret.top()) return adt$2.retry(higherCaret);else if (guessBox.bottom() === caret.top()) return adt$2.retry($_37xezepjjfuw8r6q.moveUp(caret, 1));else return inOutsideBlock(bridge, element, caret) ? adt$2.retry($_37xezepjjfuw8r6q.translate(higherCaret, JUMP_SIZE, 0)) : adt$2.none();\n    };\n\n    var upMovement = {\n      point: $_37xezepjjfuw8r6q.getTop,\n      adjuster: adjustUp,\n      move: $_37xezepjjfuw8r6q.moveUp,\n      gather: $_fgafb6pmjfuw8r7l.before\n    };\n    var downMovement = {\n      point: $_37xezepjjfuw8r6q.getBottom,\n      adjuster: adjustDown,\n      move: $_37xezepjjfuw8r6q.moveDown,\n      gather: $_fgafb6pmjfuw8r7l.after\n    };\n\n    var isAtTable = function (bridge, x, y) {\n      return bridge.elementFromPoint(x, y).filter(function (elm) {\n        return $_a8gk30l6jfuw8q9c.name(elm) === 'table';\n      }).isSome();\n    };\n\n    var adjustForTable = function (bridge, movement, original, caret, numRetries) {\n      return adjustTil(bridge, movement, original, movement.move(caret, JUMP_SIZE), numRetries);\n    };\n\n    var adjustTil = function (bridge, movement, original, caret, numRetries) {\n      if (numRetries === 0) return Option.some(caret);\n      if (isAtTable(bridge, caret.left(), movement.point(caret))) return adjustForTable(bridge, movement, original, caret, numRetries - 1);\n      return bridge.situsFromPoint(caret.left(), movement.point(caret)).bind(function (guess) {\n        return guess.start().fold(Option.none, function (element, offset) {\n          return $_8xl6tpkjfuw8r6u.getEntireBox(bridge, element, offset).bind(function (guessBox) {\n            return movement.adjuster(bridge, element, guessBox, original, caret).fold(Option.none, function (newCaret) {\n              return adjustTil(bridge, movement, original, newCaret, numRetries - 1);\n            });\n          }).orThunk(function () {\n            return Option.some(caret);\n          });\n        }, Option.none);\n      });\n    };\n\n    var ieTryDown = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left(), caret.bottom() + JUMP_SIZE);\n    };\n\n    var ieTryUp = function (bridge, caret) {\n      return bridge.situsFromPoint(caret.left(), caret.top() - JUMP_SIZE);\n    };\n\n    var checkScroll = function (movement, adjusted, bridge) {\n      if (movement.point(adjusted) > bridge.getInnerHeight()) return Option.some(movement.point(adjusted) - bridge.getInnerHeight());else if (movement.point(adjusted) < 0) return Option.some(-movement.point(adjusted));else return Option.none();\n    };\n\n    var retry = function (movement, bridge, caret) {\n      var moved = movement.move(caret, JUMP_SIZE);\n      var adjusted = adjustTil(bridge, movement, caret, moved, NUM_RETRIES).getOr(moved);\n      return checkScroll(movement, adjusted, bridge).fold(function () {\n        return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted));\n      }, function (delta) {\n        bridge.scrollBy(0, delta);\n        return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted) - delta);\n      });\n    };\n\n    var $_efciv1pljfuw8r73 = {\n      tryUp: $_20nfr6k7jfuw8q4g.curry(retry, upMovement),\n      tryDown: $_20nfr6k7jfuw8q4g.curry(retry, downMovement),\n      ieTryUp: ieTryUp,\n      ieTryDown: ieTryDown,\n      getJumpSize: $_20nfr6k7jfuw8q4g.constant(JUMP_SIZE)\n    };\n    var adt$3 = $_7sbzam7jfuw8qgu.generate([{\n      'none': ['message']\n    }, {\n      'success': []\n    }, {\n      'failedUp': ['cell']\n    }, {\n      'failedDown': ['cell']\n    }]);\n\n    var isOverlapping = function (bridge, before, after) {\n      var beforeBounds = bridge.getRect(before);\n      var afterBounds = bridge.getRect(after);\n      return afterBounds.right > beforeBounds.left && afterBounds.left < beforeBounds.right;\n    };\n\n    var verify = function (bridge, before, beforeOffset, after, afterOffset, failure, isRoot) {\n      return $_8wdrbmlajfuw8q9m.closest(after, 'td,th', isRoot).bind(function (afterCell) {\n        return $_8wdrbmlajfuw8q9m.closest(before, 'td,th', isRoot).map(function (beforeCell) {\n          if (!$_e8rn66kojfuw8q7n.eq(afterCell, beforeCell)) {\n            return $_583a2nlujfuw8qdw.sharedOne(isRow, [afterCell, beforeCell]).fold(function () {\n              return isOverlapping(bridge, beforeCell, afterCell) ? adt$3.success() : failure(beforeCell);\n            }, function (sharedRow) {\n              return failure(beforeCell);\n            });\n          } else {\n            return $_e8rn66kojfuw8q7n.eq(after, afterCell) && $_6vfowrlmjfuw8qbz.getEnd(afterCell) === afterOffset ? failure(beforeCell) : adt$3.none('in same cell');\n          }\n        });\n      }).getOr(adt$3.none('default'));\n    };\n\n    var isRow = function (elem) {\n      return $_8wdrbmlajfuw8q9m.closest(elem, 'tr');\n    };\n\n    var cata$2 = function (subject, onNone, onSuccess, onFailedUp, onFailedDown) {\n      return subject.fold(onNone, onSuccess, onFailedUp, onFailedDown);\n    };\n\n    var $_25fydhprjfuw8r89 = {\n      verify: verify,\n      cata: cata$2,\n      adt: adt$3\n    };\n    var point = $_5now9kbjfuw8q5e.immutable('element', 'offset');\n    var delta = $_5now9kbjfuw8q5e.immutable('element', 'deltaOffset');\n    var range$3 = $_5now9kbjfuw8q5e.immutable('element', 'start', 'finish');\n    var points = $_5now9kbjfuw8q5e.immutable('begin', 'end');\n    var text = $_5now9kbjfuw8q5e.immutable('element', 'text');\n    var $_1kct4uptjfuw8r98 = {\n      point: point,\n      delta: delta,\n      range: range$3,\n      points: points,\n      text: text\n    };\n    var inAncestor = $_5now9kbjfuw8q5e.immutable('ancestor', 'descendants', 'element', 'index');\n    var inParent = $_5now9kbjfuw8q5e.immutable('parent', 'children', 'element', 'index');\n\n    var childOf = function (element, ancestor) {\n      return $_11ympzlbjfuw8q9n.closest(element, function (elem) {\n        return $_s8scrkmjfuw8q7a.parent(elem).exists(function (parent) {\n          return $_e8rn66kojfuw8q7n.eq(parent, ancestor);\n        });\n      });\n    };\n\n    var indexInParent = function (element) {\n      return $_s8scrkmjfuw8q7a.parent(element).bind(function (parent) {\n        var children = $_s8scrkmjfuw8q7a.children(parent);\n        return indexOf$1(children, element).map(function (index) {\n          return inParent(parent, children, element, index);\n        });\n      });\n    };\n\n    var indexOf$1 = function (elements, element) {\n      return $_tyr3yk5jfuw8q47.findIndex(elements, $_20nfr6k7jfuw8q4g.curry($_e8rn66kojfuw8q7n.eq, element));\n    };\n\n    var selectorsInParent = function (element, selector) {\n      return $_s8scrkmjfuw8q7a.parent(element).bind(function (parent) {\n        var children = $_6c9d0hl7jfuw8q9d.children(parent, selector);\n        return indexOf$1(children, element).map(function (index) {\n          return inParent(parent, children, element, index);\n        });\n      });\n    };\n\n    var descendantsInAncestor = function (element, ancestorSelector, descendantSelector) {\n      return $_8wdrbmlajfuw8q9m.closest(element, ancestorSelector).bind(function (ancestor) {\n        var descendants = $_6c9d0hl7jfuw8q9d.descendants(ancestor, descendantSelector);\n        return indexOf$1(descendants, element).map(function (index) {\n          return inAncestor(ancestor, descendants, element, index);\n        });\n      });\n    };\n\n    var $_cz3gbvpujfuw8r9c = {\n      childOf: childOf,\n      indexOf: indexOf$1,\n      indexInParent: indexInParent,\n      selectorsInParent: selectorsInParent,\n      descendantsInAncestor: descendantsInAncestor\n    };\n\n    var isBr = function (elem) {\n      return $_a8gk30l6jfuw8q9c.name(elem) === 'br';\n    };\n\n    var gatherer = function (cand, gather, isRoot) {\n      return gather(cand, isRoot).bind(function (target) {\n        return $_a8gk30l6jfuw8q9c.isText(target) && $_6j8y7blnjfuw8qc3.get(target).trim().length === 0 ? gatherer(target, gather, isRoot) : Option.some(target);\n      });\n    };\n\n    var handleBr = function (isRoot, element, direction) {\n      return direction.traverse(element).orThunk(function () {\n        return gatherer(element, direction.gather, isRoot);\n      }).map(direction.relative);\n    };\n\n    var findBr = function (element, offset) {\n      return $_s8scrkmjfuw8q7a.child(element, offset).filter(isBr).orThunk(function () {\n        return $_s8scrkmjfuw8q7a.child(element, offset - 1).filter(isBr);\n      });\n    };\n\n    var handleParent = function (isRoot, element, offset, direction) {\n      return findBr(element, offset).bind(function (br) {\n        return direction.traverse(br).fold(function () {\n          return gatherer(br, direction.gather, isRoot).map(direction.relative);\n        }, function (adjacent) {\n          return $_cz3gbvpujfuw8r9c.indexInParent(adjacent).map(function (info) {\n            return $_cuk0n0ovjfuw8r0r.on(info.parent(), info.index());\n          });\n        });\n      });\n    };\n\n    var tryBr = function (isRoot, element, offset, direction) {\n      var target = isBr(element) ? handleBr(isRoot, element, direction) : handleParent(isRoot, element, offset, direction);\n      return target.map(function (tgt) {\n        return {\n          start: $_20nfr6k7jfuw8q4g.constant(tgt),\n          finish: $_20nfr6k7jfuw8q4g.constant(tgt)\n        };\n      });\n    };\n\n    var process = function (analysis) {\n      return $_25fydhprjfuw8r89.cata(analysis, function (message) {\n        return Option.none();\n      }, function () {\n        return Option.none();\n      }, function (cell) {\n        return Option.some($_1kct4uptjfuw8r98.point(cell, 0));\n      }, function (cell) {\n        return Option.some($_1kct4uptjfuw8r98.point(cell, $_6vfowrlmjfuw8qbz.getEnd(cell)));\n      });\n    };\n\n    var $_62az2spsjfuw8r8p = {\n      tryBr: tryBr,\n      process: process\n    };\n    var MAX_RETRIES = 20;\n    var platform$1 = $_fqgee0ktjfuw8q83.detect();\n\n    var findSpot = function (bridge, isRoot, direction) {\n      return bridge.getSelection().bind(function (sel) {\n        return $_62az2spsjfuw8r8p.tryBr(isRoot, sel.finish(), sel.foffset(), direction).fold(function () {\n          return Option.some($_1kct4uptjfuw8r98.point(sel.finish(), sel.foffset()));\n        }, function (brNeighbour) {\n          var range = bridge.fromSitus(brNeighbour);\n          var analysis = $_25fydhprjfuw8r89.verify(bridge, sel.finish(), sel.foffset(), range.finish(), range.foffset(), direction.failure, isRoot);\n          return $_62az2spsjfuw8r8p.process(analysis);\n        });\n      });\n    };\n\n    var scan = function (bridge, isRoot, element, offset, direction, numRetries) {\n      if (numRetries === 0) return Option.none();\n      return tryCursor(bridge, isRoot, element, offset, direction).bind(function (situs) {\n        var range = bridge.fromSitus(situs);\n        var analysis = $_25fydhprjfuw8r89.verify(bridge, element, offset, range.finish(), range.foffset(), direction.failure, isRoot);\n        return $_25fydhprjfuw8r89.cata(analysis, function () {\n          return Option.none();\n        }, function () {\n          return Option.some(situs);\n        }, function (cell) {\n          if ($_e8rn66kojfuw8q7n.eq(element, cell) && offset === 0) return tryAgain(bridge, element, offset, $_37xezepjjfuw8r6q.moveUp, direction);else return scan(bridge, isRoot, cell, 0, direction, numRetries - 1);\n        }, function (cell) {\n          if ($_e8rn66kojfuw8q7n.eq(element, cell) && offset === $_6vfowrlmjfuw8qbz.getEnd(cell)) return tryAgain(bridge, element, offset, $_37xezepjjfuw8r6q.moveDown, direction);else return scan(bridge, isRoot, cell, $_6vfowrlmjfuw8qbz.getEnd(cell), direction, numRetries - 1);\n        });\n      });\n    };\n\n    var tryAgain = function (bridge, element, offset, move, direction) {\n      return $_8xl6tpkjfuw8r6u.getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, move(box, $_efciv1pljfuw8r73.getJumpSize()));\n      });\n    };\n\n    var tryAt = function (bridge, direction, box) {\n      if (platform$1.browser.isChrome() || platform$1.browser.isSafari() || platform$1.browser.isFirefox() || platform$1.browser.isEdge()) return direction.otherRetry(bridge, box);else if (platform$1.browser.isIE()) return direction.ieRetry(bridge, box);else return Option.none();\n    };\n\n    var tryCursor = function (bridge, isRoot, element, offset, direction) {\n      return $_8xl6tpkjfuw8r6u.getBoxAt(bridge, element, offset).bind(function (box) {\n        return tryAt(bridge, direction, box);\n      });\n    };\n\n    var handle$2 = function (bridge, isRoot, direction) {\n      return findSpot(bridge, isRoot, direction).bind(function (spot) {\n        return scan(bridge, isRoot, spot.element(), spot.offset(), direction, MAX_RETRIES).map(bridge.fromSitus);\n      });\n    };\n\n    var $_fxzqelpijfuw8r6a = {\n      handle: handle$2\n    };\n\n    var any$1 = function (predicate) {\n      return $_11ympzlbjfuw8q9n.first(predicate).isSome();\n    };\n\n    var ancestor$3 = function (scope, predicate, isRoot) {\n      return $_11ympzlbjfuw8q9n.ancestor(scope, predicate, isRoot).isSome();\n    };\n\n    var closest$3 = function (scope, predicate, isRoot) {\n      return $_11ympzlbjfuw8q9n.closest(scope, predicate, isRoot).isSome();\n    };\n\n    var sibling$3 = function (scope, predicate) {\n      return $_11ympzlbjfuw8q9n.sibling(scope, predicate).isSome();\n    };\n\n    var child$4 = function (scope, predicate) {\n      return $_11ympzlbjfuw8q9n.child(scope, predicate).isSome();\n    };\n\n    var descendant$3 = function (scope, predicate) {\n      return $_11ympzlbjfuw8q9n.descendant(scope, predicate).isSome();\n    };\n\n    var $_cs6t5xpvjfuw8r9l = {\n      any: any$1,\n      ancestor: ancestor$3,\n      closest: closest$3,\n      sibling: sibling$3,\n      child: child$4,\n      descendant: descendant$3\n    };\n    var detection = $_fqgee0ktjfuw8q83.detect();\n\n    var inSameTable = function (elem, table) {\n      return $_cs6t5xpvjfuw8r9l.ancestor(elem, function (e) {\n        return $_s8scrkmjfuw8q7a.parent(e).exists(function (p) {\n          return $_e8rn66kojfuw8q7n.eq(p, table);\n        });\n      });\n    };\n\n    var simulate = function (bridge, isRoot, direction, initial, anchor) {\n      return $_8wdrbmlajfuw8q9m.closest(initial, 'td,th', isRoot).bind(function (start) {\n        return $_8wdrbmlajfuw8q9m.closest(start, 'table', isRoot).bind(function (table) {\n          if (!inSameTable(anchor, table)) return Option.none();\n          return $_fxzqelpijfuw8r6a.handle(bridge, isRoot, direction).bind(function (range) {\n            return $_8wdrbmlajfuw8q9m.closest(range.finish(), 'td,th', isRoot).map(function (finish) {\n              return {\n                start: $_20nfr6k7jfuw8q4g.constant(start),\n                finish: $_20nfr6k7jfuw8q4g.constant(finish),\n                range: $_20nfr6k7jfuw8q4g.constant(range)\n              };\n            });\n          });\n        });\n      });\n    };\n\n    var navigate = function (bridge, isRoot, direction, initial, anchor, precheck) {\n      if (detection.browser.isIE()) {\n        return Option.none();\n      } else {\n        return precheck(initial, isRoot).orThunk(function () {\n          return simulate(bridge, isRoot, direction, initial, anchor).map(function (info) {\n            var range = info.range();\n            return $_b7ap4hpbjfuw8r3x.response(Option.some($_81eh29pejfuw8r4k.makeSitus(range.start(), range.soffset(), range.finish(), range.foffset())), true);\n          });\n        });\n      }\n    };\n\n    var firstUpCheck = function (initial, isRoot) {\n      return $_8wdrbmlajfuw8q9m.closest(initial, 'tr', isRoot).bind(function (startRow) {\n        return $_8wdrbmlajfuw8q9m.closest(startRow, 'table', isRoot).bind(function (table) {\n          var rows = $_6c9d0hl7jfuw8q9d.descendants(table, 'tr');\n\n          if ($_e8rn66kojfuw8q7n.eq(startRow, rows[0])) {\n            return $_fgafb6pmjfuw8r7l.seekLeft(table, function (element) {\n              return $_ejrzj4lljfuw8qbw.last(element).isSome();\n            }, isRoot).map(function (last) {\n              var lastOffset = $_6vfowrlmjfuw8qbz.getEnd(last);\n              return $_b7ap4hpbjfuw8r3x.response(Option.some($_81eh29pejfuw8r4k.makeSitus(last, lastOffset, last, lastOffset)), true);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      });\n    };\n\n    var lastDownCheck = function (initial, isRoot) {\n      return $_8wdrbmlajfuw8q9m.closest(initial, 'tr', isRoot).bind(function (startRow) {\n        return $_8wdrbmlajfuw8q9m.closest(startRow, 'table', isRoot).bind(function (table) {\n          var rows = $_6c9d0hl7jfuw8q9d.descendants(table, 'tr');\n\n          if ($_e8rn66kojfuw8q7n.eq(startRow, rows[rows.length - 1])) {\n            return $_fgafb6pmjfuw8r7l.seekRight(table, function (element) {\n              return $_ejrzj4lljfuw8qbw.first(element).isSome();\n            }, isRoot).map(function (first) {\n              return $_b7ap4hpbjfuw8r3x.response(Option.some($_81eh29pejfuw8r4k.makeSitus(first, 0, first, 0)), true);\n            });\n          } else {\n            return Option.none();\n          }\n        });\n      });\n    };\n\n    var select = function (bridge, container, isRoot, direction, initial, anchor, selectRange) {\n      return simulate(bridge, isRoot, direction, initial, anchor).bind(function (info) {\n        return $_7ulhzpgjfuw8r5b.detect(container, isRoot, info.start(), info.finish(), selectRange);\n      });\n    };\n\n    var $_4f08xvphjfuw8r5l = {\n      navigate: navigate,\n      select: select,\n      firstUpCheck: firstUpCheck,\n      lastDownCheck: lastDownCheck\n    };\n\n    var findCell = function (target, isRoot) {\n      return $_8wdrbmlajfuw8q9m.closest(target, 'td,th', isRoot);\n    };\n\n    function MouseSelection(bridge, container, isRoot, annotations) {\n      var cursor = Option.none();\n\n      var clearState = function () {\n        cursor = Option.none();\n      };\n\n      var mousedown = function (event) {\n        annotations.clear(container);\n        cursor = findCell(event.target(), isRoot);\n      };\n\n      var mouseover = function (event) {\n        cursor.each(function (start) {\n          annotations.clear(container);\n          findCell(event.target(), isRoot).each(function (finish) {\n            $_dpd405ltjfuw8qd8.identify(start, finish, isRoot).each(function (cellSel) {\n              var boxes = cellSel.boxes().getOr([]);\n\n              if (boxes.length > 1 || boxes.length === 1 && !$_e8rn66kojfuw8q7n.eq(start, finish)) {\n                annotations.selectRange(container, boxes, cellSel.start(), cellSel.finish());\n                bridge.selectContents(finish);\n              }\n            });\n          });\n        });\n      };\n\n      var mouseup = function () {\n        cursor.each(clearState);\n      };\n\n      return {\n        mousedown: mousedown,\n        mouseover: mouseover,\n        mouseup: mouseup\n      };\n    }\n\n    var $_9alrp8pxjfuw8r9w = {\n      down: {\n        traverse: $_s8scrkmjfuw8q7a.nextSibling,\n        gather: $_fgafb6pmjfuw8r7l.after,\n        relative: $_cuk0n0ovjfuw8r0r.before,\n        otherRetry: $_efciv1pljfuw8r73.tryDown,\n        ieRetry: $_efciv1pljfuw8r73.ieTryDown,\n        failure: $_25fydhprjfuw8r89.adt.failedDown\n      },\n      up: {\n        traverse: $_s8scrkmjfuw8q7a.prevSibling,\n        gather: $_fgafb6pmjfuw8r7l.before,\n        relative: $_cuk0n0ovjfuw8r0r.before,\n        otherRetry: $_efciv1pljfuw8r73.tryUp,\n        ieRetry: $_efciv1pljfuw8r73.ieTryUp,\n        failure: $_25fydhprjfuw8r89.adt.failedUp\n      }\n    };\n    var rc = $_5now9kbjfuw8q5e.immutable('rows', 'cols');\n\n    var mouse = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n      var handlers = MouseSelection(bridge, container, isRoot, annotations);\n      return {\n        mousedown: handlers.mousedown,\n        mouseover: handlers.mouseover,\n        mouseup: handlers.mouseup\n      };\n    };\n\n    var keyboard = function (win, container, isRoot, annotations) {\n      var bridge = WindowBridge(win);\n\n      var clearToNavigate = function () {\n        annotations.clear(container);\n        return Option.none();\n      };\n\n      var keydown = function (event, start, soffset, finish, foffset, direction) {\n        var keycode = event.raw().which;\n        var shiftKey = event.raw().shiftKey === true;\n        var handler = $_dpd405ltjfuw8qd8.retrieve(container, annotations.selectedSelector()).fold(function () {\n          if ($_9n04otpcjfuw8r40.isDown(keycode) && shiftKey) {\n            return $_20nfr6k7jfuw8q4g.curry($_4f08xvphjfuw8r5l.select, bridge, container, isRoot, $_9alrp8pxjfuw8r9w.down, finish, start, annotations.selectRange);\n          } else if ($_9n04otpcjfuw8r40.isUp(keycode) && shiftKey) {\n            return $_20nfr6k7jfuw8q4g.curry($_4f08xvphjfuw8r5l.select, bridge, container, isRoot, $_9alrp8pxjfuw8r9w.up, finish, start, annotations.selectRange);\n          } else if ($_9n04otpcjfuw8r40.isDown(keycode)) {\n            return $_20nfr6k7jfuw8q4g.curry($_4f08xvphjfuw8r5l.navigate, bridge, isRoot, $_9alrp8pxjfuw8r9w.down, finish, start, $_4f08xvphjfuw8r5l.lastDownCheck);\n          } else if ($_9n04otpcjfuw8r40.isUp(keycode)) {\n            return $_20nfr6k7jfuw8q4g.curry($_4f08xvphjfuw8r5l.navigate, bridge, isRoot, $_9alrp8pxjfuw8r9w.up, finish, start, $_4f08xvphjfuw8r5l.firstUpCheck);\n          } else {\n            return Option.none;\n          }\n        }, function (selected) {\n          var update = function (attempts) {\n            return function () {\n              var navigation = $_cul8qomvjfuw8qm7.findMap(attempts, function (delta) {\n                return $_7ulhzpgjfuw8r5b.update(delta.rows(), delta.cols(), container, selected, annotations);\n              });\n              return navigation.fold(function () {\n                return $_dpd405ltjfuw8qd8.getEdges(container, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(function (edges) {\n                  var relative = $_9n04otpcjfuw8r40.isDown(keycode) || direction.isForward(keycode) ? $_cuk0n0ovjfuw8r0r.after : $_cuk0n0ovjfuw8r0r.before;\n                  bridge.setRelativeSelection($_cuk0n0ovjfuw8r0r.on(edges.first(), 0), relative(edges.table()));\n                  annotations.clear(container);\n                  return $_b7ap4hpbjfuw8r3x.response(Option.none(), true);\n                });\n              }, function (_) {\n                return Option.some($_b7ap4hpbjfuw8r3x.response(Option.none(), true));\n              });\n            };\n          };\n\n          if ($_9n04otpcjfuw8r40.isDown(keycode) && shiftKey) return update([rc(+1, 0)]);else if ($_9n04otpcjfuw8r40.isUp(keycode) && shiftKey) return update([rc(-1, 0)]);else if (direction.isBackward(keycode) && shiftKey) return update([rc(0, -1), rc(-1, 0)]);else if (direction.isForward(keycode) && shiftKey) return update([rc(0, +1), rc(+1, 0)]);else if ($_9n04otpcjfuw8r40.isNavigation(keycode) && shiftKey === false) return clearToNavigate;else return Option.none;\n        });\n        return handler();\n      };\n\n      var keyup = function (event, start, soffset, finish, foffset) {\n        return $_dpd405ltjfuw8qd8.retrieve(container, annotations.selectedSelector()).fold(function () {\n          var keycode = event.raw().which;\n          var shiftKey = event.raw().shiftKey === true;\n          if (shiftKey === false) return Option.none();\n          if ($_9n04otpcjfuw8r40.isNavigation(keycode)) return $_7ulhzpgjfuw8r5b.sync(container, isRoot, start, soffset, finish, foffset, annotations.selectRange);else return Option.none();\n        }, Option.none);\n      };\n\n      return {\n        keydown: keydown,\n        keyup: keyup\n      };\n    };\n\n    var $_ev8thhpajfuw8r3k = {\n      mouse: mouse,\n      keyboard: keyboard\n    };\n\n    var add$3 = function (element, classes) {\n      $_tyr3yk5jfuw8q47.each(classes, function (x) {\n        $_fmcseon6jfuw8qou.add(element, x);\n      });\n    };\n\n    var remove$7 = function (element, classes) {\n      $_tyr3yk5jfuw8q47.each(classes, function (x) {\n        $_fmcseon6jfuw8qou.remove(element, x);\n      });\n    };\n\n    var toggle$2 = function (element, classes) {\n      $_tyr3yk5jfuw8q47.each(classes, function (x) {\n        $_fmcseon6jfuw8qou.toggle(element, x);\n      });\n    };\n\n    var hasAll = function (element, classes) {\n      return $_tyr3yk5jfuw8q47.forall(classes, function (clazz) {\n        return $_fmcseon6jfuw8qou.has(element, clazz);\n      });\n    };\n\n    var hasAny = function (element, classes) {\n      return $_tyr3yk5jfuw8q47.exists(classes, function (clazz) {\n        return $_fmcseon6jfuw8qou.has(element, clazz);\n      });\n    };\n\n    var getNative = function (element) {\n      var classList = element.dom().classList;\n      var r = new Array(classList.length);\n\n      for (var i = 0; i < classList.length; i++) {\n        r[i] = classList.item(i);\n      }\n\n      return r;\n    };\n\n    var get$11 = function (element) {\n      return $_f4rpvun8jfuw8qox.supports(element) ? getNative(element) : $_f4rpvun8jfuw8qox.get(element);\n    };\n\n    var $_6cu9bpq0jfuw8ram = {\n      add: add$3,\n      remove: remove$7,\n      toggle: toggle$2,\n      hasAll: hasAll,\n      hasAny: hasAny,\n      get: get$11\n    };\n\n    var addClass = function (clazz) {\n      return function (element) {\n        $_fmcseon6jfuw8qou.add(element, clazz);\n      };\n    };\n\n    var removeClass = function (clazz) {\n      return function (element) {\n        $_fmcseon6jfuw8qou.remove(element, clazz);\n      };\n    };\n\n    var removeClasses = function (classes) {\n      return function (element) {\n        $_6cu9bpq0jfuw8ram.remove(element, classes);\n      };\n    };\n\n    var hasClass = function (clazz) {\n      return function (element) {\n        return $_fmcseon6jfuw8qou.has(element, clazz);\n      };\n    };\n\n    var $_5za372pzjfuw8rak = {\n      addClass: addClass,\n      removeClass: removeClass,\n      removeClasses: removeClasses,\n      hasClass: hasClass\n    };\n\n    var byClass = function (ephemera) {\n      var addSelectionClass = $_5za372pzjfuw8rak.addClass(ephemera.selected());\n      var removeSelectionClasses = $_5za372pzjfuw8rak.removeClasses([ephemera.selected(), ephemera.lastSelected(), ephemera.firstSelected()]);\n\n      var clear = function (container) {\n        var sels = $_6c9d0hl7jfuw8q9d.descendants(container, ephemera.selectedSelector());\n        $_tyr3yk5jfuw8q47.each(sels, removeSelectionClasses);\n      };\n\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        $_tyr3yk5jfuw8q47.each(cells, addSelectionClass);\n        $_fmcseon6jfuw8qou.add(start, ephemera.firstSelected());\n        $_fmcseon6jfuw8qou.add(finish, ephemera.lastSelected());\n      };\n\n      return {\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n\n    var byAttr = function (ephemera) {\n      var removeSelectionAttributes = function (element) {\n        $_3q82t2l5jfuw8q93.remove(element, ephemera.selected());\n        $_3q82t2l5jfuw8q93.remove(element, ephemera.firstSelected());\n        $_3q82t2l5jfuw8q93.remove(element, ephemera.lastSelected());\n      };\n\n      var addSelectionAttribute = function (element) {\n        $_3q82t2l5jfuw8q93.set(element, ephemera.selected(), '1');\n      };\n\n      var clear = function (container) {\n        var sels = $_6c9d0hl7jfuw8q9d.descendants(container, ephemera.selectedSelector());\n        $_tyr3yk5jfuw8q47.each(sels, removeSelectionAttributes);\n      };\n\n      var selectRange = function (container, cells, start, finish) {\n        clear(container);\n        $_tyr3yk5jfuw8q47.each(cells, addSelectionAttribute);\n        $_3q82t2l5jfuw8q93.set(start, ephemera.firstSelected(), '1');\n        $_3q82t2l5jfuw8q93.set(finish, ephemera.lastSelected(), '1');\n      };\n\n      return {\n        clear: clear,\n        selectRange: selectRange,\n        selectedSelector: ephemera.selectedSelector,\n        firstSelectedSelector: ephemera.firstSelectedSelector,\n        lastSelectedSelector: ephemera.lastSelectedSelector\n      };\n    };\n\n    var $_21uhbjpyjfuw8ra4 = {\n      byClass: byClass,\n      byAttr: byAttr\n    };\n\n    function CellSelection$1(editor, lazyResize) {\n      var handlerStruct = $_5now9kbjfuw8q5e.immutableBag(['mousedown', 'mouseover', 'mouseup', 'keyup', 'keydown'], []);\n      var handlers = Option.none();\n      var annotations = $_21uhbjpyjfuw8ra4.byAttr($_f8tr2nm5jfuw8qgp);\n      editor.on('init', function (e) {\n        var win = editor.getWin();\n        var body = $_5xkhf2nnjfuw8qrq.getBody(editor);\n        var isRoot = $_5xkhf2nnjfuw8qrq.getIsRoot(editor);\n\n        var syncSelection = function () {\n          var sel = editor.selection;\n          var start = $_xbeoqkkjfuw8q73.fromDom(sel.getStart());\n          var end = $_xbeoqkkjfuw8q73.fromDom(sel.getEnd());\n          var startTable = $_aqhz9okhjfuw8q5y.table(start);\n          var endTable = $_aqhz9okhjfuw8q5y.table(end);\n          var sameTable = startTable.bind(function (tableStart) {\n            return endTable.bind(function (tableEnd) {\n              return $_e8rn66kojfuw8q7n.eq(tableStart, tableEnd) ? Option.some(true) : Option.none();\n            });\n          });\n          sameTable.fold(function () {\n            annotations.clear(body);\n          }, $_20nfr6k7jfuw8q4g.noop);\n        };\n\n        var mouseHandlers = $_ev8thhpajfuw8r3k.mouse(win, body, isRoot, annotations);\n        var keyHandlers = $_ev8thhpajfuw8r3k.keyboard(win, body, isRoot, annotations);\n\n        var hasShiftKey = function (event) {\n          return event.raw().shiftKey === true;\n        };\n\n        var handleResponse = function (event, response) {\n          if (!hasShiftKey(event)) {\n            return;\n          }\n\n          if (response.kill()) {\n            event.kill();\n          }\n\n          response.selection().each(function (ns) {\n            var relative = $_bv1jwpoujfuw8r0m.relative(ns.start(), ns.finish());\n            var rng = $_c9xxrpp0jfuw8r1k.asLtrRange(win, relative);\n            editor.selection.setRng(rng);\n          });\n        };\n\n        var keyup = function (event) {\n          var wrappedEvent = wrapEvent(event);\n\n          if (wrappedEvent.raw().shiftKey && $_9n04otpcjfuw8r40.isNavigation(wrappedEvent.raw().which)) {\n            var rng = editor.selection.getRng();\n            var start = $_xbeoqkkjfuw8q73.fromDom(rng.startContainer);\n            var end = $_xbeoqkkjfuw8q73.fromDom(rng.endContainer);\n            keyHandlers.keyup(wrappedEvent, start, rng.startOffset, end, rng.endOffset).each(function (response) {\n              handleResponse(wrappedEvent, response);\n            });\n          }\n        };\n\n        var keydown = function (event) {\n          var wrappedEvent = wrapEvent(event);\n          lazyResize().each(function (resize) {\n            resize.hideBars();\n          });\n          var rng = editor.selection.getRng();\n          var startContainer = $_xbeoqkkjfuw8q73.fromDom(editor.selection.getStart());\n          var start = $_xbeoqkkjfuw8q73.fromDom(rng.startContainer);\n          var end = $_xbeoqkkjfuw8q73.fromDom(rng.endContainer);\n          var direction = $_4xd1udnojfuw8qrw.directionAt(startContainer).isRtl() ? $_9n04otpcjfuw8r40.rtl : $_9n04otpcjfuw8r40.ltr;\n          keyHandlers.keydown(wrappedEvent, start, rng.startOffset, end, rng.endOffset, direction).each(function (response) {\n            handleResponse(wrappedEvent, response);\n          });\n          lazyResize().each(function (resize) {\n            resize.showBars();\n          });\n        };\n\n        var isMouseEvent = function (event) {\n          return event.hasOwnProperty('x') && event.hasOwnProperty('y');\n        };\n\n        var wrapEvent = function (event) {\n          var target = $_xbeoqkkjfuw8q73.fromDom(event.target);\n\n          var stop = function () {\n            event.stopPropagation();\n          };\n\n          var prevent = function () {\n            event.preventDefault();\n          };\n\n          var kill = $_20nfr6k7jfuw8q4g.compose(prevent, stop);\n          return {\n            target: $_20nfr6k7jfuw8q4g.constant(target),\n            x: $_20nfr6k7jfuw8q4g.constant(isMouseEvent(event) ? event.x : null),\n            y: $_20nfr6k7jfuw8q4g.constant(isMouseEvent(event) ? event.y : null),\n            stop: stop,\n            prevent: prevent,\n            kill: kill,\n            raw: $_20nfr6k7jfuw8q4g.constant(event)\n          };\n        };\n\n        var isLeftMouse = function (raw) {\n          return raw.button === 0;\n        };\n\n        var isLeftButtonPressed = function (raw) {\n          if (raw.buttons === undefined) {\n            return true;\n          }\n\n          return (raw.buttons & 1) !== 0;\n        };\n\n        var mouseDown = function (e) {\n          if (isLeftMouse(e)) {\n            mouseHandlers.mousedown(wrapEvent(e));\n          }\n        };\n\n        var mouseOver = function (e) {\n          if (isLeftButtonPressed(e)) {\n            mouseHandlers.mouseover(wrapEvent(e));\n          }\n        };\n\n        var mouseUp = function (e) {\n          if (isLeftMouse(e)) {\n            mouseHandlers.mouseup(wrapEvent(e));\n          }\n        };\n\n        editor.on('mousedown', mouseDown);\n        editor.on('mouseover', mouseOver);\n        editor.on('mouseup', mouseUp);\n        editor.on('keyup', keyup);\n        editor.on('keydown', keydown);\n        editor.on('nodechange', syncSelection);\n        handlers = Option.some(handlerStruct({\n          mousedown: mouseDown,\n          mouseover: mouseOver,\n          mouseup: mouseUp,\n          keyup: keyup,\n          keydown: keydown\n        }));\n      });\n\n      var destroy = function () {\n        handlers.each(function (handlers) {});\n      };\n\n      return {\n        clear: annotations.clear,\n        destroy: destroy\n      };\n    }\n\n    var Selections = function (editor) {\n      var get = function () {\n        var body = $_5xkhf2nnjfuw8qrq.getBody(editor);\n        return $_1mynollsjfuw8qcy.retrieve(body, $_f8tr2nm5jfuw8qgp.selectedSelector()).fold(function () {\n          if (editor.selection.getStart() === undefined) {\n            return $_cx0pwam6jfuw8qgr.none();\n          } else {\n            return $_cx0pwam6jfuw8qgr.single(editor.selection);\n          }\n        }, function (cells) {\n          return $_cx0pwam6jfuw8qgr.multiple(cells);\n        });\n      };\n\n      return {\n        get: get\n      };\n    };\n\n    var each$4 = global$2.each;\n\n    var addButtons = function (editor) {\n      var menuItems = [];\n      each$4('inserttable tableprops deletetable | cell row column'.split(' '), function (name) {\n        if (name === '|') {\n          menuItems.push({\n            text: '-'\n          });\n        } else {\n          menuItems.push(editor.menuItems[name]);\n        }\n      });\n      editor.addButton('table', {\n        type: 'menubutton',\n        title: 'Table',\n        menu: menuItems\n      });\n\n      function cmd(command) {\n        return function () {\n          editor.execCommand(command);\n        };\n      }\n\n      editor.addButton('tableprops', {\n        title: 'Table properties',\n        onclick: $_20nfr6k7jfuw8q4g.curry($_ad8brjnzjfuw8qtm.open, editor, true),\n        icon: 'table'\n      });\n      editor.addButton('tabledelete', {\n        title: 'Delete table',\n        onclick: cmd('mceTableDelete')\n      });\n      editor.addButton('tablecellprops', {\n        title: 'Cell properties',\n        onclick: cmd('mceTableCellProps')\n      });\n      editor.addButton('tablemergecells', {\n        title: 'Merge cells',\n        onclick: cmd('mceTableMergeCells')\n      });\n      editor.addButton('tablesplitcells', {\n        title: 'Split cell',\n        onclick: cmd('mceTableSplitCells')\n      });\n      editor.addButton('tableinsertrowbefore', {\n        title: 'Insert row before',\n        onclick: cmd('mceTableInsertRowBefore')\n      });\n      editor.addButton('tableinsertrowafter', {\n        title: 'Insert row after',\n        onclick: cmd('mceTableInsertRowAfter')\n      });\n      editor.addButton('tabledeleterow', {\n        title: 'Delete row',\n        onclick: cmd('mceTableDeleteRow')\n      });\n      editor.addButton('tablerowprops', {\n        title: 'Row properties',\n        onclick: cmd('mceTableRowProps')\n      });\n      editor.addButton('tablecutrow', {\n        title: 'Cut row',\n        onclick: cmd('mceTableCutRow')\n      });\n      editor.addButton('tablecopyrow', {\n        title: 'Copy row',\n        onclick: cmd('mceTableCopyRow')\n      });\n      editor.addButton('tablepasterowbefore', {\n        title: 'Paste row before',\n        onclick: cmd('mceTablePasteRowBefore')\n      });\n      editor.addButton('tablepasterowafter', {\n        title: 'Paste row after',\n        onclick: cmd('mceTablePasteRowAfter')\n      });\n      editor.addButton('tableinsertcolbefore', {\n        title: 'Insert column before',\n        onclick: cmd('mceTableInsertColBefore')\n      });\n      editor.addButton('tableinsertcolafter', {\n        title: 'Insert column after',\n        onclick: cmd('mceTableInsertColAfter')\n      });\n      editor.addButton('tabledeletecol', {\n        title: 'Delete column',\n        onclick: cmd('mceTableDeleteCol')\n      });\n    };\n\n    var addToolbars = function (editor) {\n      var isTable = function (table) {\n        var selectorMatched = editor.dom.is(table, 'table') && editor.getBody().contains(table);\n        return selectorMatched;\n      };\n\n      var toolbar = getToolbar(editor);\n\n      if (toolbar.length > 0) {\n        editor.addContextToolbar(isTable, toolbar.join(' '));\n      }\n    };\n\n    var $_ga9kj7q2jfuw8rau = {\n      addButtons: addButtons,\n      addToolbars: addToolbars\n    };\n\n    var addMenuItems = function (editor, selections) {\n      var targets = Option.none();\n      var tableCtrls = [];\n      var cellCtrls = [];\n      var mergeCtrls = [];\n      var unmergeCtrls = [];\n\n      var noTargetDisable = function (ctrl) {\n        ctrl.disabled(true);\n      };\n\n      var ctrlEnable = function (ctrl) {\n        ctrl.disabled(false);\n      };\n\n      var pushTable = function () {\n        var self = this;\n        tableCtrls.push(self);\n        targets.fold(function () {\n          noTargetDisable(self);\n        }, function (targets) {\n          ctrlEnable(self);\n        });\n      };\n\n      var pushCell = function () {\n        var self = this;\n        cellCtrls.push(self);\n        targets.fold(function () {\n          noTargetDisable(self);\n        }, function (targets) {\n          ctrlEnable(self);\n        });\n      };\n\n      var pushMerge = function () {\n        var self = this;\n        mergeCtrls.push(self);\n        targets.fold(function () {\n          noTargetDisable(self);\n        }, function (targets) {\n          self.disabled(targets.mergable().isNone());\n        });\n      };\n\n      var pushUnmerge = function () {\n        var self = this;\n        unmergeCtrls.push(self);\n        targets.fold(function () {\n          noTargetDisable(self);\n        }, function (targets) {\n          self.disabled(targets.unmergable().isNone());\n        });\n      };\n\n      var setDisabledCtrls = function () {\n        targets.fold(function () {\n          $_tyr3yk5jfuw8q47.each(tableCtrls, noTargetDisable);\n          $_tyr3yk5jfuw8q47.each(cellCtrls, noTargetDisable);\n          $_tyr3yk5jfuw8q47.each(mergeCtrls, noTargetDisable);\n          $_tyr3yk5jfuw8q47.each(unmergeCtrls, noTargetDisable);\n        }, function (targets) {\n          $_tyr3yk5jfuw8q47.each(tableCtrls, ctrlEnable);\n          $_tyr3yk5jfuw8q47.each(cellCtrls, ctrlEnable);\n          $_tyr3yk5jfuw8q47.each(mergeCtrls, function (mergeCtrl) {\n            mergeCtrl.disabled(targets.mergable().isNone());\n          });\n          $_tyr3yk5jfuw8q47.each(unmergeCtrls, function (unmergeCtrl) {\n            unmergeCtrl.disabled(targets.unmergable().isNone());\n          });\n        });\n      };\n\n      editor.on('init', function () {\n        editor.on('nodechange', function (e) {\n          var cellOpt = Option.from(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n          targets = cellOpt.bind(function (cellDom) {\n            var cell = $_xbeoqkkjfuw8q73.fromDom(cellDom);\n            var table = $_aqhz9okhjfuw8q5y.table(cell);\n            return table.map(function (table) {\n              return $_5b7h1hlqjfuw8qci.forMenu(selections, table, cell);\n            });\n          });\n          setDisabledCtrls();\n        });\n      });\n\n      var generateTableGrid = function () {\n        var html = '';\n        html = '<table role=\"grid\" class=\"mce-grid mce-grid-border\" aria-readonly=\"true\">';\n\n        for (var y = 0; y < 10; y++) {\n          html += '<tr>';\n\n          for (var x = 0; x < 10; x++) {\n            html += '<td role=\"gridcell\" tabindex=\"-1\"><a id=\"mcegrid' + (y * 10 + x) + '\" href=\"#\" ' + 'data-mce-x=\"' + x + '\" data-mce-y=\"' + y + '\"></a></td>';\n          }\n\n          html += '</tr>';\n        }\n\n        html += '</table>';\n        html += '<div class=\"mce-text-center\" role=\"presentation\">1 x 1</div>';\n        return html;\n      };\n\n      var selectGrid = function (editor, tx, ty, control) {\n        var table = control.getEl().getElementsByTagName('table')[0];\n        var x, y, focusCell, cell, active;\n        var rtl = control.isRtl() || control.parent().rel === 'tl-tr';\n        table.nextSibling.innerHTML = tx + 1 + ' x ' + (ty + 1);\n\n        if (rtl) {\n          tx = 9 - tx;\n        }\n\n        for (y = 0; y < 10; y++) {\n          for (x = 0; x < 10; x++) {\n            cell = table.rows[y].childNodes[x].firstChild;\n            active = (rtl ? x >= tx : x <= tx) && y <= ty;\n            editor.dom.toggleClass(cell, 'mce-active', active);\n\n            if (active) {\n              focusCell = cell;\n            }\n          }\n        }\n\n        return focusCell.parentNode;\n      };\n\n      var insertTable = hasTableGrid(editor) === false ? {\n        text: 'Table',\n        icon: 'table',\n        context: 'table',\n        onclick: $_20nfr6k7jfuw8q4g.curry($_ad8brjnzjfuw8qtm.open, editor)\n      } : {\n        text: 'Table',\n        icon: 'table',\n        context: 'table',\n        ariaHideMenu: true,\n        onclick: function (e) {\n          if (e.aria) {\n            this.parent().hideAll();\n            e.stopImmediatePropagation();\n            $_ad8brjnzjfuw8qtm.open(editor);\n          }\n        },\n        onshow: function () {\n          selectGrid(editor, 0, 0, this.menu.items()[0]);\n        },\n        onhide: function () {\n          var elements = this.menu.items()[0].getEl().getElementsByTagName('a');\n          editor.dom.removeClass(elements, 'mce-active');\n          editor.dom.addClass(elements[0], 'mce-active');\n        },\n        menu: [{\n          type: 'container',\n          html: generateTableGrid(),\n          onPostRender: function () {\n            this.lastX = this.lastY = 0;\n          },\n          onmousemove: function (e) {\n            var target = e.target;\n            var x, y;\n\n            if (target.tagName.toUpperCase() === 'A') {\n              x = parseInt(target.getAttribute('data-mce-x'), 10);\n              y = parseInt(target.getAttribute('data-mce-y'), 10);\n\n              if (this.isRtl() || this.parent().rel === 'tl-tr') {\n                x = 9 - x;\n              }\n\n              if (x !== this.lastX || y !== this.lastY) {\n                selectGrid(editor, x, y, e.control);\n                this.lastX = x;\n                this.lastY = y;\n              }\n            }\n          },\n          onclick: function (e) {\n            var self = this;\n\n            if (e.target.tagName.toUpperCase() === 'A') {\n              e.preventDefault();\n              e.stopPropagation();\n              self.parent().cancel();\n              editor.undoManager.transact(function () {\n                $_1mq3b3o1jfuw8qtu.insert(editor, self.lastX + 1, self.lastY + 1);\n              });\n              editor.addVisual();\n            }\n          }\n        }]\n      };\n\n      function cmd(command) {\n        return function () {\n          editor.execCommand(command);\n        };\n      }\n\n      var tableProperties = {\n        text: 'Table properties',\n        context: 'table',\n        onPostRender: pushTable,\n        onclick: $_20nfr6k7jfuw8q4g.curry($_ad8brjnzjfuw8qtm.open, editor, true)\n      };\n      var deleteTable = {\n        text: 'Delete table',\n        context: 'table',\n        onPostRender: pushTable,\n        cmd: 'mceTableDelete'\n      };\n      var row = {\n        text: 'Row',\n        context: 'table',\n        menu: [{\n          text: 'Insert row before',\n          onclick: cmd('mceTableInsertRowBefore'),\n          onPostRender: pushCell\n        }, {\n          text: 'Insert row after',\n          onclick: cmd('mceTableInsertRowAfter'),\n          onPostRender: pushCell\n        }, {\n          text: 'Delete row',\n          onclick: cmd('mceTableDeleteRow'),\n          onPostRender: pushCell\n        }, {\n          text: 'Row properties',\n          onclick: cmd('mceTableRowProps'),\n          onPostRender: pushCell\n        }, {\n          text: '-'\n        }, {\n          text: 'Cut row',\n          onclick: cmd('mceTableCutRow'),\n          onPostRender: pushCell\n        }, {\n          text: 'Copy row',\n          onclick: cmd('mceTableCopyRow'),\n          onPostRender: pushCell\n        }, {\n          text: 'Paste row before',\n          onclick: cmd('mceTablePasteRowBefore'),\n          onPostRender: pushCell\n        }, {\n          text: 'Paste row after',\n          onclick: cmd('mceTablePasteRowAfter'),\n          onPostRender: pushCell\n        }]\n      };\n      var column = {\n        text: 'Column',\n        context: 'table',\n        menu: [{\n          text: 'Insert column before',\n          onclick: cmd('mceTableInsertColBefore'),\n          onPostRender: pushCell\n        }, {\n          text: 'Insert column after',\n          onclick: cmd('mceTableInsertColAfter'),\n          onPostRender: pushCell\n        }, {\n          text: 'Delete column',\n          onclick: cmd('mceTableDeleteCol'),\n          onPostRender: pushCell\n        }]\n      };\n      var cell = {\n        separator: 'before',\n        text: 'Cell',\n        context: 'table',\n        menu: [{\n          text: 'Cell properties',\n          onclick: cmd('mceTableCellProps'),\n          onPostRender: pushCell\n        }, {\n          text: 'Merge cells',\n          onclick: cmd('mceTableMergeCells'),\n          onPostRender: pushMerge\n        }, {\n          text: 'Split cell',\n          onclick: cmd('mceTableSplitCells'),\n          onPostRender: pushUnmerge\n        }]\n      };\n      editor.addMenuItem('inserttable', insertTable);\n      editor.addMenuItem('tableprops', tableProperties);\n      editor.addMenuItem('deletetable', deleteTable);\n      editor.addMenuItem('row', row);\n      editor.addMenuItem('column', column);\n      editor.addMenuItem('cell', cell);\n    };\n\n    var $_e80bn7q3jfuw8raz = {\n      addMenuItems: addMenuItems\n    };\n\n    var getClipboardRows = function (clipboardRows) {\n      return clipboardRows.get().fold(function () {\n        return;\n      }, function (rows) {\n        return $_tyr3yk5jfuw8q47.map(rows, function (row) {\n          return row.dom();\n        });\n      });\n    };\n\n    var setClipboardRows = function (rows, clipboardRows) {\n      var sugarRows = $_tyr3yk5jfuw8q47.map(rows, $_xbeoqkkjfuw8q73.fromDom);\n      clipboardRows.set(Option.from(sugarRows));\n    };\n\n    var getApi = function (editor, clipboardRows) {\n      return {\n        insertTable: function (columns, rows) {\n          return $_1mq3b3o1jfuw8qtu.insert(editor, columns, rows);\n        },\n        setClipboardRows: function (rows) {\n          return setClipboardRows(rows, clipboardRows);\n        },\n        getClipboardRows: function () {\n          return getClipboardRows(clipboardRows);\n        }\n      };\n    };\n\n    function Plugin(editor) {\n      var resizeHandler = ResizeHandler(editor);\n      var cellSelection = CellSelection$1(editor, resizeHandler.lazyResize);\n      var actions = TableActions(editor, resizeHandler.lazyWire);\n      var selections = Selections(editor);\n      var clipboardRows = Cell(Option.none());\n      $_srry6nsjfuw8qs8.registerCommands(editor, actions, cellSelection, selections, clipboardRows);\n      $_3y1hv8k4jfuw8q3l.registerEvents(editor, selections, actions, cellSelection);\n      $_e80bn7q3jfuw8raz.addMenuItems(editor, selections);\n      $_ga9kj7q2jfuw8rau.addButtons(editor);\n      $_ga9kj7q2jfuw8rau.addToolbars(editor);\n      editor.on('PreInit', function () {\n        editor.serializer.addTempAttr($_f8tr2nm5jfuw8qgp.firstSelected());\n        editor.serializer.addTempAttr($_f8tr2nm5jfuw8qgp.lastSelected());\n      });\n\n      if (hasTabNavigation(editor)) {\n        editor.on('keydown', function (e) {\n          $_djb8ceorjfuw8qzt.handle(e, editor, actions, resizeHandler.lazyWire);\n        });\n      }\n\n      editor.on('remove', function () {\n        resizeHandler.destroy();\n        cellSelection.destroy();\n      });\n      return getApi(editor, clipboardRows);\n    }\n\n    global.add('table', Plugin);\n\n    function Plugin$1() {}\n\n    return Plugin$1;\n  }();\n})();","map":null,"metadata":{},"sourceType":"script"}