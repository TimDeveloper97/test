{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { DesignStructureManagerComponent } from '../design-structure-manager/design-structure-manager.component';\nimport { BroadcastEventListener } from 'src/app/signalr/broadcast.event.listener';\nimport { BlockUI } from 'ng-block-ui';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i2 from \"src/app/shared\";\nimport * as i3 from \"../services/designstructure-service\";\nimport * as i4 from \"src/app/signalR/signal-r.service\";\n\nfunction DesignStructureComponent_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", item_r4.Id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", item_r4.Name, \" \");\n  }\n}\n\nfunction DesignStructureComponent_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", item_r5.Id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", item_r5.Name, \" \");\n  }\n}\n\nfunction DesignStructureComponent_button_35_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function DesignStructureComponent_button_35_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.createDesignStructure());\n    });\n    i0.ɵɵelement(1, \"i\", 24);\n    i0.ɵɵtext(2, \" \\u00A0T\\u1EA1o\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return [\"F090001\"];\n};\n\nexport class DesignStructureComponent {\n  constructor(modalService, config, designStructureService, messageService, signalRService, appSetting, permissionService, constant) {\n    this.modalService = modalService;\n    this.config = config;\n    this.designStructureService = designStructureService;\n    this.messageService = messageService;\n    this.signalRService = signalRService;\n    this.appSetting = appSetting;\n    this.permissionService = permissionService;\n    this.constant = constant;\n    this.model = {\n      Type: 1,\n      ObjectType: 1,\n      ObjectCode: '',\n      ApiUrl: '',\n      ModuleName: '',\n      CreateBy: '',\n      ModuleGroup: ''\n    };\n    this.onCreateFolder = new BroadcastEventListener('sendCreateFolder');\n  }\n\n  ngOnInit() {\n    this.model.ApiUrl = this.config.ServerFileApi;\n    this.appSetting.PageTitle = \"Tạo cấu trúc thư mục\";\n    this.signalRService.listen(this.onCreateFolder, true);\n    this.notiSub = this.onCreateFolder.subscribe(data => {\n      if (data) {\n        if (data.StatusCode == 1) {\n          this.messageService.showSuccess('Tạo thư mục thành công!');\n        } else {\n          this.messageService.showMessage('Tạo thư mục không thành công!');\n        }\n      }\n\n      this.blockUI.stop();\n    });\n  }\n\n  ngOnDestroy() {\n    this.notiSub.unsubscribe();\n    this.signalRService.stopListening(this.onCreateFolder);\n  }\n\n  createDesignStructure() {\n    this.designStructureService.getInfoDesignStructureCreate(this.model).subscribe(data => {\n      if (data) {\n        data.ApiUrl = this.config.ServerFileApi;\n        this.createFolder(data);\n      }\n    }, error => {\n      this.messageService.showError(error);\n    });\n  }\n\n  createFolder(data) {\n    this.signalRService.invoke('CreateFolder', data).subscribe(data => {\n      if (data) {\n        this.blockUI.start();\n      } else {\n        this.messageService.showMessage(\"Không kết nối được service\");\n      }\n    });\n  }\n\n  showCreateDesignStructure() {\n    let activeModal = this.modalService.open(DesignStructureManagerComponent, {\n      container: 'body',\n      windowClass: 'designstructuremanager-modal',\n      backdrop: 'static'\n    });\n  }\n\n}\n\nDesignStructureComponent.ɵfac = function DesignStructureComponent_Factory(t) {\n  return new (t || DesignStructureComponent)(i0.ɵɵdirectiveInject(i1.NgbModal), i0.ɵɵdirectiveInject(i2.Configuration), i0.ɵɵdirectiveInject(i3.DesignStructureService), i0.ɵɵdirectiveInject(i2.MessageService), i0.ɵɵdirectiveInject(i4.SignalRService), i0.ɵɵdirectiveInject(i2.AppSetting), i0.ɵɵdirectiveInject(i2.PermissionService), i0.ɵɵdirectiveInject(i2.Constants));\n};\n\nDesignStructureComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DesignStructureComponent,\n  selectors: [[\"app-design-structure\"]],\n  decls: 40,\n  vars: 13,\n  consts: [[1, \"content-wrapper\"], [1, \"box\", \"box-head\"], [1, \"panel_header\", \"panel_header_body\"], [1, \"title\", \"pull-left\"], [1, \"actions\", \"panel_actions\", \"pull-right\"], [1, \"box_toggle\", \"material-icons\"], [1, \"content-body\", \"padding-15\"], [\"name\", \"searchForm\"], [\"f\", \"ngForm\"], [1, \"row\"], [1, \"col-lg-3\", \"col-md-3\", \"col-sm-12\"], [1, \"form-group\"], [1, \"form-label\"], [1, \"controls\"], [\"name\", \"ObjectType\", 1, \"form-control\", 3, \"disUipermission\", \"ngModel\", \"ngModelChange\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"Type\", 1, \"form-control\", 3, \"disUipermission\", \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"DesignCode\", 1, \"form-control\", 3, \"disUipermission\", \"ngModel\", \"ngModelChange\"], [1, \"col-lg-3\", \"col-md-3\", \"col-sm-12\", \"text-right\", \"margin-top-20\"], [\"class\", \"btn btn-success btn-success-system\", 3, \"click\", 4, \"appUipermission\"], [1, \"btn\", \"btn-default\", \"btn-default-system\", 3, \"click\"], [1, \"fas\", \"fa-hammer\"], [3, \"ngValue\"], [1, \"btn\", \"btn-success\", \"btn-success-system\", 3, \"click\"], [1, \"fa\", \"fa-plus\"]],\n  template: function DesignStructureComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"section\", 1)(2, \"header\", 2)(3, \"h2\", 3);\n      i0.ɵɵtext(4, \"T\\u1EA1o c\\u1EA5u tr\\u00FAc th\\u01B0 m\\u1EE5c\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 4)(6, \"i\", 5);\n      i0.ɵɵtext(7, \"expand_more\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(8, \"div\", 6)(9, \"form\", 7, 8)(11, \"div\", 9)(12, \"div\", 10)(13, \"div\", 11)(14, \"label\", 12);\n      i0.ɵɵtext(15, \"\\u0110\\u1ED1i t\\u01B0\\u1EE3ng \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"div\", 13)(17, \"select\", 14);\n      i0.ɵɵlistener(\"ngModelChange\", function DesignStructureComponent_Template_select_ngModelChange_17_listener($event) {\n        return ctx.model.ObjectType = $event;\n      });\n      i0.ɵɵtemplate(18, DesignStructureComponent_option_18_Template, 2, 2, \"option\", 15);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(19, \"div\", 10)(20, \"div\", 11)(21, \"label\", 12);\n      i0.ɵɵtext(22, \"Lo\\u1EA1i thi\\u1EBFt k\\u1EBF \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"div\", 13)(24, \"select\", 16);\n      i0.ɵɵlistener(\"ngModelChange\", function DesignStructureComponent_Template_select_ngModelChange_24_listener($event) {\n        return ctx.model.Type = $event;\n      });\n      i0.ɵɵtemplate(25, DesignStructureComponent_option_25_Template, 2, 2, \"option\", 15);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(26, \"div\", 10)(27, \"div\", 11)(28, \"label\", 12);\n      i0.ɵɵtext(29, \"M\\u00E3 thi\\u1EBFt k\\u1EBF\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"div\", 13)(31, \"input\", 17);\n      i0.ɵɵlistener(\"ngModelChange\", function DesignStructureComponent_Template_input_ngModelChange_31_listener($event) {\n        return ctx.model.ObjectCode = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(32, \"span\");\n      i0.ɵɵtext(33, \"VD: TPAD.0101\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(34, \"div\", 18);\n      i0.ɵɵtemplate(35, DesignStructureComponent_button_35_Template, 3, 0, \"button\", 19);\n      i0.ɵɵtext(36, \"\\u00A0 \");\n      i0.ɵɵelementStart(37, \"button\", 20);\n      i0.ɵɵlistener(\"click\", function DesignStructureComponent_Template_button_click_37_listener() {\n        return ctx.showCreateDesignStructure();\n      });\n      i0.ɵɵelement(38, \"i\", 21);\n      i0.ɵɵtext(39, \" \\u00A0C\\u1EA5u h\\u00ECnh\");\n      i0.ɵɵelementEnd()()()()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(17);\n      i0.ɵɵproperty(\"disUipermission\", i0.ɵɵpureFunction0(9, _c0))(\"ngModel\", ctx.model.ObjectType);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.constant.DesignObjectTypes);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disUipermission\", i0.ɵɵpureFunction0(10, _c0))(\"ngModel\", ctx.model.Type);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.constant.DesignTypes);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disUipermission\", i0.ɵɵpureFunction0(11, _c0))(\"ngModel\", ctx.model.ObjectCode);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"appUipermission\", i0.ɵɵpureFunction0(12, _c0));\n    }\n  }\n});\n\n__decorate([BlockUI()], DesignStructureComponent.prototype, \"blockUI\", void 0);","map":null,"metadata":{},"sourceType":"module"}