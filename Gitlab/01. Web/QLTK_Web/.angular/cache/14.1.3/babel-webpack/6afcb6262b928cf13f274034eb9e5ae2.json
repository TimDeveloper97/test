{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { BroadcastEventListener } from 'src/app/signalr/broadcast.event.listener';\nimport { BlockUI } from 'ng-block-ui';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/shared\";\nimport * as i3 from \"../service/solution.service\";\nimport * as i4 from \"src/app/signalR/signal-r.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"ngx-perfect-scrollbar\";\nimport * as i7 from \"@ng-bootstrap/ng-bootstrap\";\n\nfunction SolutionOldVersionComponent_ng_container_20_th_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r3.Name, \"\");\n  }\n}\n\nfunction SolutionOldVersionComponent_ng_container_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, SolutionOldVersionComponent_ng_container_20_th_1_Template, 2, 1, \"th\", 13);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.listHistory[0].ListDesign);\n  }\n}\n\nfunction SolutionOldVersionComponent_tr_22_ng_container_12_td_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function SolutionOldVersionComponent_tr_22_ng_container_12_td_1_div_1_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const item_r9 = i0.ɵɵnextContext().$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r12.downloadFolder(item_r9.FolderId, item_r9.DesignType));\n    });\n    i0.ɵɵelement(2, \"span\", 18);\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction SolutionOldVersionComponent_tr_22_ng_container_12_td_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 14);\n    i0.ɵɵtemplate(1, SolutionOldVersionComponent_tr_22_ng_container_12_td_1_div_1_Template, 3, 0, \"div\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r9.IsDownload == true);\n  }\n}\n\nfunction SolutionOldVersionComponent_tr_22_ng_container_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, SolutionOldVersionComponent_tr_22_ng_container_12_td_1_Template, 2, 1, \"td\", 13);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const row_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", row_r5.ListDesign);\n  }\n}\n\nfunction SolutionOldVersionComponent_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 15);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\", 16);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, SolutionOldVersionComponent_tr_22_ng_container_12_Template, 2, 1, \"ng-container\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const row_r5 = ctx.$implicit;\n    const i_r6 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r6 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 6, row_r5.CreateDate, \"dd/MM/yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(row_r5.CreateByName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r5.Description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r5.Version);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.listHistory.length > 0);\n  }\n}\n\nexport class SolutionOldVersionComponent {\n  constructor(router, appSetting, service, constants, messageService, signalRService, config, componentService) {\n    this.router = router;\n    this.appSetting = appSetting;\n    this.service = service;\n    this.constants = constants;\n    this.messageService = messageService;\n    this.signalRService = signalRService;\n    this.config = config;\n    this.componentService = componentService;\n    this.onDownloadFolder = new BroadcastEventListener('downloadFolderSolutionDesignDocument');\n    this.listHistory = [];\n  }\n\n  ngOnInit() {\n    this.getSolutionOldVersion();\n    this.signalRService.listen(this.onDownloadFolder, true);\n    this.downloadFolderSub = this.onDownloadFolder.subscribe(data => {\n      this.blockUI.stop();\n\n      if (data) {\n        if (data.StatusCode == 2) {\n          this.messageService.showMessage(data.Message);\n        } else {\n          this.messageService.showMessage('Download thành công!');\n        }\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.downloadFolderSub.unsubscribe();\n    this.signalRService.stopListening(this.onDownloadFolder);\n  }\n\n  getSolutionOldVersion() {\n    this.service.getSolutionOldVersion(this.Id).subscribe(data => {\n      this.listHistory = data;\n    }, error => {\n      this.messageService.showError(error);\n    });\n  }\n\n  downloadFolder(folderId, designTypes) {\n    this.componentService.showChooseFolder(3, designTypes, this.Id).subscribe(result => {\n      if (result) {\n        var file = {\n          Id: folderId,\n          DownloadPath: result,\n          ObjectId: this.Id,\n          Token: '',\n          ApiUrl: this.config.ServerApi\n        };\n        let currentUser = JSON.parse(localStorage.getItem('qltkcurrentUser'));\n\n        if (currentUser && currentUser.access_token) {\n          file.Token = currentUser.access_token;\n        }\n\n        this.signalRService.invoke('DownloadFolderSolutionDesignDocument', file).subscribe(data => {\n          if (data) {\n            this.blockUI.start();\n          } else {\n            this.messageService.showMessage(\"Không kết nối được service\");\n          }\n        });\n      }\n    });\n  }\n\n}\n\nSolutionOldVersionComponent.ɵfac = function SolutionOldVersionComponent_Factory(t) {\n  return new (t || SolutionOldVersionComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.AppSetting), i0.ɵɵdirectiveInject(i3.SolutionService), i0.ɵɵdirectiveInject(i2.Constants), i0.ɵɵdirectiveInject(i2.MessageService), i0.ɵɵdirectiveInject(i4.SignalRService), i0.ɵɵdirectiveInject(i2.Configuration), i0.ɵɵdirectiveInject(i2.ComponentService));\n};\n\nSolutionOldVersionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: SolutionOldVersionComponent,\n  selectors: [[\"app-solution-old-version\"]],\n  inputs: {\n    Id: \"Id\"\n  },\n  decls: 23,\n  vars: 3,\n  consts: [[1, \"row\"], [1, \"col-lg-12\", \"col-md-12\", \"col-sm-12\", \"text-right\", \"mb-1\"], [1, \"btn\", \"btn-default\", \"btn-default-system\", 3, \"click\"], [1, \"fas\", \"fa-redo-alt\"], [1, \"col-lg-12\", \"col-md-12\", \"col-sm-12\"], [2, \"height\", \"auto\", \"width\", \"100%\", 3, \"config\"], [1, \"table\", \"table-bordered\", 2, \"min-width\", \"1000px\"], [\"width\", \"50px\", 1, \"text-center\"], [\"width\", \"100px\", 1, \"text-center\"], [\"width\", \"200px\", 1, \"text-center\"], [\"min-width\", \"250px\", 1, \"text-center\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-center\", \"style\", \" width: 100px;\", 4, \"ngFor\", \"ngForOf\"], [1, \"text-center\", 2, \"width\", \"100px\"], [1, \"text-center\"], [1, \"text-right\"], [\"type\", \"button\", \"placement\", \"top\", \"ngbTooltip\", \"Download folder\", \"container\", \"body\", 1, \"btn\", \"btn-xs\", \"btn-info\", 3, \"click\"], [\"aria-hidden\", \"true\", 1, \"fas\", \"fa-arrow-down\"]],\n  template: function SolutionOldVersionComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function SolutionOldVersionComponent_Template_button_click_2_listener() {\n        return ctx.getSolutionOldVersion();\n      });\n      i0.ɵɵelement(3, \"i\", 3);\n      i0.ɵɵtext(4, \" \\u00A0L\\u00E0m m\\u1EDBi\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"div\", 4)(6, \"perfect-scrollbar\", 5)(7, \"table\", 6)(8, \"thead\")(9, \"tr\")(10, \"th\", 7);\n      i0.ɵɵtext(11, \"STT\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"th\", 8);\n      i0.ɵɵtext(13, \"Ng\\u00E0y\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"th\", 9);\n      i0.ɵɵtext(15, \"Ng\\u01B0\\u1EDDi s\\u1EEDa\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"th\", 10);\n      i0.ɵɵtext(17, \"N\\u1ED9i dung s\\u1EEDa\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"th\", 8);\n      i0.ɵɵtext(19, \"Version\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(20, SolutionOldVersionComponent_ng_container_20_Template, 2, 1, \"ng-container\", 11);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(21, \"tbody\");\n      i0.ɵɵtemplate(22, SolutionOldVersionComponent_tr_22_Template, 13, 9, \"tr\", 12);\n      i0.ɵɵelementEnd()()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"config\", ctx.constants.ScrollXConfig);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngIf\", ctx.listHistory.length > 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", ctx.listHistory);\n    }\n  },\n  dependencies: [i5.NgForOf, i5.NgIf, i6.PerfectScrollbarComponent, i7.NgbTooltip, i5.DatePipe]\n});\n\n__decorate([BlockUI()], SolutionOldVersionComponent.prototype, \"blockUI\", void 0);","map":null,"metadata":{},"sourceType":"module"}