{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { BroadcastEventListener } from 'src/app/signalr/broadcast.event.listener';\nimport { BlockUI } from 'ng-block-ui';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/signalR/signal-r.service\";\nimport * as i2 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i3 from \"../../services/message.service\";\n\nfunction ChooseFileModalComponent_p_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"T\\u1EA3i m\\u1EABu \");\n    i0.ɵɵelementStart(2, \"a\", 23);\n    i0.ɵɵlistener(\"click\", function ChooseFileModalComponent_p_18_Template_a_click_2_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.dowload());\n    });\n    i0.ɵɵtext(3, \"t\\u1EA1i \\u0111\\u00E2y.\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nexport class ChooseFileModalComponent {\n  constructor(signalRService, activeModal, messageService) {\n    this.signalRService = signalRService;\n    this.activeModal = activeModal;\n    this.messageService = messageService;\n    this.onSendListFolder = new BroadcastEventListener('sendListFolderFile');\n    this.ListFolder = [];\n    this.ListFolderId = [];\n    this.selectedId = '';\n    this.dataModel = {\n      Id: '',\n      Path: '',\n      ListFolder: []\n    };\n    this.templatePath = '';\n  }\n\n  ngOnInit() {\n    this.getFolderFile();\n    this.signalRService.listen(this.onSendListFolder, true);\n    this.notiSub = this.onSendListFolder.subscribe(data => {\n      if (data) {\n        this.dataModel.ListFolder = data;\n      }\n\n      this.blockUI.stop();\n    });\n  }\n\n  getFolderFile() {\n    this.signalRService.invoke('GetFolderFile', this.dataModel).subscribe(data => {\n      if (data) {\n        this.blockUI.start();\n      } else {\n        this.messageService.showMessage(\"Không kết nối được service\");\n      }\n    });\n  }\n\n  onSelectionChanged(e) {\n    this.selectedId = e.selectedRowKeys[0];\n    this.dataModel.Path = e.selectedRowKeys[0];\n  }\n\n  onRowExpanding(e) {\n    this.dataModel.Id = e.key;\n    this.signalRService.invoke('GetFolderFile', this.dataModel).subscribe(data => {\n      if (data) {\n        this.blockUI.start();\n      } else {\n        this.messageService.showMessage(\"Không kết nối được service\");\n      }\n    });\n  }\n\n  closeModal() {\n    this.activeModal.close(false);\n  }\n\n  choose() {\n    this.activeModal.close(this.dataModel.Path);\n  }\n\n  dowload() {\n    var link = document.createElement('a');\n    link.setAttribute(\"type\", \"hidden\");\n    link.href = this.templatePath;\n    link.download = 'Download.zip';\n    document.body.appendChild(link); // link.focus();\n\n    link.click();\n    document.body.removeChild(link);\n  }\n\n}\n\nChooseFileModalComponent.ɵfac = function ChooseFileModalComponent_Factory(t) {\n  return new (t || ChooseFileModalComponent)(i0.ɵɵdirectiveInject(i1.SignalRService), i0.ɵɵdirectiveInject(i2.NgbActiveModal), i0.ɵɵdirectiveInject(i3.MessageService));\n};\n\nChooseFileModalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ChooseFileModalComponent,\n  selectors: [[\"app-choose-file-modal\"]],\n  decls: 34,\n  vars: 7,\n  consts: [[1, \"modal-header\"], [1, \"modal-title\", \"text-uppercase\", \"text-danger\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\", \"padding-15\", 2, \"height\", \"600px\"], [\"name\", \"form\", \"novalidate\", \"\", 1, \"tab-form-demo\"], [\"f\", \"ngForm\"], [1, \"row\"], [1, \"col-md-12\", \"col-sm-12\", \"col-lg-12\"], [1, \"form-group\"], [1, \"form-label\"], [1, \"controls\"], [\"type\", \"text\", \"name\", \"Path\", \"disabled\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Path\", \"ngModel\"], [4, \"ngIf\"], [\"id\", \"folder\", \"keyExpr\", \"Id\", \"parentIdExpr\", \"ParentId\", \"noDataText\", \" \", \"height\", \"450\", 3, \"dataSource\", \"showRowLines\", \"showBorders\", \"columnAutoWidth\", \"expandedRowKeys\", \"onSelectionChanged\", \"onRowExpanding\"], [\"mode\", \"single\"], [\"dataField\", \"Name\", \"caption\", \"Danh s\\u00E1ch th\\u01B0 m\\u1EE5c\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 3, \"click\"], [1, \"fa\", \"fa-save\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"fa\", \"fa-power-off\"], [\"href\", \"javascript:;\", 3, \"click\"]],\n  template: function ChooseFileModalComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h4\", 1);\n      i0.ɵɵtext(2, \"Ch\\u1ECDn th\\u01B0 file\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function ChooseFileModalComponent_Template_button_click_3_listener() {\n        return ctx.closeModal();\n      });\n      i0.ɵɵelementStart(4, \"span\", 3);\n      i0.ɵɵtext(5, \"\\u00D7\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(6, \"div\", 4)(7, \"form\", 5, 6)(9, \"div\", 7)(10, \"div\", 8)(11, \"div\", 9)(12, \"label\", 10);\n      i0.ɵɵtext(13, \"\\u0110\\u01B0\\u1EDDng d\\u1EABn\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"div\", 11)(15, \"input\", 12, 13);\n      i0.ɵɵlistener(\"ngModelChange\", function ChooseFileModalComponent_Template_input_ngModelChange_15_listener($event) {\n        return ctx.dataModel.Path = $event;\n      });\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(17, \"div\", 8);\n      i0.ɵɵtemplate(18, ChooseFileModalComponent_p_18_Template, 4, 0, \"p\", 14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(19, \"div\", 8)(20, \"dx-tree-list\", 15);\n      i0.ɵɵlistener(\"onSelectionChanged\", function ChooseFileModalComponent_Template_dx_tree_list_onSelectionChanged_20_listener($event) {\n        return ctx.onSelectionChanged($event);\n      })(\"onRowExpanding\", function ChooseFileModalComponent_Template_dx_tree_list_onRowExpanding_20_listener($event) {\n        return ctx.onRowExpanding($event);\n      });\n      i0.ɵɵelement(21, \"dxo-selection\", 16)(22, \"dxi-column\", 17);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(23, \"div\", 18)(24, \"button\", 19);\n      i0.ɵɵlistener(\"click\", function ChooseFileModalComponent_Template_button_click_24_listener() {\n        return ctx.choose();\n      });\n      i0.ɵɵelement(25, \"i\", 20);\n      i0.ɵɵtext(26, \"\\u00A0 \");\n      i0.ɵɵelementStart(27, \"span\");\n      i0.ɵɵtext(28, \"Ch\\u1ECDn\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(29, \"button\", 21);\n      i0.ɵɵlistener(\"click\", function ChooseFileModalComponent_Template_button_click_29_listener() {\n        return ctx.closeModal();\n      });\n      i0.ɵɵelement(30, \"i\", 22);\n      i0.ɵɵtext(31, \" \\u00A0 \");\n      i0.ɵɵelementStart(32, \"span\");\n      i0.ɵɵtext(33, \" \\u0110\\u00F3ng \");\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(15);\n      i0.ɵɵproperty(\"ngModel\", ctx.dataModel.Path);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.templatePath);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"dataSource\", ctx.dataModel.ListFolder)(\"showRowLines\", true)(\"showBorders\", true)(\"columnAutoWidth\", true)(\"expandedRowKeys\", ctx.ListFolderId);\n    }\n  }\n});\n\n__decorate([BlockUI()], ChooseFileModalComponent.prototype, \"blockUI\", void 0);","map":null,"metadata":{},"sourceType":"module"}